<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="1365pt" height="962pt"
 viewBox="0.00 0.00 1365.37 962.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 958)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-958 1361.37,-958 1361.37,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<polygon fill="none" stroke="black" points="198.77,-954 39.77,-954 39.77,-918 198.77,-918 198.77,-954"/>
<text text-anchor="middle" x="119.27" y="-932.9" font-family="Courier,monospace" font-size="12.00">legacy(writer, key)</text>
</g>
<!-- check_text -->
<g id="node2" class="node">
<title>check_text</title>
<polygon fill="none" stroke="black" points="119.27,-881 0.23,-863 119.27,-845 238.31,-863 119.27,-881"/>
<text text-anchor="middle" x="119.27" y="-859.9" font-family="Courier,monospace" font-size="12.00">key.text exists?</text>
</g>
<!-- start&#45;&gt;check_text -->
<g id="edge1" class="edge">
<title>start&#45;&gt;check_text</title>
<path fill="none" stroke="black" d="M119.27,-917.81C119.27,-909.79 119.27,-900.05 119.27,-891.07"/>
<polygon fill="black" stroke="black" points="122.77,-891.03 119.27,-881.03 115.77,-891.03 122.77,-891.03"/>
</g>
<!-- write_text -->
<g id="node3" class="node">
<title>write_text</title>
<polygon fill="none" stroke="black" points="190.27,-798 16.27,-798 16.27,-762 190.27,-762 190.27,-798"/>
<text text-anchor="middle" x="103.27" y="-783.4" font-family="Courier,monospace" font-size="12.00">writer.writeAll(text)</text>
<text text-anchor="middle" x="103.27" y="-770.4" font-family="Courier,monospace" font-size="12.00">return</text>
</g>
<!-- check_text&#45;&gt;write_text -->
<g id="edge2" class="edge">
<title>check_text&#45;&gt;write_text</title>
<path fill="none" stroke="black" d="M115.95,-845.22C113.84,-834.54 111.06,-820.46 108.64,-808.21"/>
<polygon fill="black" stroke="black" points="112.01,-807.17 106.63,-798.04 105.14,-808.53 112.01,-807.17"/>
<text text-anchor="middle" x="117.27" y="-819" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- calc_mods -->
<g id="node4" class="node">
<title>calc_mods</title>
<polygon fill="none" stroke="black" points="525.77,-798 208.77,-798 208.77,-762 525.77,-762 525.77,-798"/>
<text text-anchor="middle" x="367.27" y="-776.9" font-family="Courier,monospace" font-size="12.00">effective_mods = mods &amp; (shift|alt|ctrl)</text>
</g>
<!-- check_text&#45;&gt;calc_mods -->
<g id="edge3" class="edge">
<title>check_text&#45;&gt;calc_mods</title>
<path fill="none" stroke="black" d="M155.06,-850.31C194.34,-837.48 258.11,-816.65 305.5,-801.18"/>
<polygon fill="black" stroke="black" points="306.63,-804.49 315.04,-798.06 304.45,-797.83 306.63,-804.49"/>
<text text-anchor="middle" x="263.27" y="-819" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- check_mods_ascii -->
<g id="node5" class="node">
<title>check_mods_ascii</title>
<polygon fill="none" stroke="black" points="367.27,-725 193.27,-691 367.27,-657 541.27,-691 367.27,-725"/>
<text text-anchor="middle" x="367.27" y="-694.4" font-family="Courier,monospace" font-size="12.00">effective_mods == 0</text>
<text text-anchor="middle" x="367.27" y="-681.4" font-family="Courier,monospace" font-size="12.00">&amp;&amp; codepoint &lt;= 0x7F?</text>
</g>
<!-- calc_mods&#45;&gt;check_mods_ascii -->
<g id="edge4" class="edge">
<title>calc_mods&#45;&gt;check_mods_ascii</title>
<path fill="none" stroke="black" d="M367.27,-761.81C367.27,-754.1 367.27,-744.63 367.27,-735.17"/>
<polygon fill="black" stroke="black" points="370.77,-735 367.27,-725 363.77,-735 370.77,-735"/>
</g>
<!-- write_byte -->
<g id="node6" class="node">
<title>write_byte</title>
<polygon fill="none" stroke="black" points="430.77,-594 271.77,-594 271.77,-558 430.77,-558 430.77,-594"/>
<text text-anchor="middle" x="351.27" y="-579.4" font-family="Courier,monospace" font-size="12.00">writer.writeByte(b)</text>
<text text-anchor="middle" x="351.27" y="-566.4" font-family="Courier,monospace" font-size="12.00">return</text>
</g>
<!-- check_mods_ascii&#45;&gt;write_byte -->
<g id="edge5" class="edge">
<title>check_mods_ascii&#45;&gt;write_byte</title>
<path fill="none" stroke="black" d="M362.68,-657.62C360.3,-640.77 357.41,-620.39 355.14,-604.34"/>
<polygon fill="black" stroke="black" points="358.55,-603.43 353.68,-594.02 351.61,-604.41 358.55,-603.43"/>
<text text-anchor="middle" x="365.27" y="-631" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- check_ctrl_alpha -->
<g id="node7" class="node">
<title>check_ctrl_alpha</title>
<polygon fill="none" stroke="black" points="631.27,-610 449.27,-576 631.27,-542 813.27,-576 631.27,-610"/>
<text text-anchor="middle" x="631.27" y="-579.4" font-family="Courier,monospace" font-size="12.00">effective_mods == ctrl</text>
<text text-anchor="middle" x="631.27" y="-566.4" font-family="Courier,monospace" font-size="12.00">&amp;&amp; a&#45;z?</text>
</g>
<!-- check_mods_ascii&#45;&gt;check_ctrl_alpha -->
<g id="edge6" class="edge">
<title>check_mods_ascii&#45;&gt;check_ctrl_alpha</title>
<path fill="none" stroke="black" d="M420.38,-667.27C462.97,-649.04 522.87,-623.4 567.96,-604.1"/>
<polygon fill="black" stroke="black" points="569.52,-607.24 577.34,-600.08 566.77,-600.8 569.52,-607.24"/>
<text text-anchor="middle" x="512.27" y="-631" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- write_ctrl -->
<g id="node8" class="node">
<title>write_ctrl</title>
<polygon fill="none" stroke="black" points="648.77,-479 451.77,-479 451.77,-443 648.77,-443 648.77,-479"/>
<text text-anchor="middle" x="550.27" y="-464.4" font-family="Courier,monospace" font-size="12.00">writer.writeByte(b&#45;0x60)</text>
<text text-anchor="middle" x="550.27" y="-451.4" font-family="Courier,monospace" font-size="12.00">return</text>
</g>
<!-- check_ctrl_alpha&#45;&gt;write_ctrl -->
<g id="edge7" class="edge">
<title>check_ctrl_alpha&#45;&gt;write_ctrl</title>
<path fill="none" stroke="black" d="M610.2,-545.61C597.34,-527.67 581.07,-504.97 568.72,-487.75"/>
<polygon fill="black" stroke="black" points="571.34,-485.38 562.67,-479.3 565.65,-489.46 571.34,-485.38"/>
<text text-anchor="middle" x="598.27" y="-516" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- check_alt_printable -->
<g id="node9" class="node">
<title>check_alt_printable</title>
<polygon fill="none" stroke="black" points="841.27,-495 667.27,-461 841.27,-427 1015.27,-461 841.27,-495"/>
<text text-anchor="middle" x="841.27" y="-464.4" font-family="Courier,monospace" font-size="12.00">effective_mods == alt</text>
<text text-anchor="middle" x="841.27" y="-451.4" font-family="Courier,monospace" font-size="12.00">&amp;&amp; printable ASCII?</text>
</g>
<!-- check_ctrl_alpha&#45;&gt;check_alt_printable -->
<g id="edge8" class="edge">
<title>check_ctrl_alpha&#45;&gt;check_alt_printable</title>
<path fill="none" stroke="black" d="M676.84,-550.48C709.28,-533.02 753.01,-509.49 787.22,-491.08"/>
<polygon fill="black" stroke="black" points="789,-494.1 796.15,-486.28 785.69,-487.93 789,-494.1"/>
<text text-anchor="middle" x="748.27" y="-516" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- write_alt -->
<g id="node10" class="node">
<title>write_alt</title>
<polygon fill="none" stroke="black" points="842.77,-364 653.77,-364 653.77,-328 842.77,-328 842.77,-364"/>
<text text-anchor="middle" x="748.27" y="-349.4" font-family="Courier,monospace" font-size="12.00">writer.print(&quot;\x1b{c}&quot;)</text>
<text text-anchor="middle" x="748.27" y="-336.4" font-family="Courier,monospace" font-size="12.00">return</text>
</g>
<!-- check_alt_printable&#45;&gt;write_alt -->
<g id="edge9" class="edge">
<title>check_alt_printable&#45;&gt;write_alt</title>
<path fill="none" stroke="black" d="M817.8,-431.49C802.82,-413.28 783.57,-389.89 769.12,-372.34"/>
<polygon fill="black" stroke="black" points="771.51,-369.74 762.46,-364.24 766.11,-374.18 771.51,-369.74"/>
<text text-anchor="middle" x="803.27" y="-401" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- check_ctrl_alt_alpha -->
<g id="node11" class="node">
<title>check_ctrl_alt_alpha</title>
<polygon fill="none" stroke="black" points="1088.27,-380 861.27,-346 1088.27,-312 1315.27,-346 1088.27,-380"/>
<text text-anchor="middle" x="1088.27" y="-349.4" font-family="Courier,monospace" font-size="12.00">effective_mods == (ctrl|alt)</text>
<text text-anchor="middle" x="1088.27" y="-336.4" font-family="Courier,monospace" font-size="12.00">&amp;&amp; a&#45;z?</text>
</g>
<!-- check_alt_printable&#45;&gt;check_ctrl_alt_alpha -->
<g id="edge10" class="edge">
<title>check_alt_printable&#45;&gt;check_ctrl_alt_alpha</title>
<path fill="none" stroke="black" d="M891.85,-436.86C930.29,-419.27 983.43,-394.96 1024.74,-376.06"/>
<polygon fill="black" stroke="black" points="1026.26,-379.22 1033.9,-371.87 1023.35,-372.85 1026.26,-379.22"/>
<text text-anchor="middle" x="977.27" y="-401" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- write_ctrl_alt -->
<g id="node12" class="node">
<title>write_ctrl_alt</title>
<polygon fill="none" stroke="black" points="1124.77,-265 935.77,-265 935.77,-229 1124.77,-229 1124.77,-265"/>
<text text-anchor="middle" x="1030.27" y="-250.4" font-family="Courier,monospace" font-size="12.00">writer.print(&quot;\x1b{d}&quot;)</text>
<text text-anchor="middle" x="1030.27" y="-237.4" font-family="Courier,monospace" font-size="12.00">return</text>
</g>
<!-- check_ctrl_alt_alpha&#45;&gt;write_ctrl_alt -->
<g id="edge11" class="edge">
<title>check_ctrl_alt_alpha&#45;&gt;write_ctrl_alt</title>
<path fill="none" stroke="black" d="M1070.08,-314.57C1062.22,-301.43 1053.12,-286.22 1045.61,-273.66"/>
<polygon fill="black" stroke="black" points="1048.6,-271.83 1040.46,-265.05 1042.59,-275.43 1048.6,-271.83"/>
<text text-anchor="middle" x="1063.27" y="-286" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- def_switch -->
<g id="node13" class="node">
<title>def_switch</title>
<polygon fill="none" stroke="black" points="1317.27,-265 1143.27,-265 1143.27,-229 1317.27,-229 1317.27,-265"/>
<text text-anchor="middle" x="1230.27" y="-250.4" font-family="Courier,monospace" font-size="12.00">switch(key.codepoint)</text>
<text text-anchor="middle" x="1230.27" y="-237.4" font-family="Courier,monospace" font-size="12.00">匹配预定义键</text>
</g>
<!-- check_ctrl_alt_alpha&#45;&gt;def_switch -->
<g id="edge12" class="edge">
<title>check_ctrl_alt_alpha&#45;&gt;def_switch</title>
<path fill="none" stroke="black" d="M1128.2,-317.72C1149.88,-302.91 1176.37,-284.82 1196.93,-270.78"/>
<polygon fill="black" stroke="black" points="1199.06,-273.56 1205.34,-265.03 1195.11,-267.78 1199.06,-273.56"/>
<text text-anchor="middle" x="1180.27" y="-286" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- check_mods -->
<g id="node14" class="node">
<title>check_mods</title>
<polygon fill="none" stroke="black" points="1230.27,-192 1103.06,-174 1230.27,-156 1357.48,-174 1230.27,-192"/>
<text text-anchor="middle" x="1230.27" y="-170.9" font-family="Courier,monospace" font-size="12.00">effective_mods分支</text>
</g>
<!-- def_switch&#45;&gt;check_mods -->
<g id="edge13" class="edge">
<title>def_switch&#45;&gt;check_mods</title>
<path fill="none" stroke="black" d="M1230.27,-228.81C1230.27,-220.79 1230.27,-211.05 1230.27,-202.07"/>
<polygon fill="black" stroke="black" points="1233.77,-202.03 1230.27,-192.03 1226.77,-202.03 1233.77,-202.03"/>
</g>
<!-- write_sequence -->
<g id="node15" class="node">
<title>write_sequence</title>
<polygon fill="none" stroke="black" points="1302.27,-109 1158.27,-109 1158.27,-73 1302.27,-73 1302.27,-109"/>
<text text-anchor="middle" x="1230.27" y="-94.4" font-family="Courier,monospace" font-size="12.00">生成转义序列</text>
<text text-anchor="middle" x="1230.27" y="-81.4" font-family="Courier,monospace" font-size="12.00">writer.print(...)</text>
</g>
<!-- check_mods&#45;&gt;write_sequence -->
<g id="edge14" class="edge">
<title>check_mods&#45;&gt;write_sequence</title>
<path fill="none" stroke="black" d="M1230.27,-155.82C1230.27,-145.19 1230.27,-131.31 1230.27,-119.2"/>
<polygon fill="black" stroke="black" points="1233.77,-119.15 1230.27,-109.15 1226.77,-119.15 1233.77,-119.15"/>
<text text-anchor="middle" x="1264.77" y="-130" font-family="Courier,monospace" font-size="10.00">根据修饰符组合</text>
</g>
<!-- end -->
<g id="node16" class="node">
<title>end</title>
<polygon fill="none" stroke="black" points="1262.77,-36 1197.77,-36 1197.77,0 1262.77,0 1262.77,-36"/>
<text text-anchor="middle" x="1230.27" y="-14.9" font-family="Courier,monospace" font-size="12.00">流程结束</text>
</g>
<!-- write_sequence&#45;&gt;end -->
<g id="edge15" class="edge">
<title>write_sequence&#45;&gt;end</title>
<path fill="none" stroke="black" d="M1230.27,-72.81C1230.27,-64.79 1230.27,-55.05 1230.27,-46.07"/>
<polygon fill="black" stroke="black" points="1233.77,-46.03 1230.27,-36.03 1226.77,-46.03 1233.77,-46.03"/>
</g>
</g>
</svg>
