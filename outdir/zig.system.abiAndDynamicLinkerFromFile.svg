<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="807pt" height="826pt"
 viewBox="0.00 0.00 807.10 826.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 822)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-822 803.1,-822 803.1,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="lightblue" stroke="black" cx="191.1" cy="-800" rx="29.5" ry="18"/>
<text text-anchor="middle" x="191.1" y="-796.3" font-family="Courier New" font-size="14.00">开始</text>
</g>
<!-- read_elf_header -->
<g id="node4" class="node">
<title>read_elf_header</title>
<polygon fill="lightblue" stroke="black" points="290.1,-745 92.1,-745 92.1,-707 290.1,-707 290.1,-745"/>
<text text-anchor="middle" x="191.1" y="-729.8" font-family="Courier New" font-size="14.00">读取ELF头</text>
<text text-anchor="middle" x="191.1" y="-714.8" font-family="Courier New" font-size="14.00">验证魔数/字节序/版本/类别</text>
</g>
<!-- start&#45;&gt;read_elf_header -->
<g id="edge1" class="edge">
<title>start&#45;&gt;read_elf_header</title>
<path fill="none" stroke="black" d="M191.1,-781.94C191.1,-773.99 191.1,-764.31 191.1,-755.31"/>
<polygon fill="black" stroke="black" points="194.6,-755.2 191.1,-745.2 187.6,-755.2 194.6,-755.2"/>
</g>
<!-- end -->
<g id="node2" class="node">
<title>end</title>
<ellipse fill="lightblue" stroke="black" cx="48.1" cy="-18" rx="48.19" ry="18"/>
<text text-anchor="middle" x="48.1" y="-14.3" font-family="Courier New" font-size="14.00">返回结果</text>
</g>
<!-- error -->
<g id="node3" class="node">
<title>error</title>
<ellipse fill="lightblue" stroke="black" cx="58.1" cy="-584" rx="48.19" ry="18"/>
<text text-anchor="middle" x="58.1" y="-580.3" font-family="Courier New" font-size="14.00">返回错误</text>
</g>
<!-- error&#45;&gt;end -->
<g id="edge18" class="edge">
<title>error&#45;&gt;end</title>
<path fill="none" stroke="black" d="M51.85,-566C45.35,-546.75 36.1,-514.31 36.1,-485.5 36.1,-485.5 36.1,-485.5 36.1,-90 36.1,-75.3 38.63,-59.13 41.36,-45.94"/>
<polygon fill="black" stroke="black" points="44.8,-46.6 43.56,-36.08 37.97,-45.08 44.8,-46.6"/>
</g>
<!-- read_elf_header&#45;&gt;error -->
<g id="edge2" class="edge">
<title>read_elf_header&#45;&gt;error</title>
<path fill="none" stroke="black" d="M173.98,-706.98C150.12,-681.87 106.84,-636.31 80.46,-608.54"/>
<polygon fill="black" stroke="black" points="82.92,-606.05 73.5,-601.21 77.85,-610.87 82.92,-606.05"/>
<text text-anchor="middle" x="184.1" y="-677.8" font-family="Courier New" font-size="14.00">校验失败</text>
</g>
<!-- process_ph -->
<g id="node5" class="node">
<title>process_ph</title>
<polygon fill="lightblue" stroke="black" points="413.1,-656 225.1,-656 225.1,-620 413.1,-620 413.1,-656"/>
<text text-anchor="middle" x="319.1" y="-634.3" font-family="Courier New" font-size="14.00">处理程序头(phnum次循环)</text>
</g>
<!-- read_elf_header&#45;&gt;process_ph -->
<g id="edge3" class="edge">
<title>read_elf_header&#45;&gt;process_ph</title>
<path fill="none" stroke="black" d="M217.93,-706.97C237.52,-693.81 264.21,-675.88 285.26,-661.73"/>
<polygon fill="black" stroke="black" points="287.26,-664.61 293.61,-656.13 283.35,-658.8 287.26,-664.61"/>
<text text-anchor="middle" x="296.1" y="-677.8" font-family="Courier New" font-size="14.00">校验成功</text>
</g>
<!-- check_ph_type -->
<g id="node6" class="node">
<title>check_ph_type</title>
<polygon fill="lightblue" stroke="black" points="537.1,-547 416.78,-529 537.1,-511 657.42,-529 537.1,-547"/>
<text text-anchor="middle" x="537.1" y="-525.3" font-family="Courier New" font-size="14.00">当前程序头类型？</text>
</g>
<!-- process_ph&#45;&gt;check_ph_type -->
<g id="edge4" class="edge">
<title>process_ph&#45;&gt;check_ph_type</title>
<path fill="none" stroke="black" d="M371.94,-619.99C386.48,-614.76 402.09,-608.62 416.1,-602 448.63,-586.62 483.75,-565.13 507.73,-549.63"/>
<polygon fill="black" stroke="black" points="509.88,-552.4 516.35,-544.01 506.06,-546.54 509.88,-552.4"/>
</g>
<!-- process_sh -->
<g id="node9" class="node">
<title>process_sh</title>
<polygon fill="lightblue" stroke="black" points="238.1,-548 64.1,-548 64.1,-510 238.1,-510 238.1,-548"/>
<text text-anchor="middle" x="151.1" y="-532.8" font-family="Courier New" font-size="14.00">处理节头(shnum次循环)</text>
<text text-anchor="middle" x="151.1" y="-517.8" font-family="Courier New" font-size="14.00">查找.dynstr节</text>
</g>
<!-- process_ph&#45;&gt;process_sh -->
<g id="edge10" class="edge">
<title>process_ph&#45;&gt;process_sh</title>
<path fill="none" stroke="black" d="M224.62,-629.23C188.09,-624.1 152.35,-615.68 141.1,-602 131.06,-589.8 133.23,-572.33 138.06,-557.65"/>
<polygon fill="black" stroke="black" points="141.44,-558.62 141.72,-548.03 134.89,-556.14 141.44,-558.62"/>
<text text-anchor="middle" x="205.6" y="-580.3" font-family="Courier New" font-size="14.00">所有程序头处理完毕</text>
</g>
<!-- check_ph_type&#45;&gt;process_ph -->
<g id="edge7" class="edge">
<title>check_ph_type&#45;&gt;process_ph</title>
<path fill="none" stroke="black" d="M469.51,-536.99C425.13,-542.74 372.09,-552.22 354.1,-566 340,-576.79 331.22,-594.77 325.98,-609.94"/>
<polygon fill="black" stroke="black" points="322.52,-609.28 322.89,-619.87 329.2,-611.36 322.52,-609.28"/>
<text text-anchor="middle" x="383.1" y="-587.8" font-family="Courier New" font-size="14.00">其他类型</text>
<text text-anchor="middle" x="383.1" y="-572.8" font-family="Courier New" font-size="14.00">继续循环</text>
</g>
<!-- handle_pt_interp -->
<g id="node7" class="node">
<title>handle_pt_interp</title>
<polygon fill="lightblue" stroke="black" points="418.6,-459 263.6,-459 263.6,-421 418.6,-421 418.6,-459"/>
<text text-anchor="middle" x="341.1" y="-443.8" font-family="Courier New" font-size="14.00">提取PT_INTERP路径</text>
<text text-anchor="middle" x="341.1" y="-428.8" font-family="Courier New" font-size="14.00">设置动态链接器和ABI</text>
</g>
<!-- check_ph_type&#45;&gt;handle_pt_interp -->
<g id="edge5" class="edge">
<title>check_ph_type&#45;&gt;handle_pt_interp</title>
<path fill="none" stroke="black" d="M508.18,-515.16C477.35,-501.48 427.98,-479.56 390.88,-463.1"/>
<polygon fill="black" stroke="black" points="392.29,-459.89 381.73,-459.04 389.45,-466.29 392.29,-459.89"/>
<text text-anchor="middle" x="487.6" y="-480.8" font-family="Courier New" font-size="14.00">PT_INTERP</text>
</g>
<!-- handle_pt_dynamic -->
<g id="node8" class="node">
<title>handle_pt_dynamic</title>
<polygon fill="lightblue" stroke="black" points="702.1,-459 558.1,-459 558.1,-421 702.1,-421 702.1,-459"/>
<text text-anchor="middle" x="630.1" y="-443.8" font-family="Courier New" font-size="14.00">查找DT_RUNPATH</text>
<text text-anchor="middle" x="630.1" y="-428.8" font-family="Courier New" font-size="14.00">记录rpath_offset</text>
</g>
<!-- check_ph_type&#45;&gt;handle_pt_dynamic -->
<g id="edge6" class="edge">
<title>check_ph_type&#45;&gt;handle_pt_dynamic</title>
<path fill="none" stroke="black" d="M552.87,-513.24C566.59,-500.41 586.76,-481.54 603.05,-466.3"/>
<polygon fill="black" stroke="black" points="605.78,-468.54 610.69,-459.16 600.99,-463.43 605.78,-468.54"/>
<text text-anchor="middle" x="630.6" y="-480.8" font-family="Courier New" font-size="14.00">PT_DYNAMIC</text>
</g>
<!-- handle_pt_interp&#45;&gt;process_ph -->
<g id="edge8" class="edge">
<title>handle_pt_interp&#45;&gt;process_ph</title>
<path fill="none" stroke="black" d="M323.74,-459.22C312.6,-472.24 299.12,-490.78 293.1,-510 282.41,-544.09 294.97,-584.72 306.06,-610.69"/>
<polygon fill="black" stroke="black" points="302.89,-612.19 310.18,-619.88 309.28,-609.32 302.89,-612.19"/>
<text text-anchor="middle" x="350.6" y="-525.3" font-family="Courier New" font-size="14.00">继续下一个程序头</text>
</g>
<!-- handle_pt_dynamic&#45;&gt;process_ph -->
<g id="edge9" class="edge">
<title>handle_pt_dynamic&#45;&gt;process_ph</title>
<path fill="none" stroke="black" d="M661.33,-459.09C667.29,-464.08 672.72,-470.07 676.1,-477 690.05,-505.65 687.7,-524.57 666.1,-548 633.43,-583.42 513.19,-608.57 423.36,-622.9"/>
<polygon fill="black" stroke="black" points="422.72,-619.46 413.39,-624.47 423.81,-626.37 422.72,-619.46"/>
<text text-anchor="middle" x="741.6" y="-525.3" font-family="Courier New" font-size="14.00">继续下一个程序头</text>
</g>
<!-- parse_rpath -->
<g id="node10" class="node">
<title>parse_rpath</title>
<polygon fill="lightblue" stroke="black" points="208.6,-459 93.6,-459 93.6,-421 208.6,-421 208.6,-459"/>
<text text-anchor="middle" x="151.1" y="-443.8" font-family="Courier New" font-size="14.00">解析rpath</text>
<text text-anchor="middle" x="151.1" y="-428.8" font-family="Courier New" font-size="14.00">寻找glibc版本</text>
</g>
<!-- process_sh&#45;&gt;parse_rpath -->
<g id="edge11" class="edge">
<title>process_sh&#45;&gt;parse_rpath</title>
<path fill="none" stroke="black" d="M151.1,-509.97C151.1,-498.19 151.1,-482.56 151.1,-469.16"/>
<polygon fill="black" stroke="black" points="154.6,-469 151.1,-459 147.6,-469 154.6,-469"/>
<text text-anchor="middle" x="201.6" y="-480.8" font-family="Courier New" font-size="14.00">找到.dynstr节</text>
</g>
<!-- try_dl_dir -->
<g id="node11" class="node">
<title>try_dl_dir</title>
<polygon fill="lightblue" stroke="black" points="344.6,-370 171.6,-370 171.6,-334 344.6,-334 344.6,-370"/>
<text text-anchor="middle" x="258.1" y="-348.3" font-family="Courier New" font-size="14.00">尝试动态链接器所在目录</text>
</g>
<!-- parse_rpath&#45;&gt;try_dl_dir -->
<g id="edge13" class="edge">
<title>parse_rpath&#45;&gt;try_dl_dir</title>
<path fill="none" stroke="black" d="M173.53,-420.97C189.54,-408.1 211.23,-390.67 228.63,-376.68"/>
<polygon fill="black" stroke="black" points="231.19,-379.12 236.79,-370.13 226.8,-373.66 231.19,-379.12"/>
<text text-anchor="middle" x="236.6" y="-391.8" font-family="Courier New" font-size="14.00">未找到</text>
</g>
<!-- setup_result -->
<g id="node14" class="node">
<title>setup_result</title>
<polygon fill="lightblue" stroke="black" points="166.1,-109 64.1,-109 64.1,-73 166.1,-73 166.1,-109"/>
<text text-anchor="middle" x="115.1" y="-87.3" font-family="Courier New" font-size="14.00">设置结果参数</text>
</g>
<!-- parse_rpath&#45;&gt;setup_result -->
<g id="edge12" class="edge">
<title>parse_rpath&#45;&gt;setup_result</title>
<path fill="none" stroke="black" d="M132.03,-420.76C117.19,-404.53 99.1,-379.35 99.1,-353 99.1,-353 99.1,-353 99.1,-177 99.1,-157.41 103.25,-135.72 107.32,-119.15"/>
<polygon fill="black" stroke="black" points="110.81,-119.64 109.95,-109.08 104.04,-117.88 110.81,-119.64"/>
<text text-anchor="middle" x="148.6" y="-261.3" font-family="Courier New" font-size="14.00">找到glibc版本</text>
</g>
<!-- try_symlink -->
<g id="node12" class="node">
<title>try_symlink</title>
<polygon fill="lightblue" stroke="black" points="389.6,-283 216.6,-283 216.6,-247 389.6,-247 389.6,-283"/>
<text text-anchor="middle" x="303.1" y="-261.3" font-family="Courier New" font-size="14.00">解析动态链接器符号链接</text>
</g>
<!-- try_dl_dir&#45;&gt;try_symlink -->
<g id="edge14" class="edge">
<title>try_dl_dir&#45;&gt;try_symlink</title>
<path fill="none" stroke="black" d="M267.2,-333.8C273.55,-321.82 282.12,-305.62 289.3,-292.06"/>
<polygon fill="black" stroke="black" points="292.42,-293.65 294,-283.18 286.23,-290.38 292.42,-293.65"/>
<text text-anchor="middle" x="305.6" y="-304.8" font-family="Courier New" font-size="14.00">仍失败</text>
</g>
<!-- fallback_path -->
<g id="node13" class="node">
<title>fallback_path</title>
<polygon fill="lightblue" stroke="black" points="333.1,-196 175.1,-196 175.1,-160 333.1,-160 333.1,-196"/>
<text text-anchor="middle" x="254.1" y="-174.3" font-family="Courier New" font-size="14.00">硬编码路径查找glibc</text>
</g>
<!-- try_symlink&#45;&gt;fallback_path -->
<g id="edge15" class="edge">
<title>try_symlink&#45;&gt;fallback_path</title>
<path fill="none" stroke="black" d="M293.18,-246.8C286.27,-234.82 276.93,-218.62 269.12,-205.06"/>
<polygon fill="black" stroke="black" points="272.02,-203.09 264,-196.18 265.96,-206.59 272.02,-203.09"/>
<text text-anchor="middle" x="303.6" y="-217.8" font-family="Courier New" font-size="14.00">仍失败</text>
</g>
<!-- fallback_path&#45;&gt;setup_result -->
<g id="edge16" class="edge">
<title>fallback_path&#45;&gt;setup_result</title>
<path fill="none" stroke="black" d="M225.97,-159.8C204.58,-146.72 174.98,-128.62 151.75,-114.41"/>
<polygon fill="black" stroke="black" points="153.54,-111.41 143.18,-109.18 149.89,-117.38 153.54,-111.41"/>
<text text-anchor="middle" x="243.1" y="-130.8" font-family="Courier New" font-size="14.00">找到或最终失败</text>
</g>
<!-- setup_result&#45;&gt;end -->
<g id="edge17" class="edge">
<title>setup_result&#45;&gt;end</title>
<path fill="none" stroke="black" d="M98.88,-72.81C90.44,-63.88 80,-52.8 70.77,-43.03"/>
<polygon fill="black" stroke="black" points="73.11,-40.41 63.7,-35.54 68.02,-45.22 73.11,-40.41"/>
</g>
</g>
</svg>
