graph TD
    A[开始] --> B{是否已处理过该声明?}
    B -->|是| C[返回]
    B -->|否| D[获取记录位置和作用域信息]
    D --> E{是联合体/结构体?}
    E -->|否| F[报错并记录到decl_table]
    F --> C
    E -->|是| G[确定容器类型和名称]
    G --> H{是否有typedef别名?}
    H -->|是| I[使用typedef名称]
    H -->|否| J[生成临时名称(未命名情况)]
    J --> K[组合完整名称]
    K --> L[记录到decl_table]
    L --> M{是否有定义?}
    M -->|否| N[生成不透明类型节点]
    N --> O[添加到顶层或作用域]
    M -->|是| P[初始化字段和函数列表]
    P --> Q[遍历字段]
    Q --> R{是否位域?}
    R -->|是| S[标记为不透明类型]
    S --> N
    R -->|否| T{是否匿名字段?}
    T -->|是| U[生成匿名字段名]
    U --> V[处理字段类型]
    T -->|否| V
    V --> W{是否灵活数组?}
    W -->|是| X[生成灵活数组处理函数]
    X --> Q
    W -->|否| Y[转换字段类型]
    Y --> Z{类型是否支持?}
    Z -->|否| S
    Z -->|是| AA[记录字段信息]
    AA --> Q
    Q -->|处理完毕| AB[生成结构体/联合体节点]
    AB --> AC[创建变量声明节点]
    AC --> AD{是否顶层作用域?}
    AD -->|是| AE[添加到顶层声明]
    AD -->|否| AF[添加到当前作用域]
    AE --> AG[处理别名]
    AG --> C
    AF --> C
