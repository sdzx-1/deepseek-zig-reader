<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="795pt" height="1126pt"
 viewBox="0.00 0.00 795.00 1126.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1122)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1122 791,-1122 791,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M251.5,-1118C251.5,-1118 30.5,-1118 30.5,-1118 24.5,-1118 18.5,-1112 18.5,-1106 18.5,-1106 18.5,-1094 18.5,-1094 18.5,-1088 24.5,-1082 30.5,-1082 30.5,-1082 251.5,-1082 251.5,-1082 257.5,-1082 263.5,-1088 263.5,-1094 263.5,-1094 263.5,-1106 263.5,-1106 263.5,-1112 257.5,-1118 251.5,-1118"/>
<text text-anchor="middle" x="141" y="-1096.3" font-family="Helvetica,sans-Serif" font-size="14.00">开始 detectAbiAndDynamicLinker</text>
</g>
<!-- check_conditions -->
<g id="node2" class="node">
<title>check_conditions</title>
<path fill="none" stroke="black" d="M213,-1045C213,-1045 69,-1045 69,-1045 63,-1045 57,-1039 57,-1033 57,-1033 57,-959 57,-959 57,-953 63,-947 69,-947 69,-947 213,-947 213,-947 219,-947 225,-953 225,-959 225,-959 225,-1033 225,-1033 225,-1039 219,-1045 213,-1045"/>
<text text-anchor="middle" x="141" y="-1029.8" font-family="Helvetica,sans-Serif" font-size="14.00">检查条件：</text>
<text text-anchor="middle" x="141" y="-1014.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; native_target_has_ld</text>
<text text-anchor="middle" x="141" y="-999.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; have_all_info</text>
<text text-anchor="middle" x="141" y="-984.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; os_is_non_native</text>
<text text-anchor="middle" x="141" y="-969.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; is_solarish</text>
<text text-anchor="middle" x="141" y="-954.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; is_darwin</text>
</g>
<!-- start&#45;&gt;check_conditions -->
<g id="edge1" class="edge">
<title>start&#45;&gt;check_conditions</title>
<path fill="none" stroke="black" d="M141,-1081.7C141,-1074.19 141,-1064.92 141,-1055.29"/>
<polygon fill="black" stroke="black" points="144.5,-1055.19 141,-1045.19 137.5,-1055.19 144.5,-1055.19"/>
</g>
<!-- return_default_early -->
<g id="node3" class="node">
<title>return_default_early</title>
<path fill="none" stroke="black" d="M238,-809C238,-809 12,-809 12,-809 6,-809 0,-803 0,-797 0,-797 0,-785 0,-785 0,-779 6,-773 12,-773 12,-773 238,-773 238,-773 244,-773 250,-779 250,-785 250,-785 250,-797 250,-797 250,-803 244,-809 238,-809"/>
<text text-anchor="middle" x="125" y="-787.3" font-family="Helvetica,sans-Serif" font-size="14.00">返回 defaultAbiAndDynamicLinker</text>
</g>
<!-- check_conditions&#45;&gt;return_default_early -->
<g id="edge2" class="edge">
<title>check_conditions&#45;&gt;return_default_early</title>
<path fill="none" stroke="black" d="M137.21,-946.89C134.07,-907.07 129.72,-851.93 127.15,-819.31"/>
<polygon fill="black" stroke="black" points="130.63,-818.86 126.35,-809.17 123.65,-819.41 130.63,-818.86"/>
<text text-anchor="middle" x="162" y="-874.3" font-family="Helvetica,sans-Serif" font-size="14.00">条件满足</text>
</g>
<!-- check_abi_musl -->
<g id="node4" class="node">
<title>check_abi_musl</title>
<path fill="none" stroke="black" d="M410.5,-896C410.5,-896 213.5,-896 213.5,-896 207.5,-896 201.5,-890 201.5,-884 201.5,-884 201.5,-872 201.5,-872 201.5,-866 207.5,-860 213.5,-860 213.5,-860 410.5,-860 410.5,-860 416.5,-860 422.5,-866 422.5,-872 422.5,-872 422.5,-884 422.5,-884 422.5,-890 416.5,-896 410.5,-896"/>
<text text-anchor="middle" x="312" y="-874.3" font-family="Helvetica,sans-Serif" font-size="14.00">query.abi 是否存在且为 musl？</text>
</g>
<!-- check_conditions&#45;&gt;check_abi_musl -->
<g id="edge3" class="edge">
<title>check_conditions&#45;&gt;check_abi_musl</title>
<path fill="none" stroke="black" d="M212.03,-946.81C235.11,-931.16 259.64,-914.52 278.62,-901.65"/>
<polygon fill="black" stroke="black" points="280.61,-904.52 286.92,-896.01 276.68,-898.73 280.61,-904.52"/>
<text text-anchor="middle" x="292" y="-917.8" font-family="Helvetica,sans-Serif" font-size="14.00">条件不满足</text>
</g>
<!-- end -->
<g id="node16" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M518,-36C518,-36 488,-36 488,-36 482,-36 476,-30 476,-24 476,-24 476,-12 476,-12 476,-6 482,0 488,0 488,0 518,0 518,0 524,0 530,-6 530,-12 530,-12 530,-24 530,-24 530,-30 524,-36 518,-36"/>
<text text-anchor="middle" x="503" y="-14.3" font-family="Helvetica,sans-Serif" font-size="14.00">结束</text>
</g>
<!-- return_default_early&#45;&gt;end -->
<g id="edge20" class="edge">
<title>return_default_early&#45;&gt;end</title>
<path fill="none" stroke="black" d="M129.75,-772.82C134.14,-755.38 140,-727.52 140,-703 140,-703 140,-703 140,-90 140,-24.15 372.99,-18.24 465.65,-18.49"/>
<polygon fill="black" stroke="black" points="465.7,-21.99 475.72,-18.55 465.73,-14.99 465.7,-21.99"/>
</g>
<!-- check_abi_musl&#45;&gt;return_default_early -->
<g id="edge4" class="edge">
<title>check_abi_musl&#45;&gt;return_default_early</title>
<path fill="none" stroke="black" d="M274.16,-859.8C244.66,-846.39 203.54,-827.7 171.94,-813.34"/>
<polygon fill="black" stroke="black" points="173.02,-809.98 162.47,-809.03 170.12,-816.35 173.02,-809.98"/>
<text text-anchor="middle" x="255" y="-830.8" font-family="Helvetica,sans-Serif" font-size="14.00">是 musl</text>
</g>
<!-- build_abi_list -->
<g id="node5" class="node">
<title>build_abi_list</title>
<path fill="none" stroke="black" d="M432,-809C432,-809 280,-809 280,-809 274,-809 268,-803 268,-797 268,-797 268,-785 268,-785 268,-779 274,-773 280,-773 280,-773 432,-773 432,-773 438,-773 444,-779 444,-785 444,-785 444,-797 444,-797 444,-803 438,-809 432,-809"/>
<text text-anchor="middle" x="356" y="-787.3" font-family="Helvetica,sans-Serif" font-size="14.00">构建所有可能的 ABI 列表</text>
</g>
<!-- check_abi_musl&#45;&gt;build_abi_list -->
<g id="edge5" class="edge">
<title>check_abi_musl&#45;&gt;build_abi_list</title>
<path fill="none" stroke="black" d="M320.9,-859.8C327.11,-847.82 335.49,-831.62 342.51,-818.06"/>
<polygon fill="black" stroke="black" points="345.62,-819.67 347.11,-809.18 339.4,-816.45 345.62,-819.67"/>
<text text-anchor="middle" x="369" y="-830.8" font-family="Helvetica,sans-Serif" font-size="14.00">不是 musl</text>
</g>
<!-- handle_ld_kind -->
<g id="node6" class="node">
<title>handle_ld_kind</title>
<path fill="none" stroke="black" d="M440.5,-736C440.5,-736 269.5,-736 269.5,-736 263.5,-736 257.5,-730 257.5,-724 257.5,-724 257.5,-680 257.5,-680 257.5,-674 263.5,-668 269.5,-668 269.5,-668 440.5,-668 440.5,-668 446.5,-668 452.5,-674 452.5,-680 452.5,-680 452.5,-724 452.5,-724 452.5,-730 446.5,-736 440.5,-736"/>
<text text-anchor="middle" x="355" y="-720.8" font-family="Helvetica,sans-Serif" font-size="14.00">根据动态链接器类型处理：</text>
<text text-anchor="middle" x="355" y="-705.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; .none</text>
<text text-anchor="middle" x="355" y="-690.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; .arch_os</text>
<text text-anchor="middle" x="355" y="-675.8" font-family="Helvetica,sans-Serif" font-size="14.00">&#45; .arch_os_abi（遍历 ABI）</text>
</g>
<!-- build_abi_list&#45;&gt;handle_ld_kind -->
<g id="edge6" class="edge">
<title>build_abi_list&#45;&gt;handle_ld_kind</title>
<path fill="none" stroke="black" d="M355.8,-772.81C355.71,-765.1 355.6,-755.63 355.5,-746.17"/>
<polygon fill="black" stroke="black" points="358.99,-745.96 355.38,-736 351.99,-746.04 358.99,-745.96"/>
</g>
<!-- try_open_env -->
<g id="node7" class="node">
<title>try_open_env</title>
<path fill="none" stroke="black" d="M458.5,-617C458.5,-617 241.5,-617 241.5,-617 235.5,-617 229.5,-611 229.5,-605 229.5,-605 229.5,-593 229.5,-593 229.5,-587 235.5,-581 241.5,-581 241.5,-581 458.5,-581 458.5,-581 464.5,-581 470.5,-587 470.5,-593 470.5,-593 470.5,-605 470.5,-605 470.5,-611 464.5,-617 458.5,-617"/>
<text text-anchor="middle" x="350" y="-595.3" font-family="Helvetica,sans-Serif" font-size="14.00">尝试打开 /usr/bin/env 或 /bin/env</text>
</g>
<!-- handle_ld_kind&#45;&gt;try_open_env -->
<g id="edge7" class="edge">
<title>handle_ld_kind&#45;&gt;try_open_env</title>
<path fill="none" stroke="black" d="M353.36,-667.93C352.72,-654.85 351.98,-639.99 351.36,-627.51"/>
<polygon fill="black" stroke="black" points="354.84,-627.07 350.85,-617.26 347.85,-627.42 354.84,-627.07"/>
<text text-anchor="middle" x="423.5" y="-638.8" font-family="Helvetica,sans-Serif" font-size="14.00">处理完动态链接器类型</text>
</g>
<!-- read_file_content -->
<g id="node8" class="node">
<title>read_file_content</title>
<path fill="none" stroke="black" d="M577.5,-530C577.5,-530 438.5,-530 438.5,-530 432.5,-530 426.5,-524 426.5,-518 426.5,-518 426.5,-506 426.5,-506 426.5,-500 432.5,-494 438.5,-494 438.5,-494 577.5,-494 577.5,-494 583.5,-494 589.5,-500 589.5,-506 589.5,-506 589.5,-518 589.5,-518 589.5,-524 583.5,-530 577.5,-530"/>
<text text-anchor="middle" x="508" y="-508.3" font-family="Helvetica,sans-Serif" font-size="14.00">读取文件内容前 4 字节</text>
</g>
<!-- try_open_env&#45;&gt;read_file_content -->
<g id="edge8" class="edge">
<title>try_open_env&#45;&gt;read_file_content</title>
<path fill="none" stroke="black" d="M381.97,-580.8C406.58,-567.56 440.74,-549.18 467.3,-534.9"/>
<polygon fill="black" stroke="black" points="469.2,-537.85 476.34,-530.03 465.88,-531.69 469.2,-537.85"/>
<text text-anchor="middle" x="481" y="-551.8" font-family="Helvetica,sans-Serif" font-size="14.00">文件打开成功</text>
</g>
<!-- return_default_fallback -->
<g id="node15" class="node">
<title>return_default_fallback</title>
<path fill="none" stroke="black" d="M616,-109C616,-109 390,-109 390,-109 384,-109 378,-103 378,-97 378,-97 378,-85 378,-85 378,-79 384,-73 390,-73 390,-73 616,-73 616,-73 622,-73 628,-79 628,-85 628,-85 628,-97 628,-97 628,-103 622,-109 616,-109"/>
<text text-anchor="middle" x="503" y="-87.3" font-family="Helvetica,sans-Serif" font-size="14.00">返回 defaultAbiAndDynamicLinker</text>
</g>
<!-- try_open_env&#45;&gt;return_default_fallback -->
<g id="edge9" class="edge">
<title>try_open_env&#45;&gt;return_default_fallback</title>
<path fill="none" stroke="black" d="M257.76,-580.85C223.59,-568.69 193,-548.02 193,-513 193,-513 193,-513 193,-177 193,-138.26 284.2,-116.53 367.67,-104.77"/>
<polygon fill="black" stroke="black" points="368.37,-108.2 377.8,-103.38 367.42,-101.27 368.37,-108.2"/>
<text text-anchor="middle" x="236" y="-348.3" font-family="Helvetica,sans-Serif" font-size="14.00">文件打开失败</text>
</g>
<!-- check_elf_magic -->
<g id="node9" class="node">
<title>check_elf_magic</title>
<path fill="none" stroke="black" d="M653.5,-457C653.5,-457 464.5,-457 464.5,-457 458.5,-457 452.5,-451 452.5,-445 452.5,-445 452.5,-433 452.5,-433 452.5,-427 458.5,-421 464.5,-421 464.5,-421 653.5,-421 653.5,-421 659.5,-421 665.5,-427 665.5,-433 665.5,-433 665.5,-445 665.5,-445 665.5,-451 659.5,-457 653.5,-457"/>
<text text-anchor="middle" x="559" y="-435.3" font-family="Helvetica,sans-Serif" font-size="14.00">内容是否以 ELF MAGIC 开头？</text>
</g>
<!-- read_file_content&#45;&gt;check_elf_magic -->
<g id="edge10" class="edge">
<title>read_file_content&#45;&gt;check_elf_magic</title>
<path fill="none" stroke="black" d="M520.35,-493.81C526.48,-485.27 534.02,-474.77 540.81,-465.32"/>
<polygon fill="black" stroke="black" points="543.78,-467.19 546.77,-457.03 538.09,-463.11 543.78,-467.19"/>
</g>
<!-- check_shebang -->
<g id="node10" class="node">
<title>check_shebang</title>
<path fill="none" stroke="black" d="M569.5,-370C569.5,-370 436.5,-370 436.5,-370 430.5,-370 424.5,-364 424.5,-358 424.5,-358 424.5,-346 424.5,-346 424.5,-340 430.5,-334 436.5,-334 436.5,-334 569.5,-334 569.5,-334 575.5,-334 581.5,-340 581.5,-346 581.5,-346 581.5,-358 581.5,-358 581.5,-364 575.5,-370 569.5,-370"/>
<text text-anchor="middle" x="503" y="-348.3" font-family="Helvetica,sans-Serif" font-size="14.00">内容是否以 #! 开头？</text>
</g>
<!-- check_elf_magic&#45;&gt;check_shebang -->
<g id="edge12" class="edge">
<title>check_elf_magic&#45;&gt;check_shebang</title>
<path fill="none" stroke="black" d="M547.67,-420.8C539.7,-408.7 528.89,-392.3 519.91,-378.67"/>
<polygon fill="black" stroke="black" points="522.74,-376.6 514.32,-370.18 516.89,-380.45 522.74,-376.6"/>
<text text-anchor="middle" x="562.5" y="-391.8" font-family="Helvetica,sans-Serif" font-size="14.00">不是 ELF</text>
</g>
<!-- open_elf_file -->
<g id="node12" class="node">
<title>open_elf_file</title>
<path fill="none" stroke="black" d="M697,-370C697,-370 615,-370 615,-370 609,-370 603,-364 603,-358 603,-358 603,-346 603,-346 603,-340 609,-334 615,-334 615,-334 697,-334 697,-334 703,-334 709,-340 709,-346 709,-346 709,-358 709,-358 709,-364 703,-370 697,-370"/>
<text text-anchor="middle" x="656" y="-348.3" font-family="Helvetica,sans-Serif" font-size="14.00">确认 ELF 文件</text>
</g>
<!-- check_elf_magic&#45;&gt;open_elf_file -->
<g id="edge11" class="edge">
<title>check_elf_magic&#45;&gt;open_elf_file</title>
<path fill="none" stroke="black" d="M578.63,-420.8C592.96,-408.24 612.58,-391.05 628.47,-377.12"/>
<polygon fill="black" stroke="black" points="631.19,-379.4 636.4,-370.18 626.57,-374.13 631.19,-379.4"/>
<text text-anchor="middle" x="634.5" y="-391.8" font-family="Helvetica,sans-Serif" font-size="14.00">是 ELF</text>
</g>
<!-- parse_shebang -->
<g id="node11" class="node">
<title>parse_shebang</title>
<path fill="none" stroke="black" d="M463,-283C463,-283 233,-283 233,-283 227,-283 221,-277 221,-271 221,-271 221,-259 221,-259 221,-253 227,-247 233,-247 233,-247 463,-247 463,-247 469,-247 475,-253 475,-259 475,-259 475,-271 475,-271 475,-277 469,-283 463,-283"/>
<text text-anchor="middle" x="348" y="-261.3" font-family="Helvetica,sans-Serif" font-size="14.00">解析 shebang 路径，更新 file_name</text>
</g>
<!-- check_shebang&#45;&gt;parse_shebang -->
<g id="edge13" class="edge">
<title>check_shebang&#45;&gt;parse_shebang</title>
<path fill="none" stroke="black" d="M449.67,-333.89C436.66,-328.86 423.03,-322.84 411,-316 398.14,-308.68 385.13,-298.85 374.29,-289.85"/>
<polygon fill="black" stroke="black" points="376.35,-287 366.48,-283.18 371.81,-292.33 376.35,-287"/>
<text text-anchor="middle" x="450" y="-304.8" font-family="Helvetica,sans-Serif" font-size="14.00">有 shebang</text>
</g>
<!-- check_shebang&#45;&gt;return_default_fallback -->
<g id="edge14" class="edge">
<title>check_shebang&#45;&gt;return_default_fallback</title>
<path fill="none" stroke="black" d="M503,-333.6C503,-289.46 503,-172.83 503,-119.42"/>
<polygon fill="black" stroke="black" points="506.5,-119.32 503,-109.32 499.5,-119.32 506.5,-119.32"/>
<text text-anchor="middle" x="556.5" y="-217.8" font-family="Helvetica,sans-Serif" font-size="14.00">无 shebang/ELF</text>
</g>
<!-- parse_shebang&#45;&gt;try_open_env -->
<g id="edge15" class="edge">
<title>parse_shebang&#45;&gt;try_open_env</title>
<path fill="none" stroke="black" d="M348,-283.26C348,-300.43 348,-327.54 348,-351 348,-513 348,-513 348,-513 348,-532.25 348.52,-553.95 349.03,-570.61"/>
<polygon fill="black" stroke="black" points="345.53,-570.86 349.36,-580.75 352.53,-570.64 345.53,-570.86"/>
<text text-anchor="middle" x="391" y="-435.3" font-family="Helvetica,sans-Serif" font-size="14.00">递归解析路径</text>
</g>
<!-- call_abi_from_file -->
<g id="node13" class="node">
<title>call_abi_from_file</title>
<path fill="none" stroke="black" d="M775,-283C775,-283 543,-283 543,-283 537,-283 531,-277 531,-271 531,-271 531,-259 531,-259 531,-253 537,-247 543,-247 543,-247 775,-247 775,-247 781,-247 787,-253 787,-259 787,-259 787,-271 787,-271 787,-277 781,-283 775,-283"/>
<text text-anchor="middle" x="659" y="-261.3" font-family="Helvetica,sans-Serif" font-size="14.00">调用 abiAndDynamicLinkerFromFile</text>
</g>
<!-- open_elf_file&#45;&gt;call_abi_from_file -->
<g id="edge16" class="edge">
<title>open_elf_file&#45;&gt;call_abi_from_file</title>
<path fill="none" stroke="black" d="M656.61,-333.8C657.02,-322.16 657.57,-306.55 658.04,-293.24"/>
<polygon fill="black" stroke="black" points="661.54,-293.29 658.39,-283.18 654.54,-293.05 661.54,-293.29"/>
</g>
<!-- handle_errors -->
<g id="node14" class="node">
<title>handle_errors</title>
<path fill="none" stroke="black" d="M664.5,-196C664.5,-196 543.5,-196 543.5,-196 537.5,-196 531.5,-190 531.5,-184 531.5,-184 531.5,-172 531.5,-172 531.5,-166 537.5,-160 543.5,-160 543.5,-160 664.5,-160 664.5,-160 670.5,-160 676.5,-166 676.5,-172 676.5,-172 676.5,-184 676.5,-184 676.5,-190 670.5,-196 664.5,-196"/>
<text text-anchor="middle" x="604" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00">处理错误，记录警告</text>
</g>
<!-- call_abi_from_file&#45;&gt;handle_errors -->
<g id="edge18" class="edge">
<title>call_abi_from_file&#45;&gt;handle_errors</title>
<path fill="none" stroke="black" d="M647.87,-246.8C640.04,-234.7 629.43,-218.3 620.61,-204.67"/>
<polygon fill="black" stroke="black" points="623.48,-202.67 615.11,-196.18 617.61,-206.47 623.48,-202.67"/>
<text text-anchor="middle" x="648.5" y="-217.8" font-family="Helvetica,sans-Serif" font-size="14.00">出错</text>
</g>
<!-- call_abi_from_file&#45;&gt;end -->
<g id="edge17" class="edge">
<title>call_abi_from_file&#45;&gt;end</title>
<path fill="none" stroke="black" d="M667.87,-246.94C674.34,-233.5 682.54,-214.09 686,-196 697.05,-138.2 681.22,-111.82 637,-73 609.26,-48.65 569.14,-34.45 540.03,-26.78"/>
<polygon fill="black" stroke="black" points="540.79,-23.36 530.24,-24.33 539.09,-30.15 540.79,-23.36"/>
<text text-anchor="middle" x="700.5" y="-130.8" font-family="Helvetica,sans-Serif" font-size="14.00">成功</text>
</g>
<!-- handle_errors&#45;&gt;return_default_fallback -->
<g id="edge19" class="edge">
<title>handle_errors&#45;&gt;return_default_fallback</title>
<path fill="none" stroke="black" d="M583.56,-159.8C568.5,-147.13 547.84,-129.73 531.21,-115.74"/>
<polygon fill="black" stroke="black" points="533.31,-112.94 523.41,-109.18 528.81,-118.29 533.31,-112.94"/>
</g>
<!-- return_default_fallback&#45;&gt;end -->
<g id="edge21" class="edge">
<title>return_default_fallback&#45;&gt;end</title>
<path fill="none" stroke="black" d="M503,-72.81C503,-64.79 503,-55.05 503,-46.07"/>
<polygon fill="black" stroke="black" points="506.5,-46.03 503,-36.03 499.5,-46.03 506.5,-46.03"/>
</g>
</g>
</svg>
