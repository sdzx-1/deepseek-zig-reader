graph TD
    A[开始] --> B[获取验证指令和初始化信息]
    B --> C[检查指令数量与数组长度是否匹配]
    C -->|不匹配| D[根据数组类型处理错误]
    D --> E{类型是结构体?}
    E -->|是| F[检查缺失字段并生成错误]
    E -->|否| G[生成数组或向量长度错误]
    F --> H[存在错误信息?]
    H -->|是| I[返回错误]
    H -->|否| J[填充默认值]
    C -->|匹配| K[处理编译时已知数组]
    K --> L[是否存在哨兵值?]
    L -->|是| M[存储哨兵值]
    L -->|否| N[检查数组是否只有一个可能值]
    N -->|是| O[存储该值]
    N -->|否| P[遍历元素指针]
    P --> Q[检查元素是否为编译时已知]
    Q -->|是| R[记录元素值]
    Q -->|否| S[标记数组非编译时]
    P --> T[所有元素处理完成?]
    T -->|否| P
    T -->|是| U{数组是否编译时已知?}
    U -->|是| V[优化存储为整体数组]
    U -->|否| W[保留逐个存储指令]
    V --> X[结束]
    W --> X
    I --> X
    G --> X
    J --> X
    M --> X
    O --> X
