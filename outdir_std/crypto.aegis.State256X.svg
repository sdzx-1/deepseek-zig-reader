<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: State256X_Flow Pages: 1 -->
<svg width="508pt" height="997pt"
 viewBox="0.00 0.00 508.00 997.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 993)">
<title>State256X_Flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-993 504,-993 504,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M323.5,-989C323.5,-989 176.5,-989 176.5,-989 170.5,-989 164.5,-983 164.5,-977 164.5,-977 164.5,-965 164.5,-965 164.5,-959 170.5,-953 176.5,-953 176.5,-953 323.5,-953 323.5,-953 329.5,-953 335.5,-959 335.5,-965 335.5,-965 335.5,-977 335.5,-977 335.5,-983 329.5,-989 323.5,-989"/>
<text text-anchor="middle" x="250" y="-967.3" font-family="Times,serif" font-size="14.00">开始 State256X 初始化</text>
</g>
<!-- init_constants -->
<g id="node2" class="node">
<title>init_constants</title>
<path fill="none" stroke="black" d="M297.5,-916C297.5,-916 202.5,-916 202.5,-916 196.5,-916 190.5,-910 190.5,-904 190.5,-904 190.5,-892 190.5,-892 190.5,-886 196.5,-880 202.5,-880 202.5,-880 297.5,-880 297.5,-880 303.5,-880 309.5,-886 309.5,-892 309.5,-892 309.5,-904 309.5,-904 309.5,-910 303.5,-916 297.5,-916"/>
<text text-anchor="middle" x="250" y="-894.3" font-family="Times,serif" font-size="14.00">创建常量 c1, c2</text>
</g>
<!-- start&#45;&gt;init_constants -->
<g id="edge1" class="edge">
<title>start&#45;&gt;init_constants</title>
<path fill="none" stroke="black" d="M250,-952.81C250,-944.79 250,-935.05 250,-926.07"/>
<polygon fill="black" stroke="black" points="253.5,-926.03 250,-916.03 246.5,-926.03 253.5,-926.03"/>
</g>
<!-- process_key_nonce -->
<g id="node3" class="node">
<title>process_key_nonce</title>
<path fill="none" stroke="black" d="M358.5,-843C358.5,-843 141.5,-843 141.5,-843 135.5,-843 129.5,-837 129.5,-831 129.5,-831 129.5,-819 129.5,-819 129.5,-813 135.5,-807 141.5,-807 141.5,-807 358.5,-807 358.5,-807 364.5,-807 370.5,-813 370.5,-819 370.5,-819 370.5,-831 370.5,-831 370.5,-837 364.5,-843 358.5,-843"/>
<text text-anchor="middle" x="250" y="-821.3" font-family="Times,serif" font-size="14.00">处理密钥和随机数生成 kxn1, kxn2</text>
</g>
<!-- init_constants&#45;&gt;process_key_nonce -->
<g id="edge2" class="edge">
<title>init_constants&#45;&gt;process_key_nonce</title>
<path fill="none" stroke="black" d="M250,-879.81C250,-871.79 250,-862.05 250,-853.07"/>
<polygon fill="black" stroke="black" points="253.5,-853.03 250,-843.03 246.5,-853.03 253.5,-853.03"/>
</g>
<!-- build_initial_blocks -->
<g id="node4" class="node">
<title>build_initial_blocks</title>
<path fill="none" stroke="black" d="M315.5,-770C315.5,-770 184.5,-770 184.5,-770 178.5,-770 172.5,-764 172.5,-758 172.5,-758 172.5,-746 172.5,-746 172.5,-740 178.5,-734 184.5,-734 184.5,-734 315.5,-734 315.5,-734 321.5,-734 327.5,-740 327.5,-746 327.5,-746 327.5,-758 327.5,-758 327.5,-764 321.5,-770 315.5,-770"/>
<text text-anchor="middle" x="250" y="-748.3" font-family="Times,serif" font-size="14.00">构建初始 blocks 数组</text>
</g>
<!-- process_key_nonce&#45;&gt;build_initial_blocks -->
<g id="edge3" class="edge">
<title>process_key_nonce&#45;&gt;build_initial_blocks</title>
<path fill="none" stroke="black" d="M250,-806.81C250,-798.79 250,-789.05 250,-780.07"/>
<polygon fill="black" stroke="black" points="253.5,-780.03 250,-770.03 246.5,-780.03 253.5,-780.03"/>
</g>
<!-- check_degree -->
<g id="node5" class="node">
<title>check_degree</title>
<path fill="none" stroke="black" d="M238.12,-695.29C238.12,-695.29 136.87,-680.71 136.87,-680.71 130.93,-679.86 130.93,-678.14 136.87,-677.29 136.87,-677.29 238.12,-662.71 238.12,-662.71 244.06,-661.86 255.94,-661.86 261.88,-662.71 261.88,-662.71 363.13,-677.29 363.13,-677.29 369.07,-678.14 369.07,-679.86 363.13,-680.71 363.13,-680.71 261.88,-695.29 261.88,-695.29 255.94,-696.14 244.06,-696.14 238.12,-695.29"/>
<text text-anchor="middle" x="250" y="-675.3" font-family="Times,serif" font-size="14.00">检查 degree &gt; 1?</text>
</g>
<!-- build_initial_blocks&#45;&gt;check_degree -->
<g id="edge4" class="edge">
<title>build_initial_blocks&#45;&gt;check_degree</title>
<path fill="none" stroke="black" d="M250,-733.81C250,-725.79 250,-716.05 250,-707.07"/>
<polygon fill="black" stroke="black" points="253.5,-707.03 250,-697.03 246.5,-707.03 253.5,-707.03"/>
</g>
<!-- degree_gt1 -->
<g id="node6" class="node">
<title>degree_gt1</title>
<path fill="none" stroke="black" d="M229.5,-610C229.5,-610 66.5,-610 66.5,-610 60.5,-610 54.5,-604 54.5,-598 54.5,-598 54.5,-509 54.5,-509 54.5,-503 60.5,-497 66.5,-497 66.5,-497 229.5,-497 229.5,-497 235.5,-497 241.5,-503 241.5,-509 241.5,-509 241.5,-598 241.5,-598 241.5,-604 235.5,-610 229.5,-610"/>
<text text-anchor="middle" x="148" y="-594.8" font-family="Times,serif" font-size="14.00">执行多上下文块更新</text>
<text text-anchor="middle" x="148" y="-579.8" font-family="Times,serif" font-size="14.00">循环4次:</text>
<text text-anchor="middle" x="148" y="-564.8" font-family="Times,serif" font-size="14.00">&#45; 异或上下文块</text>
<text text-anchor="middle" x="148" y="-549.8" font-family="Times,serif" font-size="14.00">&#45; 更新 state (key_block1)</text>
<text text-anchor="middle" x="148" y="-534.8" font-family="Times,serif" font-size="14.00">&#45; 更新 state (key_block2)</text>
<text text-anchor="middle" x="148" y="-519.8" font-family="Times,serif" font-size="14.00">&#45; 更新 state (kxn1)</text>
<text text-anchor="middle" x="148" y="-504.8" font-family="Times,serif" font-size="14.00">&#45; 更新 state (kxn2)</text>
</g>
<!-- check_degree&#45;&gt;degree_gt1 -->
<g id="edge5" class="edge">
<title>check_degree&#45;&gt;degree_gt1</title>
<path fill="none" stroke="black" d="M237.29,-662.61C227.88,-651.22 214.37,-634.87 200.71,-618.32"/>
<polygon fill="black" stroke="black" points="203.07,-615.68 194,-610.2 197.67,-620.14 203.07,-615.68"/>
<text text-anchor="middle" x="227.5" y="-631.8" font-family="Times,serif" font-size="14.00">是</text>
</g>
<!-- degree_eq1 -->
<g id="node7" class="node">
<title>degree_eq1</title>
<path fill="none" stroke="black" d="M434.5,-602.5C434.5,-602.5 271.5,-602.5 271.5,-602.5 265.5,-602.5 259.5,-596.5 259.5,-590.5 259.5,-590.5 259.5,-516.5 259.5,-516.5 259.5,-510.5 265.5,-504.5 271.5,-504.5 271.5,-504.5 434.5,-504.5 434.5,-504.5 440.5,-504.5 446.5,-510.5 446.5,-516.5 446.5,-516.5 446.5,-590.5 446.5,-590.5 446.5,-596.5 440.5,-602.5 434.5,-602.5"/>
<text text-anchor="middle" x="353" y="-587.3" font-family="Times,serif" font-size="14.00">执行简单块更新</text>
<text text-anchor="middle" x="353" y="-572.3" font-family="Times,serif" font-size="14.00">循环4次:</text>
<text text-anchor="middle" x="353" y="-557.3" font-family="Times,serif" font-size="14.00">&#45; 更新 state (key_block1)</text>
<text text-anchor="middle" x="353" y="-542.3" font-family="Times,serif" font-size="14.00">&#45; 更新 state (key_block2)</text>
<text text-anchor="middle" x="353" y="-527.3" font-family="Times,serif" font-size="14.00">&#45; 更新 state (kxn1)</text>
<text text-anchor="middle" x="353" y="-512.3" font-family="Times,serif" font-size="14.00">&#45; 更新 state (kxn2)</text>
</g>
<!-- check_degree&#45;&gt;degree_eq1 -->
<g id="edge6" class="edge">
<title>check_degree&#45;&gt;degree_eq1</title>
<path fill="none" stroke="black" d="M262.84,-662.61C273.83,-649.42 290.37,-629.59 306.29,-610.5"/>
<polygon fill="black" stroke="black" points="309.11,-612.6 312.82,-602.67 303.73,-608.11 309.11,-612.6"/>
<text text-anchor="middle" x="297.5" y="-631.8" font-family="Times,serif" font-size="14.00">否</text>
</g>
<!-- update_method -->
<g id="node8" class="node">
<title>update_method</title>
<path fill="none" stroke="black" d="M347,-446C347,-446 153,-446 153,-446 147,-446 141,-440 141,-434 141,-434 141,-390 141,-390 141,-384 147,-378 153,-378 153,-378 347,-378 347,-378 353,-378 359,-384 359,-390 359,-390 359,-434 359,-434 359,-440 353,-446 347,-446"/>
<text text-anchor="middle" x="250" y="-430.8" font-family="Times,serif" font-size="14.00">update 方法流程:</text>
<text text-anchor="middle" x="250" y="-415.8" font-family="Times,serif" font-size="14.00">1. 加密 blocks[5] 和 blocks[0]</text>
<text text-anchor="middle" x="250" y="-400.8" font-family="Times,serif" font-size="14.00">2. 循环移位加密块</text>
<text text-anchor="middle" x="250" y="-385.8" font-family="Times,serif" font-size="14.00">3. 异或输入数据到 blocks[0]</text>
</g>
<!-- degree_gt1&#45;&gt;update_method -->
<g id="edge7" class="edge">
<title>degree_gt1&#45;&gt;update_method</title>
<path fill="none" stroke="black" d="M188.61,-496.97C199,-482.74 210,-467.7 219.78,-454.34"/>
<polygon fill="black" stroke="black" points="222.61,-456.39 225.68,-446.25 216.96,-452.26 222.61,-456.39"/>
<text text-anchor="middle" x="253" y="-467.8" font-family="Times,serif" font-size="14.00">调用 update</text>
</g>
<!-- degree_eq1&#45;&gt;update_method -->
<g id="edge8" class="edge">
<title>degree_eq1&#45;&gt;update_method</title>
<path fill="none" stroke="black" d="M325.57,-504.49C317.24,-491.02 307.7,-476.62 298,-464 295.41,-460.64 292.64,-457.25 289.78,-453.89"/>
<polygon fill="black" stroke="black" points="292.23,-451.38 283,-446.18 286.98,-456 292.23,-451.38"/>
<text text-anchor="middle" x="350" y="-467.8" font-family="Times,serif" font-size="14.00">调用 update</text>
</g>
<!-- enc_method -->
<g id="node9" class="node">
<title>enc_method</title>
<path fill="none" stroke="black" d="M108,-327C108,-327 12,-327 12,-327 6,-327 0,-321 0,-315 0,-315 0,-286 0,-286 0,-280 6,-274 12,-274 12,-274 108,-274 108,-274 114,-274 120,-280 120,-286 120,-286 120,-315 120,-315 120,-321 114,-327 108,-327"/>
<text text-anchor="middle" x="60" y="-311.8" font-family="Times,serif" font-size="14.00">enc 方法流程:</text>
<text text-anchor="middle" x="60" y="-296.8" font-family="Times,serif" font-size="14.00">1. 生成加密数据</text>
<text text-anchor="middle" x="60" y="-281.8" font-family="Times,serif" font-size="14.00">2. 更新 state</text>
</g>
<!-- update_method&#45;&gt;enc_method -->
<g id="edge9" class="edge">
<title>update_method&#45;&gt;enc_method</title>
<path fill="none" stroke="black" d="M161.37,-377.86C149.86,-372.44 138.45,-366.45 128,-360 116.07,-352.63 104.12,-343.21 93.64,-334.09"/>
<polygon fill="black" stroke="black" points="95.72,-331.26 85.93,-327.21 91.06,-336.48 95.72,-331.26"/>
<text text-anchor="middle" x="164" y="-348.8" font-family="Times,serif" font-size="14.00">加密时调用</text>
</g>
<!-- dec_method -->
<g id="node10" class="node">
<title>dec_method</title>
<path fill="none" stroke="black" d="M246,-327C246,-327 150,-327 150,-327 144,-327 138,-321 138,-315 138,-315 138,-286 138,-286 138,-280 144,-274 150,-274 150,-274 246,-274 246,-274 252,-274 258,-280 258,-286 258,-286 258,-315 258,-315 258,-321 252,-327 246,-327"/>
<text text-anchor="middle" x="198" y="-311.8" font-family="Times,serif" font-size="14.00">dec 方法流程:</text>
<text text-anchor="middle" x="198" y="-296.8" font-family="Times,serif" font-size="14.00">1. 生成解密数据</text>
<text text-anchor="middle" x="198" y="-281.8" font-family="Times,serif" font-size="14.00">2. 更新 state</text>
</g>
<!-- update_method&#45;&gt;dec_method -->
<g id="edge10" class="edge">
<title>update_method&#45;&gt;dec_method</title>
<path fill="none" stroke="black" d="M218.67,-377.81C214.56,-372.18 210.82,-366.15 208,-360 204.75,-352.9 202.55,-344.88 201.06,-337.1"/>
<polygon fill="black" stroke="black" points="204.5,-336.44 199.48,-327.11 197.59,-337.54 204.5,-336.44"/>
<text text-anchor="middle" x="244" y="-348.8" font-family="Times,serif" font-size="14.00">解密时调用</text>
</g>
<!-- finalize_method -->
<g id="node11" class="node">
<title>finalize_method</title>
<path fill="none" stroke="black" d="M262,-155C262,-155 166,-155 166,-155 160,-155 154,-149 154,-143 154,-143 154,-99 154,-99 154,-93 160,-87 166,-87 166,-87 262,-87 262,-87 268,-87 274,-93 274,-99 274,-99 274,-143 274,-143 274,-149 268,-155 262,-155"/>
<text text-anchor="middle" x="214" y="-139.8" font-family="Times,serif" font-size="14.00">finalize 流程:</text>
<text text-anchor="middle" x="214" y="-124.8" font-family="Times,serif" font-size="14.00">1. 处理长度信息</text>
<text text-anchor="middle" x="214" y="-109.8" font-family="Times,serif" font-size="14.00">2. 7次更新</text>
<text text-anchor="middle" x="214" y="-94.8" font-family="Times,serif" font-size="14.00">3. 生成认证标签</text>
</g>
<!-- update_method&#45;&gt;finalize_method -->
<g id="edge11" class="edge">
<title>update_method&#45;&gt;finalize_method</title>
<path fill="none" stroke="black" d="M272.84,-377.83C275.79,-372.11 278.35,-366.05 280,-360 290.92,-319.9 298.32,-210.3 280,-173 278.3,-169.55 276.25,-166.26 273.93,-163.15"/>
<polygon fill="black" stroke="black" points="276.39,-160.63 267.23,-155.3 271.06,-165.18 276.39,-160.63"/>
<text text-anchor="middle" x="334" y="-296.8" font-family="Times,serif" font-size="14.00">最终化时调用</text>
</g>
<!-- finalizeMac_method -->
<g id="node12" class="node">
<title>finalizeMac_method</title>
<path fill="none" stroke="black" d="M478.5,-256C478.5,-256 325.5,-256 325.5,-256 319.5,-256 313.5,-250 313.5,-244 313.5,-244 313.5,-185 313.5,-185 313.5,-179 319.5,-173 325.5,-173 325.5,-173 478.5,-173 478.5,-173 484.5,-173 490.5,-179 490.5,-185 490.5,-185 490.5,-244 490.5,-244 490.5,-250 484.5,-256 478.5,-256"/>
<text text-anchor="middle" x="402" y="-240.8" font-family="Times,serif" font-size="14.00">finalizeMac 流程:</text>
<text text-anchor="middle" x="402" y="-225.8" font-family="Times,serif" font-size="14.00">1. 处理数据长度和标签位</text>
<text text-anchor="middle" x="402" y="-210.8" font-family="Times,serif" font-size="14.00">2. 7次更新</text>
<text text-anchor="middle" x="402" y="-195.8" font-family="Times,serif" font-size="14.00">3. 处理多 degree 标签</text>
<text text-anchor="middle" x="402" y="-180.8" font-family="Times,serif" font-size="14.00">4. 返回最终标签</text>
</g>
<!-- update_method&#45;&gt;finalizeMac_method -->
<g id="edge12" class="edge">
<title>update_method&#45;&gt;finalizeMac_method</title>
<path fill="none" stroke="black" d="M326.98,-377.88C348.58,-365.01 369.97,-348.17 384,-327 395.77,-309.24 400.79,-286.48 402.67,-266.15"/>
<polygon fill="black" stroke="black" points="406.17,-266.31 403.38,-256.09 399.19,-265.82 406.17,-266.31"/>
<text text-anchor="middle" x="424.5" y="-348.8" font-family="Times,serif" font-size="14.00">MAC 最终化调用</text>
</g>
<!-- enc_method&#45;&gt;finalize_method -->
<g id="edge13" class="edge">
<title>enc_method&#45;&gt;finalize_method</title>
<path fill="none" stroke="black" d="M68.56,-273.6C78.73,-246.02 97.92,-202.36 126,-173 131.79,-166.95 138.46,-161.39 145.47,-156.34"/>
<polygon fill="black" stroke="black" points="147.54,-159.17 153.84,-150.66 143.6,-153.38 147.54,-159.17"/>
<text text-anchor="middle" x="162" y="-210.8" font-family="Times,serif" font-size="14.00">加密后处理</text>
</g>
<!-- dec_method&#45;&gt;finalize_method -->
<g id="edge14" class="edge">
<title>dec_method&#45;&gt;finalize_method</title>
<path fill="none" stroke="black" d="M199.74,-273.79C201.55,-248.22 204.57,-207.86 208,-173 208.25,-170.48 208.52,-167.89 208.79,-165.27"/>
<polygon fill="black" stroke="black" points="212.29,-165.5 209.91,-155.18 205.33,-164.73 212.29,-165.5"/>
<text text-anchor="middle" x="244" y="-210.8" font-family="Times,serif" font-size="14.00">解密后处理</text>
</g>
<!-- end -->
<g id="node13" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M338,-36C338,-36 288,-36 288,-36 282,-36 276,-30 276,-24 276,-24 276,-12 276,-12 276,-6 282,0 288,0 288,0 338,0 338,0 344,0 350,-6 350,-12 350,-12 350,-24 350,-24 350,-30 344,-36 338,-36"/>
<text text-anchor="middle" x="313" y="-14.3" font-family="Times,serif" font-size="14.00">流程结束</text>
</g>
<!-- finalize_method&#45;&gt;end -->
<g id="edge15" class="edge">
<title>finalize_method&#45;&gt;end</title>
<path fill="none" stroke="black" d="M246.42,-86.93C260.28,-72.79 276.17,-56.57 288.95,-43.53"/>
<polygon fill="black" stroke="black" points="291.58,-45.85 296.08,-36.26 286.58,-40.95 291.58,-45.85"/>
<text text-anchor="middle" x="322" y="-57.8" font-family="Times,serif" font-size="14.00">返回认证标签</text>
</g>
<!-- finalizeMac_method&#45;&gt;end -->
<g id="edge16" class="edge">
<title>finalizeMac_method&#45;&gt;end</title>
<path fill="none" stroke="black" d="M402.21,-172.7C400.49,-138.24 393.39,-89.04 369,-54 366.01,-49.7 362.3,-45.82 358.22,-42.35"/>
<polygon fill="black" stroke="black" points="360.12,-39.39 350.03,-36.16 355.9,-44.98 360.12,-39.39"/>
<text text-anchor="middle" x="450" y="-117.3" font-family="Times,serif" font-size="14.00">返回 MAC 标签</text>
</g>
</g>
</svg>
