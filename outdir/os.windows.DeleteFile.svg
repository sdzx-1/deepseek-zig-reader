<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: DeleteFileFlow Pages: 1 -->
<svg width="573pt" height="1267pt"
 viewBox="0.00 0.00 572.50 1267.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1263)">
<title>DeleteFileFlow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1263 568.5,-1263 568.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="none" stroke="black" cx="86.5" cy="-1241" rx="29.5" ry="18"/>
<text text-anchor="middle" x="86.5" y="-1237.3" font-family="Arial" font-size="14.00">开始</text>
</g>
<!-- set_flags -->
<g id="node3" class="node">
<title>set_flags</title>
<polygon fill="none" stroke="black" points="173,-1186 0,-1186 0,-1148 173,-1148 173,-1186"/>
<text text-anchor="middle" x="86.5" y="-1170.8" font-family="Arial" font-size="14.00">设置 create_options_flags</text>
<text text-anchor="middle" x="86.5" y="-1155.8" font-family="Arial" font-size="14.00">根据 options.remove_dir</text>
</g>
<!-- start&#45;&gt;set_flags -->
<g id="edge1" class="edge">
<title>start&#45;&gt;set_flags</title>
<path fill="none" stroke="black" d="M86.5,-1222.94C86.5,-1214.99 86.5,-1205.31 86.5,-1196.31"/>
<polygon fill="black" stroke="black" points="90,-1196.2 86.5,-1186.2 83,-1196.2 90,-1196.2"/>
</g>
<!-- end -->
<g id="node2" class="node">
<title>end</title>
<ellipse fill="none" stroke="black" cx="189.5" cy="-18" rx="29.5" ry="18"/>
<text text-anchor="middle" x="189.5" y="-14.3" font-family="Arial" font-size="14.00">结束</text>
</g>
<!-- process_path -->
<g id="node4" class="node">
<title>process_path</title>
<polygon fill="none" stroke="black" points="147,-1111 26,-1111 26,-1073 147,-1073 147,-1111"/>
<text text-anchor="middle" x="86.5" y="-1095.8" font-family="Arial" font-size="14.00">处理 sub_path_w</text>
<text text-anchor="middle" x="86.5" y="-1080.8" font-family="Arial" font-size="14.00">生成 nt_name</text>
</g>
<!-- set_flags&#45;&gt;process_path -->
<g id="edge2" class="edge">
<title>set_flags&#45;&gt;process_path</title>
<path fill="none" stroke="black" d="M86.5,-1147.96C86.5,-1139.88 86.5,-1130.18 86.5,-1121.18"/>
<polygon fill="black" stroke="black" points="90,-1121.09 86.5,-1111.09 83,-1121.09 90,-1121.09"/>
</g>
<!-- check_dot -->
<g id="node5" class="node">
<title>check_dot</title>
<polygon fill="none" stroke="black" points="169,-1036 4,-1036 4,-1000 169,-1000 169,-1036"/>
<text text-anchor="middle" x="86.5" y="-1014.3" font-family="Arial" font-size="14.00">检查路径是否为 &#39;.&#39; 或 &#39;..&#39;</text>
</g>
<!-- process_path&#45;&gt;check_dot -->
<g id="edge3" class="edge">
<title>process_path&#45;&gt;check_dot</title>
<path fill="none" stroke="black" d="M86.5,-1072.83C86.5,-1064.89 86.5,-1055.41 86.5,-1046.63"/>
<polygon fill="black" stroke="black" points="90,-1046.42 86.5,-1036.42 83,-1046.42 90,-1046.42"/>
</g>
<!-- check_dot&#45;&gt;end -->
<g id="edge5" class="edge">
<title>check_dot&#45;&gt;end</title>
<path fill="none" stroke="black" d="M81.35,-999.92C76.67,-982.88 70.5,-955.88 70.5,-932 70.5,-932 70.5,-932 70.5,-90 70.5,-51.68 116.57,-33.56 151.37,-25.34"/>
<polygon fill="black" stroke="black" points="152.27,-28.72 161.3,-23.18 150.78,-21.88 152.27,-28.72"/>
<text text-anchor="middle" x="118" y="-541.8" font-family="Times,serif" font-size="14.00">路径是 &#39;..&#39;</text>
<text text-anchor="middle" x="118" y="-526.8" font-family="Times,serif" font-size="14.00">返回 FileBusy</text>
</g>
<!-- init_attr -->
<g id="node6" class="node">
<title>init_attr</title>
<polygon fill="none" stroke="black" points="351,-949 144,-949 144,-913 351,-913 351,-949"/>
<text text-anchor="middle" x="247.5" y="-927.3" font-family="Arial" font-size="14.00">初始化 OBJECT_ATTRIBUTES</text>
</g>
<!-- check_dot&#45;&gt;init_attr -->
<g id="edge4" class="edge">
<title>check_dot&#45;&gt;init_attr</title>
<path fill="none" stroke="black" d="M119.08,-999.8C144.26,-986.51 179.27,-968.02 206.38,-953.71"/>
<polygon fill="black" stroke="black" points="208.03,-956.79 215.24,-949.03 204.77,-950.6 208.03,-956.79"/>
<text text-anchor="middle" x="205.5" y="-970.8" font-family="Times,serif" font-size="14.00">路径正常</text>
</g>
<!-- nt_create -->
<g id="node7" class="node">
<title>nt_create</title>
<polygon fill="none" stroke="black" points="343.5,-876 219.5,-876 219.5,-840 343.5,-840 343.5,-876"/>
<text text-anchor="middle" x="281.5" y="-854.3" font-family="Arial" font-size="14.00">调用 NtCreateFile</text>
</g>
<!-- init_attr&#45;&gt;nt_create -->
<g id="edge6" class="edge">
<title>init_attr&#45;&gt;nt_create</title>
<path fill="none" stroke="black" d="M255.73,-912.81C259.7,-904.53 264.54,-894.41 268.96,-885.19"/>
<polygon fill="black" stroke="black" points="272.18,-886.56 273.35,-876.03 265.87,-883.54 272.18,-886.56"/>
</g>
<!-- handle_ntcreate_errors -->
<g id="node8" class="node">
<title>handle_ntcreate_errors</title>
<polygon fill="none" stroke="black" points="392.5,-803 236.5,-803 236.5,-767 392.5,-767 392.5,-803"/>
<text text-anchor="middle" x="314.5" y="-781.3" font-family="Arial" font-size="14.00">处理 NtCreateFile 错误</text>
</g>
<!-- nt_create&#45;&gt;handle_ntcreate_errors -->
<g id="edge7" class="edge">
<title>nt_create&#45;&gt;handle_ntcreate_errors</title>
<path fill="none" stroke="black" d="M289.49,-839.81C293.34,-831.53 298.04,-821.41 302.33,-812.19"/>
<polygon fill="black" stroke="black" points="305.54,-813.57 306.59,-803.03 299.2,-810.62 305.54,-813.57"/>
</g>
<!-- handle_ntcreate_errors&#45;&gt;end -->
<g id="edge9" class="edge">
<title>handle_ntcreate_errors&#45;&gt;end</title>
<path fill="none" stroke="black" d="M392.59,-779.57C445.75,-771.83 506.5,-751.49 506.5,-699 506.5,-699 506.5,-699 506.5,-90 506.5,-33.69 313.65,-22.03 228.79,-19.62"/>
<polygon fill="black" stroke="black" points="228.84,-16.12 218.75,-19.37 228.66,-23.12 228.84,-16.12"/>
<text text-anchor="middle" x="535.5" y="-377.8" font-family="Times,serif" font-size="14.00">返回错误</text>
</g>
<!-- defer_close -->
<g id="node9" class="node">
<title>defer_close</title>
<polygon fill="none" stroke="black" points="419,-716 210,-716 210,-680 419,-680 419,-716"/>
<text text-anchor="middle" x="314.5" y="-694.3" font-family="Arial" font-size="14.00">defer CloseHandle(tmp_handle)</text>
</g>
<!-- handle_ntcreate_errors&#45;&gt;defer_close -->
<g id="edge8" class="edge">
<title>handle_ntcreate_errors&#45;&gt;defer_close</title>
<path fill="none" stroke="black" d="M314.5,-766.8C314.5,-755.16 314.5,-739.55 314.5,-726.24"/>
<polygon fill="black" stroke="black" points="318,-726.18 314.5,-716.18 311,-726.18 318,-726.18"/>
<text text-anchor="middle" x="329" y="-737.8" font-family="Times,serif" font-size="14.00">成功</text>
</g>
<!-- check_win_version -->
<g id="node10" class="node">
<title>check_win_version</title>
<polygon fill="none" stroke="black" points="314.5,-643 154.63,-625 314.5,-607 474.37,-625 314.5,-643"/>
<text text-anchor="middle" x="314.5" y="-621.3" font-family="Arial" font-size="14.00">系统版本 &gt;= Win10 RS5?</text>
</g>
<!-- defer_close&#45;&gt;check_win_version -->
<g id="edge10" class="edge">
<title>defer_close&#45;&gt;check_win_version</title>
<path fill="none" stroke="black" d="M314.5,-679.81C314.5,-671.79 314.5,-662.05 314.5,-653.07"/>
<polygon fill="black" stroke="black" points="318,-653.03 314.5,-643.03 311,-653.03 318,-653.03"/>
</g>
<!-- try_ex_disposition -->
<g id="node11" class="node">
<title>try_ex_disposition</title>
<polygon fill="none" stroke="black" points="415.5,-556 195.5,-556 195.5,-520 415.5,-520 415.5,-556"/>
<text text-anchor="middle" x="305.5" y="-534.3" font-family="Arial" font-size="14.00">尝试 FileDispositionInformationEx</text>
</g>
<!-- check_win_version&#45;&gt;try_ex_disposition -->
<g id="edge11" class="edge">
<title>check_win_version&#45;&gt;try_ex_disposition</title>
<path fill="none" stroke="black" d="M312.68,-606.8C311.45,-595.16 309.79,-579.55 308.38,-566.24"/>
<polygon fill="black" stroke="black" points="311.85,-565.75 307.32,-556.18 304.89,-566.49 311.85,-565.75"/>
<text text-anchor="middle" x="318" y="-577.8" font-family="Times,serif" font-size="14.00">是</text>
</g>
<!-- set_disposition -->
<g id="node14" class="node">
<title>set_disposition</title>
<polygon fill="none" stroke="black" points="420.5,-269 216.5,-269 216.5,-233 420.5,-233 420.5,-269"/>
<text text-anchor="middle" x="318.5" y="-247.3" font-family="Arial" font-size="14.00">设置 FileDispositionInformation</text>
</g>
<!-- check_win_version&#45;&gt;set_disposition -->
<g id="edge12" class="edge">
<title>check_win_version&#45;&gt;set_disposition</title>
<path fill="none" stroke="black" d="M375.96,-613.83C417.01,-603.12 463.5,-581.59 463.5,-539 463.5,-539 463.5,-539 463.5,-337 463.5,-305.53 437.77,-285.49 407.98,-272.84"/>
<polygon fill="black" stroke="black" points="409.22,-269.56 398.63,-269.14 406.65,-276.07 409.22,-269.56"/>
<text text-anchor="middle" x="471" y="-441.3" font-family="Times,serif" font-size="14.00">否</text>
</g>
<!-- handle_ex_result -->
<g id="node12" class="node">
<title>handle_ex_result</title>
<polygon fill="none" stroke="black" points="214.5,-483 98.5,-445 214.5,-407 330.5,-445 214.5,-483"/>
<text text-anchor="middle" x="214.5" y="-448.8" font-family="Arial" font-size="14.00">处理设置结果</text>
<text text-anchor="middle" x="214.5" y="-433.8" font-family="Arial" font-size="14.00">是否需要回退？</text>
</g>
<!-- try_ex_disposition&#45;&gt;handle_ex_result -->
<g id="edge13" class="edge">
<title>try_ex_disposition&#45;&gt;handle_ex_result</title>
<path fill="none" stroke="black" d="M288.38,-519.88C277.52,-509.02 263.07,-494.57 249.83,-481.33"/>
<polygon fill="black" stroke="black" points="252.17,-478.73 242.63,-474.13 247.23,-483.67 252.17,-478.73"/>
</g>
<!-- fallback -->
<g id="node13" class="node">
<title>fallback</title>
<polygon fill="none" stroke="black" points="427.5,-356 209.5,-356 209.5,-320 427.5,-320 427.5,-356"/>
<text text-anchor="middle" x="318.5" y="-334.3" font-family="Arial" font-size="14.00">回退到 FileDispositionInformation</text>
</g>
<!-- handle_ex_result&#45;&gt;fallback -->
<g id="edge14" class="edge">
<title>handle_ex_result&#45;&gt;fallback</title>
<path fill="none" stroke="black" d="M207.23,-409.37C206.57,-397.18 208.21,-384.03 215.5,-374 218.83,-369.42 222.8,-365.43 227.2,-361.96"/>
<polygon fill="black" stroke="black" points="229.28,-364.78 235.56,-356.25 225.33,-359 229.28,-364.78"/>
<text text-anchor="middle" x="332.5" y="-377.8" font-family="Times,serif" font-size="14.00">需要回退 (INVALID_PARAMETER)</text>
</g>
<!-- handle_disposition_errors -->
<g id="node15" class="node">
<title>handle_disposition_errors</title>
<polygon fill="none" stroke="black" points="257.5,-196 155.5,-196 155.5,-160 257.5,-160 257.5,-196"/>
<text text-anchor="middle" x="206.5" y="-174.3" font-family="Arial" font-size="14.00">处理设置错误</text>
</g>
<!-- handle_ex_result&#45;&gt;handle_disposition_errors -->
<g id="edge16" class="edge">
<title>handle_ex_result&#45;&gt;handle_disposition_errors</title>
<path fill="none" stroke="black" d="M207.84,-409.14C206.66,-402.46 205.49,-395.53 204.5,-389 202.29,-374.39 201.39,-370.75 200.5,-356 197.31,-303.1 201.13,-241.21 203.97,-206.4"/>
<polygon fill="black" stroke="black" points="207.49,-206.36 204.85,-196.1 200.51,-205.77 207.49,-206.36"/>
<text text-anchor="middle" x="228.5" y="-290.8" font-family="Times,serif" font-size="14.00">其他错误</text>
</g>
<!-- success -->
<g id="node16" class="node">
<title>success</title>
<polygon fill="none" stroke="black" points="172.5,-109 98.5,-109 98.5,-73 172.5,-73 172.5,-109"/>
<text text-anchor="middle" x="135.5" y="-87.3" font-family="Arial" font-size="14.00">删除成功</text>
</g>
<!-- handle_ex_result&#45;&gt;success -->
<g id="edge15" class="edge">
<title>handle_ex_result&#45;&gt;success</title>
<path fill="none" stroke="black" d="M175.81,-419.57C151.42,-400.86 124.5,-372.61 124.5,-339 124.5,-339 124.5,-339 124.5,-177 124.5,-157.59 127.36,-135.9 130.16,-119.28"/>
<polygon fill="black" stroke="black" points="133.65,-119.63 131.96,-109.17 126.76,-118.4 133.65,-119.63"/>
<text text-anchor="middle" x="139" y="-247.3" font-family="Times,serif" font-size="14.00">成功</text>
</g>
<!-- fallback&#45;&gt;set_disposition -->
<g id="edge17" class="edge">
<title>fallback&#45;&gt;set_disposition</title>
<path fill="none" stroke="black" d="M318.5,-319.8C318.5,-308.16 318.5,-292.55 318.5,-279.24"/>
<polygon fill="black" stroke="black" points="322,-279.18 318.5,-269.18 315,-279.18 322,-279.18"/>
</g>
<!-- set_disposition&#45;&gt;handle_disposition_errors -->
<g id="edge18" class="edge">
<title>set_disposition&#45;&gt;handle_disposition_errors</title>
<path fill="none" stroke="black" d="M291.67,-232.99C276.82,-223.58 258.17,-211.76 242.11,-201.57"/>
<polygon fill="black" stroke="black" points="243.82,-198.51 233.5,-196.11 240.07,-204.42 243.82,-198.51"/>
</g>
<!-- handle_disposition_errors&#45;&gt;end -->
<g id="edge20" class="edge">
<title>handle_disposition_errors&#45;&gt;end</title>
<path fill="none" stroke="black" d="M204.65,-159.79C201.71,-132.48 195.96,-78.99 192.45,-46.38"/>
<polygon fill="black" stroke="black" points="195.9,-45.76 191.35,-36.19 188.94,-46.51 195.9,-45.76"/>
<text text-anchor="middle" x="227.5" y="-87.3" font-family="Times,serif" font-size="14.00">返回错误</text>
</g>
<!-- handle_disposition_errors&#45;&gt;success -->
<g id="edge19" class="edge">
<title>handle_disposition_errors&#45;&gt;success</title>
<path fill="none" stroke="black" d="M183.58,-159.69C177.33,-154.39 170.82,-148.29 165.5,-142 159.32,-134.7 153.62,-125.98 148.88,-117.88"/>
<polygon fill="black" stroke="black" points="151.91,-116.13 143.97,-109.11 145.8,-119.55 151.91,-116.13"/>
<text text-anchor="middle" x="180" y="-130.8" font-family="Times,serif" font-size="14.00">成功</text>
</g>
<!-- success&#45;&gt;end -->
<g id="edge21" class="edge">
<title>success&#45;&gt;end</title>
<path fill="none" stroke="black" d="M148.57,-72.81C155.43,-63.8 163.93,-52.61 171.41,-42.78"/>
<polygon fill="black" stroke="black" points="174.39,-44.65 177.65,-34.58 168.81,-40.42 174.39,-44.65"/>
</g>
</g>
</svg>
