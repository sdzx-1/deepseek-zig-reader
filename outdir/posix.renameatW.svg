<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: renameatW_flowchart Pages: 1 -->
<svg width="542pt" height="630pt"
 viewBox="0.00 0.00 542.04 630.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 626)">
<title>renameatW_flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-626 538.04,-626 538.04,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<polygon fill="none" stroke="black" points="403.54,-622 288.54,-622 288.54,-586 403.54,-586 403.54,-622"/>
<text text-anchor="middle" x="346.04" y="-601.5" font-family="Courier,monospace" font-size="10.00">函数入口 renameatW</text>
</g>
<!-- open_old_file -->
<g id="node2" class="node">
<title>open_old_file</title>
<polygon fill="none" stroke="black" points="442.04,-549 250.04,-549 250.04,-513 442.04,-513 442.04,-549"/>
<text text-anchor="middle" x="346.04" y="-534" font-family="Courier,monospace" font-size="10.00">调用 windows.OpenFile 打开旧文件</text>
<text text-anchor="middle" x="346.04" y="-523" font-family="Courier,monospace" font-size="10.00">获取 src_fd</text>
</g>
<!-- start&#45;&gt;open_old_file -->
<g id="edge1" class="edge">
<title>start&#45;&gt;open_old_file</title>
<path fill="none" stroke="black" d="M346.04,-585.81C346.04,-577.79 346.04,-568.05 346.04,-559.07"/>
<polygon fill="black" stroke="black" points="349.54,-559.03 346.04,-549.03 342.54,-559.03 349.54,-559.03"/>
</g>
<!-- check_win_version -->
<g id="node3" class="node">
<title>check_win_version</title>
<polygon fill="none" stroke="black" points="266.04,-476 133.81,-458 266.04,-440 398.28,-458 266.04,-476"/>
<text text-anchor="middle" x="266.04" y="-455.5" font-family="Courier,monospace" font-size="10.00">检查系统版本 &gt;= Win10 RS5?</text>
</g>
<!-- open_old_file&#45;&gt;check_win_version -->
<g id="edge2" class="edge">
<title>open_old_file&#45;&gt;check_win_version</title>
<path fill="none" stroke="black" d="M326.68,-512.81C315.78,-503.14 302.07,-490.98 290.45,-480.66"/>
<polygon fill="black" stroke="black" points="292.59,-477.89 282.79,-473.87 287.95,-483.12 292.59,-477.89"/>
</g>
<!-- end -->
<g id="node10" class="node">
<title>end</title>
<ellipse fill="none" stroke="black" cx="240.04" cy="-18" rx="32.93" ry="18"/>
<text text-anchor="middle" x="240.04" y="-15.5" font-family="Courier,monospace" font-size="10.00">函数返回</text>
</g>
<!-- open_old_file&#45;&gt;end -->
<g id="edge12" class="edge">
<title>open_old_file&#45;&gt;end</title>
<path fill="none" stroke="black" d="M385.1,-512.88C405.41,-501.07 426.04,-483.14 426.04,-459 426.04,-459 426.04,-459 426.04,-100 426.04,-38.12 338.45,-23.03 283.48,-19.64"/>
<polygon fill="black" stroke="black" points="283.46,-16.14 273.29,-19.13 283.1,-23.13 283.46,-16.14"/>
<text text-anchor="middle" x="480.04" y="-289.5" font-family="Courier,monospace" font-size="10.00">打开失败时直接返回错误</text>
</g>
<!-- try_rename_ex -->
<g id="node4" class="node">
<title>try_rename_ex</title>
<polygon fill="none" stroke="black" points="259.04,-393 39.04,-393 39.04,-357 259.04,-357 259.04,-393"/>
<text text-anchor="middle" x="149.04" y="-378" font-family="Courier,monospace" font-size="10.00">构造 FILE_RENAME_INFORMATION_EX</text>
<text text-anchor="middle" x="149.04" y="-367" font-family="Courier,monospace" font-size="10.00">设置标志位并调用 NtSetInformationFile</text>
</g>
<!-- check_win_version&#45;&gt;try_rename_ex -->
<g id="edge3" class="edge">
<title>check_win_version&#45;&gt;try_rename_ex</title>
<path fill="none" stroke="black" d="M245.39,-442.71C227.94,-430.62 202.62,-413.09 182.31,-399.03"/>
<polygon fill="black" stroke="black" points="184.17,-396.06 173.95,-393.25 180.18,-401.82 184.17,-396.06"/>
<text text-anchor="middle" x="219.04" y="-414" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- fallback -->
<g id="node8" class="node">
<title>fallback</title>
<polygon fill="none" stroke="black" points="398.04,-227 178.04,-227 178.04,-191 398.04,-191 398.04,-227"/>
<text text-anchor="middle" x="288.04" y="-212" font-family="Courier,monospace" font-size="10.00">回退到 FILE_RENAME_INFORMATION</text>
<text text-anchor="middle" x="288.04" y="-201" font-family="Courier,monospace" font-size="10.00">构造结构体并调用 NtSetInformationFile</text>
</g>
<!-- check_win_version&#45;&gt;fallback -->
<g id="edge4" class="edge">
<title>check_win_version&#45;&gt;fallback</title>
<path fill="none" stroke="black" d="M267.55,-440.02C271.31,-397.9 281.07,-288.29 285.63,-237.09"/>
<polygon fill="black" stroke="black" points="289.12,-237.37 286.52,-227.1 282.15,-236.75 289.12,-237.37"/>
<text text-anchor="middle" x="282.04" y="-331" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- invalid_param -->
<g id="node6" class="node">
<title>invalid_param</title>
<polygon fill="none" stroke="black" points="124.04,-310 -0.04,-292 124.04,-274 248.13,-292 124.04,-310"/>
<text text-anchor="middle" x="124.04" y="-289.5" font-family="Courier,monospace" font-size="10.00">返回 INVALID_PARAMETER?</text>
</g>
<!-- try_rename_ex&#45;&gt;invalid_param -->
<g id="edge5" class="edge">
<title>try_rename_ex&#45;&gt;invalid_param</title>
<path fill="none" stroke="black" d="M143.74,-356.82C140.36,-345.87 135.91,-331.45 132.1,-319.1"/>
<polygon fill="black" stroke="black" points="135.37,-317.85 129.08,-309.32 128.69,-319.91 135.37,-317.85"/>
</g>
<!-- rename_ex_success -->
<g id="node5" class="node">
<title>rename_ex_success</title>
<ellipse fill="none" stroke="black" cx="47.04" cy="-155" rx="38.03" ry="18"/>
<text text-anchor="middle" x="47.04" y="-152.5" font-family="Courier,monospace" font-size="10.00">重命名成功</text>
</g>
<!-- rename_ex_success&#45;&gt;end -->
<g id="edge13" class="edge">
<title>rename_ex_success&#45;&gt;end</title>
<path fill="none" stroke="black" d="M67.7,-139.55C102.5,-115.21 172.87,-65.98 212.07,-38.57"/>
<polygon fill="black" stroke="black" points="214.21,-41.34 220.4,-32.74 210.2,-35.6 214.21,-41.34"/>
</g>
<!-- invalid_param&#45;&gt;rename_ex_success -->
<g id="edge6" class="edge">
<title>invalid_param&#45;&gt;rename_ex_success</title>
<path fill="none" stroke="black" d="M89.97,-278.75C79.24,-273.32 68.3,-265.88 61.04,-256 45.68,-235.1 43.4,-204.94 44.21,-183.22"/>
<polygon fill="black" stroke="black" points="47.72,-183.21 44.84,-173.01 40.73,-182.78 47.72,-183.21"/>
<text text-anchor="middle" x="82.54" y="-248" font-family="Courier,monospace" font-size="10.00">SUCCESS</text>
</g>
<!-- handle_other_errors -->
<g id="node7" class="node">
<title>handle_other_errors</title>
<polygon fill="none" stroke="black" points="159.54,-227 64.54,-227 64.54,-191 159.54,-191 159.54,-227"/>
<text text-anchor="middle" x="112.04" y="-206.5" font-family="Courier,monospace" font-size="10.00">处理其他错误状态</text>
</g>
<!-- invalid_param&#45;&gt;handle_other_errors -->
<g id="edge7" class="edge">
<title>invalid_param&#45;&gt;handle_other_errors</title>
<path fill="none" stroke="black" d="M116.16,-275.01C113.69,-269.17 111.28,-262.43 110.04,-256 108.88,-249.97 108.6,-243.41 108.77,-237.18"/>
<polygon fill="black" stroke="black" points="112.26,-237.38 109.41,-227.18 105.28,-236.93 112.26,-237.38"/>
<text text-anchor="middle" x="130.04" y="-248" font-family="Courier,monospace" font-size="10.00">其他错误</text>
</g>
<!-- invalid_param&#45;&gt;fallback -->
<g id="edge8" class="edge">
<title>invalid_param&#45;&gt;fallback</title>
<path fill="none" stroke="black" d="M136.79,-275.83C145.96,-265.8 159.11,-253.07 173.04,-245 182.75,-239.38 193.45,-234.58 204.3,-230.5"/>
<polygon fill="black" stroke="black" points="205.61,-233.75 213.86,-227.09 203.26,-227.15 205.61,-233.75"/>
<text text-anchor="middle" x="224.54" y="-248" font-family="Courier,monospace" font-size="10.00">INVALID_PARAMETER</text>
</g>
<!-- process_final_status -->
<g id="node9" class="node">
<title>process_final_status</title>
<polygon fill="none" stroke="black" points="302.04,-119 178.04,-119 178.04,-83 302.04,-83 302.04,-119"/>
<text text-anchor="middle" x="240.04" y="-98.5" font-family="Courier,monospace" font-size="10.00">根据返回状态码处理错误</text>
</g>
<!-- handle_other_errors&#45;&gt;process_final_status -->
<g id="edge9" class="edge">
<title>handle_other_errors&#45;&gt;process_final_status</title>
<path fill="none" stroke="black" d="M132.61,-190.97C153.94,-173.3 187.46,-145.54 211.39,-125.73"/>
<polygon fill="black" stroke="black" points="213.63,-128.41 219.1,-119.34 209.17,-123.02 213.63,-128.41"/>
</g>
<!-- fallback&#45;&gt;process_final_status -->
<g id="edge10" class="edge">
<title>fallback&#45;&gt;process_final_status</title>
<path fill="none" stroke="black" d="M280.33,-190.97C272.71,-174.15 260.95,-148.17 252.1,-128.62"/>
<polygon fill="black" stroke="black" points="255.21,-127.01 247.89,-119.34 248.83,-129.89 255.21,-127.01"/>
</g>
<!-- process_final_status&#45;&gt;end -->
<g id="edge11" class="edge">
<title>process_final_status&#45;&gt;end</title>
<path fill="none" stroke="black" d="M240.04,-82.82C240.04,-72.19 240.04,-58.31 240.04,-46.2"/>
<polygon fill="black" stroke="black" points="243.54,-46.15 240.04,-36.15 236.54,-46.15 243.54,-46.15"/>
<text text-anchor="middle" x="308.54" y="-57" font-family="Courier,monospace" font-size="10.00">根据状态码返回对应错误或成功</text>
</g>
</g>
</svg>
