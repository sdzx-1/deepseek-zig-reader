<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Salsa20Flow Pages: 1 -->
<svg width="1203pt" height="495pt"
 viewBox="0.00 0.00 1202.60 495.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 491)">
<title>Salsa20Flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-491 1198.6,-491 1198.6,4 -4,4"/>
<g id="clust2" class="cluster">
<title>cluster_core</title>
<polygon fill="none" stroke="black" points="405.6,-8 405.6,-156 625.6,-156 625.6,-8 405.6,-8"/>
<text text-anchor="middle" x="515.6" y="-140.8" font-family="Times,serif" font-size="14.00">salsaCore内部逻辑</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_xor</title>
<polygon fill="none" stroke="black" points="33.6,-262 33.6,-337 395.6,-337 395.6,-262 33.6,-262"/>
<text text-anchor="middle" x="214.6" y="-321.8" font-family="Times,serif" font-size="14.00">salsaXor处理流程</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_hsalsa</title>
<polygon fill="none" stroke="black" points="866.6,-262 866.6,-337 1066.6,-337 1066.6,-262 866.6,-262"/>
<text text-anchor="middle" x="966.6" y="-321.8" font-family="Times,serif" font-size="14.00">hsalsa处理流程</text>
</g>
<!-- SalsaNonVecImpl -->
<g id="node1" class="node">
<title>SalsaNonVecImpl</title>
<path fill="none" stroke="black" d="M699.1,-487C699.1,-487 522.1,-487 522.1,-487 516.1,-487 510.1,-481 510.1,-475 510.1,-475 510.1,-463 510.1,-463 510.1,-457 516.1,-451 522.1,-451 522.1,-451 699.1,-451 699.1,-451 705.1,-451 711.1,-457 711.1,-463 711.1,-463 711.1,-475 711.1,-475 711.1,-481 705.1,-487 699.1,-487"/>
<text text-anchor="middle" x="610.6" y="-465.3" font-family="Times,serif" font-size="14.00">SalsaNonVecImpl(rounds)</text>
</g>
<!-- initContext -->
<g id="node2" class="node">
<title>initContext</title>
<path fill="none" stroke="black" d="M843.6,-306C843.6,-306 719.6,-306 719.6,-306 713.6,-306 707.6,-300 707.6,-294 707.6,-294 707.6,-282 707.6,-282 707.6,-276 713.6,-270 719.6,-270 719.6,-270 843.6,-270 843.6,-270 849.6,-270 855.6,-276 855.6,-282 855.6,-282 855.6,-294 855.6,-294 855.6,-300 849.6,-306 843.6,-306"/>
<text text-anchor="middle" x="781.6" y="-284.3" font-family="Times,serif" font-size="14.00">initContext(key, d)</text>
</g>
<!-- SalsaNonVecImpl&#45;&gt;initContext -->
<g id="edge1" class="edge">
<title>SalsaNonVecImpl&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M626.99,-450.84C657.51,-418.89 723.1,-350.24 758.24,-313.45"/>
<polygon fill="black" stroke="black" points="760.87,-315.76 765.25,-306.11 755.81,-310.92 760.87,-315.76"/>
</g>
<!-- salsaCore -->
<g id="node3" class="node">
<title>salsaCore</title>
<path fill="none" stroke="black" d="M702.6,-233C702.6,-233 502.6,-233 502.6,-233 496.6,-233 490.6,-227 490.6,-221 490.6,-221 490.6,-209 490.6,-209 490.6,-203 496.6,-197 502.6,-197 502.6,-197 702.6,-197 702.6,-197 708.6,-197 714.6,-203 714.6,-209 714.6,-209 714.6,-221 714.6,-221 714.6,-227 708.6,-233 702.6,-233"/>
<text text-anchor="middle" x="602.6" y="-211.3" font-family="Times,serif" font-size="14.00">salsaCore(x, input, feedback)</text>
</g>
<!-- SalsaNonVecImpl&#45;&gt;salsaCore -->
<g id="edge2" class="edge">
<title>SalsaNonVecImpl&#45;&gt;salsaCore</title>
<path fill="none" stroke="black" d="M509.84,-464.92C308.28,-455.45 -113.49,-417.03 29.6,-262 59.48,-229.62 320.88,-220.02 480.11,-217.19"/>
<polygon fill="black" stroke="black" points="480.51,-220.68 490.45,-217.01 480.39,-213.68 480.51,-220.68"/>
</g>
<!-- hashToBytes -->
<g id="node4" class="node">
<title>hashToBytes</title>
<path fill="none" stroke="black" d="M677.6,-306C677.6,-306 543.6,-306 543.6,-306 537.6,-306 531.6,-300 531.6,-294 531.6,-294 531.6,-282 531.6,-282 531.6,-276 537.6,-270 543.6,-270 543.6,-270 677.6,-270 677.6,-270 683.6,-270 689.6,-276 689.6,-282 689.6,-282 689.6,-294 689.6,-294 689.6,-300 683.6,-306 677.6,-306"/>
<text text-anchor="middle" x="610.6" y="-284.3" font-family="Times,serif" font-size="14.00">hashToBytes(out, x)</text>
</g>
<!-- SalsaNonVecImpl&#45;&gt;hashToBytes -->
<g id="edge3" class="edge">
<title>SalsaNonVecImpl&#45;&gt;hashToBytes</title>
<path fill="none" stroke="black" d="M610.6,-450.84C610.6,-419.7 610.6,-353.66 610.6,-316.28"/>
<polygon fill="black" stroke="black" points="614.1,-316.11 610.6,-306.11 607.1,-316.11 614.1,-316.11"/>
</g>
<!-- salsaXor -->
<g id="node5" class="node">
<title>salsaXor</title>
<path fill="none" stroke="black" d="M516.1,-414C516.1,-414 357.1,-414 357.1,-414 351.1,-414 345.1,-408 345.1,-402 345.1,-402 345.1,-390 345.1,-390 345.1,-384 351.1,-378 357.1,-378 357.1,-378 516.1,-378 516.1,-378 522.1,-378 528.1,-384 528.1,-390 528.1,-390 528.1,-402 528.1,-402 528.1,-408 522.1,-414 516.1,-414"/>
<text text-anchor="middle" x="436.6" y="-392.3" font-family="Times,serif" font-size="14.00">salsaXor(out, in, key, d)</text>
</g>
<!-- SalsaNonVecImpl&#45;&gt;salsaXor -->
<g id="edge4" class="edge">
<title>SalsaNonVecImpl&#45;&gt;salsaXor</title>
<path fill="none" stroke="black" d="M568.92,-450.99C544.56,-441.06 513.63,-428.43 487.8,-417.89"/>
<polygon fill="black" stroke="black" points="489.12,-414.65 478.54,-414.11 486.47,-421.13 489.12,-414.65"/>
</g>
<!-- hsalsa -->
<g id="node6" class="node">
<title>hsalsa</title>
<path fill="none" stroke="black" d="M932.1,-414C932.1,-414 813.1,-414 813.1,-414 807.1,-414 801.1,-408 801.1,-402 801.1,-402 801.1,-390 801.1,-390 801.1,-384 807.1,-378 813.1,-378 813.1,-378 932.1,-378 932.1,-378 938.1,-378 944.1,-384 944.1,-390 944.1,-390 944.1,-402 944.1,-402 944.1,-408 938.1,-414 932.1,-414"/>
<text text-anchor="middle" x="872.6" y="-392.3" font-family="Times,serif" font-size="14.00">hsalsa(input, key)</text>
</g>
<!-- SalsaNonVecImpl&#45;&gt;hsalsa -->
<g id="edge5" class="edge">
<title>SalsaNonVecImpl&#45;&gt;hsalsa</title>
<path fill="none" stroke="black" d="M673.35,-450.99C711.31,-440.71 759.88,-427.55 799.56,-416.79"/>
<polygon fill="black" stroke="black" points="800.71,-420.11 809.44,-414.11 798.88,-413.35 800.71,-420.11"/>
</g>
<!-- initContext&#45;&gt;salsaCore -->
<g id="edge17" class="edge">
<title>initContext&#45;&gt;salsaCore</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M738.72,-269.99C713.66,-260.06 681.85,-247.43 655.27,-236.89"/>
<polygon fill="black" stroke="black" points="656.33,-233.55 645.74,-233.11 653.75,-240.05 656.33,-233.55"/>
</g>
<!-- QuarterRound -->
<g id="node7" class="node">
<title>QuarterRound</title>
<path fill="none" stroke="black" d="M605.6,-125C605.6,-125 425.6,-125 425.6,-125 419.6,-125 413.6,-119 413.6,-113 413.6,-113 413.6,-101 413.6,-101 413.6,-95 419.6,-89 425.6,-89 425.6,-89 605.6,-89 605.6,-89 611.6,-89 617.6,-95 617.6,-101 617.6,-101 617.6,-113 617.6,-113 617.6,-119 611.6,-125 605.6,-125"/>
<text text-anchor="middle" x="515.6" y="-103.3" font-family="Times,serif" font-size="14.00">循环应用QuarterRound操作</text>
</g>
<!-- salsaCore&#45;&gt;QuarterRound -->
<g id="edge8" class="edge">
<title>salsaCore&#45;&gt;QuarterRound</title>
<path fill="none" stroke="black" d="M572.25,-196.84C564.89,-191.74 557.47,-185.71 551.6,-179 540.2,-165.99 531.35,-148.74 525.27,-134.5"/>
<polygon fill="black" stroke="black" points="528.5,-133.16 521.51,-125.21 522.02,-135.79 528.5,-133.16"/>
<text text-anchor="middle" x="595.6" y="-167.8" font-family="Times,serif" font-size="14.00">应用ARX步骤</text>
</g>
<!-- FeedbackAdd -->
<g id="node8" class="node">
<title>FeedbackAdd</title>
<path fill="none" stroke="black" d="M583.6,-52C583.6,-52 491.6,-52 491.6,-52 485.6,-52 479.6,-46 479.6,-40 479.6,-40 479.6,-28 479.6,-28 479.6,-22 485.6,-16 491.6,-16 491.6,-16 583.6,-16 583.6,-16 589.6,-16 595.6,-22 595.6,-28 595.6,-28 595.6,-40 595.6,-40 595.6,-46 589.6,-52 583.6,-52"/>
<text text-anchor="middle" x="537.6" y="-30.3" font-family="Times,serif" font-size="14.00">叠加输入到结果</text>
</g>
<!-- salsaCore&#45;&gt;FeedbackAdd -->
<g id="edge9" class="edge">
<title>salsaCore&#45;&gt;FeedbackAdd</title>
<path fill="none" stroke="black" d="M626.66,-196.7C631.9,-191.64 636.73,-185.66 639.6,-179 649.67,-155.6 659.24,-136.87 626.6,-89 617.57,-75.77 604.14,-65.23 590.42,-57.1"/>
<polygon fill="black" stroke="black" points="591.86,-53.9 581.41,-52.11 588.46,-60.02 591.86,-53.9"/>
<text text-anchor="middle" x="737.6" y="-103.3" font-family="Times,serif" font-size="14.00">feedback=true时叠加输入</text>
</g>
<!-- salsaXor&#45;&gt;initContext -->
<g id="edge6" class="edge">
<title>salsaXor&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M482.64,-377.94C514.92,-366.71 559.33,-352.71 599.6,-345 642.95,-336.7 656.46,-350.15 698.6,-337 716.62,-331.37 734.97,-321.31 749.82,-311.84"/>
<polygon fill="black" stroke="black" points="752.15,-314.49 758.58,-306.07 748.3,-308.65 752.15,-314.49"/>
<text text-anchor="middle" x="625.1" y="-348.8" font-family="Times,serif" font-size="14.00">创建ctx</text>
</g>
<!-- salsaXor&#45;&gt;salsaCore -->
<g id="edge7" class="edge">
<title>salsaXor&#45;&gt;salsaCore</title>
<path fill="none" stroke="black" d="M433.44,-377.52C428.11,-345.62 419.12,-279.61 432.6,-262 440.83,-251.24 463.73,-242.42 490.16,-235.48"/>
<polygon fill="black" stroke="black" points="491.19,-238.83 500.04,-233.01 489.49,-232.04 491.19,-238.83"/>
<text text-anchor="middle" x="477.6" y="-284.3" font-family="Times,serif" font-size="14.00">处理64字节块</text>
</g>
<!-- salsaXor&#45;&gt;hashToBytes -->
<g id="edge10" class="edge">
<title>salsaXor&#45;&gt;hashToBytes</title>
<path fill="none" stroke="black" d="M443.84,-377.92C449.48,-366.75 458.41,-352.83 470.6,-345 488.42,-333.55 497.5,-343.72 517.6,-337 537.08,-330.49 557.49,-320.37 574.21,-311.09"/>
<polygon fill="black" stroke="black" points="576.12,-314.03 583.1,-306.06 572.67,-307.94 576.12,-314.03"/>
<text text-anchor="middle" x="496.6" y="-348.8" font-family="Times,serif" font-size="14.00">生成buf</text>
</g>
<!-- XorBlocks -->
<g id="node9" class="node">
<title>XorBlocks</title>
<path fill="none" stroke="black" d="M375.6,-306C375.6,-306 293.6,-306 293.6,-306 287.6,-306 281.6,-300 281.6,-294 281.6,-294 281.6,-282 281.6,-282 281.6,-276 287.6,-270 293.6,-270 293.6,-270 375.6,-270 375.6,-270 381.6,-270 387.6,-276 387.6,-282 387.6,-282 387.6,-294 387.6,-294 387.6,-300 381.6,-306 375.6,-306"/>
<text text-anchor="middle" x="334.6" y="-284.3" font-family="Times,serif" font-size="14.00">异或64字节块</text>
</g>
<!-- salsaXor&#45;&gt;XorBlocks -->
<g id="edge11" class="edge">
<title>salsaXor&#45;&gt;XorBlocks</title>
<path fill="none" stroke="black" d="M345.08,-379.21C336.36,-374.35 328.56,-368.08 322.6,-360 313.24,-347.34 315.99,-329.95 321.2,-315.55"/>
<polygon fill="black" stroke="black" points="324.5,-316.74 325.09,-306.16 318.03,-314.06 324.5,-316.74"/>
<text text-anchor="middle" x="372.6" y="-348.8" font-family="Times,serif" font-size="14.00">异或处理完整块</text>
</g>
<!-- UpdateCounter -->
<g id="node10" class="node">
<title>UpdateCounter</title>
<path fill="none" stroke="black" d="M131.6,-306C131.6,-306 53.6,-306 53.6,-306 47.6,-306 41.6,-300 41.6,-294 41.6,-294 41.6,-282 41.6,-282 41.6,-276 47.6,-270 53.6,-270 53.6,-270 131.6,-270 131.6,-270 137.6,-270 143.6,-276 143.6,-282 143.6,-282 143.6,-294 143.6,-294 143.6,-300 137.6,-306 131.6,-306"/>
<text text-anchor="middle" x="92.6" y="-284.3" font-family="Times,serif" font-size="14.00">更新块计数器</text>
</g>
<!-- salsaXor&#45;&gt;UpdateCounter -->
<g id="edge12" class="edge">
<title>salsaXor&#45;&gt;UpdateCounter</title>
<path fill="none" stroke="black" d="M344.86,-392.09C247,-388.01 103.68,-378.88 86.6,-360 76.01,-348.3 77.46,-330.63 81.58,-315.85"/>
<polygon fill="black" stroke="black" points="84.96,-316.77 84.75,-306.18 78.31,-314.59 84.96,-316.77"/>
<text text-anchor="middle" x="149.6" y="-348.8" font-family="Times,serif" font-size="14.00">更新ctx[8]和ctx[9]</text>
</g>
<!-- ProcessRemaining -->
<g id="node11" class="node">
<title>ProcessRemaining</title>
<path fill="none" stroke="black" d="M251.6,-306C251.6,-306 173.6,-306 173.6,-306 167.6,-306 161.6,-300 161.6,-294 161.6,-294 161.6,-282 161.6,-282 161.6,-276 167.6,-270 173.6,-270 173.6,-270 251.6,-270 251.6,-270 257.6,-270 263.6,-276 263.6,-282 263.6,-282 263.6,-294 263.6,-294 263.6,-300 257.6,-306 251.6,-306"/>
<text text-anchor="middle" x="212.6" y="-284.3" font-family="Times,serif" font-size="14.00">处理尾部字节</text>
</g>
<!-- salsaXor&#45;&gt;ProcessRemaining -->
<g id="edge13" class="edge">
<title>salsaXor&#45;&gt;ProcessRemaining</title>
<path fill="none" stroke="black" d="M344.89,-389.91C296.48,-385.3 243.63,-376.54 226.6,-360 215.13,-348.87 211.6,-331.29 210.95,-316.4"/>
<polygon fill="black" stroke="black" points="214.45,-316.16 210.92,-306.17 207.45,-316.18 214.45,-316.16"/>
<text text-anchor="middle" x="269.6" y="-348.8" font-family="Times,serif" font-size="14.00">处理剩余字节</text>
</g>
<!-- hsalsa&#45;&gt;initContext -->
<g id="edge14" class="edge">
<title>hsalsa&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M854.73,-377.94C849.11,-372.36 842.96,-366.04 837.6,-360 824.55,-345.33 810.89,-328.05 800.33,-314.21"/>
<polygon fill="black" stroke="black" points="803.01,-311.95 794.18,-306.09 797.43,-316.18 803.01,-311.95"/>
<text text-anchor="middle" x="863.1" y="-348.8" font-family="Times,serif" font-size="14.00">创建ctx</text>
</g>
<!-- hsalsa&#45;&gt;salsaCore -->
<g id="edge15" class="edge">
<title>hsalsa&#45;&gt;salsaCore</title>
<path fill="none" stroke="black" d="M944.24,-384.78C995.74,-375.59 1058.2,-359.97 1070.6,-337 1086.42,-307.66 1092.98,-286.7 1070.6,-262 1047.72,-236.76 855.74,-224.88 724.89,-219.67"/>
<polygon fill="black" stroke="black" points="724.92,-216.16 714.79,-219.27 724.65,-223.16 724.92,-216.16"/>
<text text-anchor="middle" x="1139.6" y="-284.3" font-family="Times,serif" font-size="14.00">feedback=false</text>
</g>
<!-- ExtractWords -->
<g id="node12" class="node">
<title>ExtractWords</title>
<path fill="none" stroke="black" d="M1047.1,-306C1047.1,-306 886.1,-306 886.1,-306 880.1,-306 874.1,-300 874.1,-294 874.1,-294 874.1,-282 874.1,-282 874.1,-276 880.1,-270 886.1,-270 886.1,-270 1047.1,-270 1047.1,-270 1053.1,-270 1059.1,-276 1059.1,-282 1059.1,-282 1059.1,-294 1059.1,-294 1059.1,-300 1053.1,-306 1047.1,-306"/>
<text text-anchor="middle" x="966.6" y="-284.3" font-family="Times,serif" font-size="14.00">提取x[0,5,10,15,6,7,8,9]</text>
</g>
<!-- hsalsa&#45;&gt;ExtractWords -->
<g id="edge16" class="edge">
<title>hsalsa&#45;&gt;ExtractWords</title>
<path fill="none" stroke="black" d="M887.7,-377.97C903.02,-360.69 926.92,-333.74 944.4,-314.03"/>
<polygon fill="black" stroke="black" points="947.2,-316.14 951.22,-306.34 941.96,-311.5 947.2,-316.14"/>
<text text-anchor="middle" x="974.1" y="-348.8" font-family="Times,serif" font-size="14.00">提取特定字到输出</text>
</g>
<!-- QuarterRound&#45;&gt;FeedbackAdd -->
<g id="edge18" class="edge">
<title>QuarterRound&#45;&gt;FeedbackAdd</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M520.92,-88.81C523.43,-80.7 526.49,-70.84 529.3,-61.78"/>
<polygon fill="black" stroke="black" points="532.7,-62.62 532.32,-52.03 526.02,-60.54 532.7,-62.62"/>
</g>
</g>
</svg>
