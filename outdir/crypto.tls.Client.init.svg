<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: TLSClientInitFlow Pages: 1 -->
<svg width="1388pt" height="1140pt"
 viewBox="0.00 0.00 1388.00 1140.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1136)">
<title>TLSClientInitFlow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1136 1384,-1136 1384,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_tls_handshake</title>
<polygon fill="none" stroke="black" points="93,-260 93,-335 1306,-335 1306,-260 93,-260"/>
<text text-anchor="middle" x="699.5" y="-319.8" font-family="Times,serif" font-size="14.00">TLS握手处理</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_initialization</title>
<polygon fill="none" stroke="black" points="101,-542 101,-1069 275,-1069 275,-542 101,-542"/>
<text text-anchor="middle" x="188" y="-1053.8" font-family="Times,serif" font-size="14.00">初始化阶段</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_error_handling</title>
<polygon fill="none" stroke="black" points="216,-79 216,-154 306,-154 306,-79 216,-79"/>
<text text-anchor="middle" x="261" y="-138.8" font-family="Times,serif" font-size="14.00">错误处理</text>
</g>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M220,-1132C220,-1132 156,-1132 156,-1132 150,-1132 144,-1126 144,-1120 144,-1120 144,-1108 144,-1108 144,-1102 150,-1096 156,-1096 156,-1096 220,-1096 220,-1096 226,-1096 232,-1102 232,-1108 232,-1108 232,-1120 232,-1120 232,-1126 226,-1132 220,-1132"/>
<text text-anchor="middle" x="188" y="-1110.3" font-family="Times,serif" font-size="14.00">开始初始化</text>
</g>
<!-- parse_host -->
<g id="node2" class="node">
<title>parse_host</title>
<path fill="none" stroke="black" d="M242.5,-1038C242.5,-1038 133.5,-1038 133.5,-1038 127.5,-1038 121.5,-1032 121.5,-1026 121.5,-1026 121.5,-1014 121.5,-1014 121.5,-1008 127.5,-1002 133.5,-1002 133.5,-1002 242.5,-1002 242.5,-1002 248.5,-1002 254.5,-1008 254.5,-1014 254.5,-1014 254.5,-1026 254.5,-1026 254.5,-1032 248.5,-1038 242.5,-1038"/>
<text text-anchor="middle" x="188" y="-1016.3" font-family="Times,serif" font-size="14.00">解析options.host</text>
</g>
<!-- start&#45;&gt;parse_host -->
<g id="edge1" class="edge">
<title>start&#45;&gt;parse_host</title>
<path fill="none" stroke="black" d="M188,-1095.7C188,-1082.46 188,-1063.95 188,-1048.66"/>
<polygon fill="black" stroke="black" points="191.5,-1048.23 188,-1038.23 184.5,-1048.23 191.5,-1048.23"/>
</g>
<!-- generate_random -->
<g id="node3" class="node">
<title>generate_random</title>
<path fill="none" stroke="black" d="M234,-965C234,-965 142,-965 142,-965 136,-965 130,-959 130,-953 130,-953 130,-941 130,-941 130,-935 136,-929 142,-929 142,-929 234,-929 234,-929 240,-929 246,-935 246,-941 246,-941 246,-953 246,-953 246,-959 240,-965 234,-965"/>
<text text-anchor="middle" x="188" y="-943.3" font-family="Times,serif" font-size="14.00">生成随机缓冲区</text>
</g>
<!-- parse_host&#45;&gt;generate_random -->
<g id="edge2" class="edge">
<title>parse_host&#45;&gt;generate_random</title>
<path fill="none" stroke="black" d="M188,-1001.81C188,-993.79 188,-984.05 188,-975.07"/>
<polygon fill="black" stroke="black" points="191.5,-975.03 188,-965.03 184.5,-975.03 191.5,-975.03"/>
</g>
<!-- init_key_share -->
<g id="node4" class="node">
<title>init_key_share</title>
<path fill="none" stroke="black" d="M248.5,-892C248.5,-892 127.5,-892 127.5,-892 121.5,-892 115.5,-886 115.5,-880 115.5,-880 115.5,-868 115.5,-868 115.5,-862 121.5,-856 127.5,-856 127.5,-856 248.5,-856 248.5,-856 254.5,-856 260.5,-862 260.5,-868 260.5,-868 260.5,-880 260.5,-880 260.5,-886 254.5,-892 248.5,-892"/>
<text text-anchor="middle" x="188" y="-870.3" font-family="Times,serif" font-size="14.00">初始化密钥共享参数</text>
</g>
<!-- generate_random&#45;&gt;init_key_share -->
<g id="edge3" class="edge">
<title>generate_random&#45;&gt;init_key_share</title>
<path fill="none" stroke="black" d="M188,-928.81C188,-920.79 188,-911.05 188,-902.07"/>
<polygon fill="black" stroke="black" points="191.5,-902.03 188,-892.03 184.5,-902.03 191.5,-902.03"/>
</g>
<!-- build_extensions -->
<g id="node5" class="node">
<title>build_extensions</title>
<path fill="none" stroke="black" d="M227,-819C227,-819 149,-819 149,-819 143,-819 137,-813 137,-807 137,-807 137,-795 137,-795 137,-789 143,-783 149,-783 149,-783 227,-783 227,-783 233,-783 239,-789 239,-795 239,-795 239,-807 239,-807 239,-813 233,-819 227,-819"/>
<text text-anchor="middle" x="188" y="-797.3" font-family="Times,serif" font-size="14.00">构建扩展载荷</text>
</g>
<!-- init_key_share&#45;&gt;build_extensions -->
<g id="edge4" class="edge">
<title>init_key_share&#45;&gt;build_extensions</title>
<path fill="none" stroke="black" d="M188,-855.81C188,-847.79 188,-838.05 188,-829.07"/>
<polygon fill="black" stroke="black" points="191.5,-829.03 188,-819.03 184.5,-829.03 191.5,-829.03"/>
</g>
<!-- handle_server_name -->
<g id="node6" class="node">
<title>handle_server_name</title>
<path fill="none" stroke="black" d="M248.5,-746C248.5,-746 127.5,-746 127.5,-746 121.5,-746 115.5,-740 115.5,-734 115.5,-734 115.5,-722 115.5,-722 115.5,-716 121.5,-710 127.5,-710 127.5,-710 248.5,-710 248.5,-710 254.5,-710 260.5,-716 260.5,-722 260.5,-722 260.5,-734 260.5,-734 260.5,-740 254.5,-746 248.5,-746"/>
<text text-anchor="middle" x="188" y="-724.3" font-family="Times,serif" font-size="14.00">处理服务器名称扩展</text>
</g>
<!-- build_extensions&#45;&gt;handle_server_name -->
<g id="edge5" class="edge">
<title>build_extensions&#45;&gt;handle_server_name</title>
<path fill="none" stroke="black" d="M188,-782.81C188,-774.79 188,-765.05 188,-756.07"/>
<polygon fill="black" stroke="black" points="191.5,-756.03 188,-746.03 184.5,-756.03 191.5,-756.03"/>
</g>
<!-- construct_client_hello -->
<g id="node7" class="node">
<title>construct_client_hello</title>
<path fill="none" stroke="black" d="M255,-673C255,-673 121,-673 121,-673 115,-673 109,-667 109,-661 109,-661 109,-649 109,-649 109,-643 115,-637 121,-637 121,-637 255,-637 255,-637 261,-637 267,-643 267,-649 267,-649 267,-661 267,-661 267,-667 261,-673 255,-673"/>
<text text-anchor="middle" x="188" y="-651.3" font-family="Times,serif" font-size="14.00">构造Client Hello消息</text>
</g>
<!-- handle_server_name&#45;&gt;construct_client_hello -->
<g id="edge6" class="edge">
<title>handle_server_name&#45;&gt;construct_client_hello</title>
<path fill="none" stroke="black" d="M188,-709.81C188,-701.79 188,-692.05 188,-683.07"/>
<polygon fill="black" stroke="black" points="191.5,-683.03 188,-673.03 184.5,-683.03 191.5,-683.03"/>
</g>
<!-- write_cleartext -->
<g id="node8" class="node">
<title>write_cleartext</title>
<path fill="none" stroke="black" d="M234,-586C234,-586 142,-586 142,-586 136,-586 130,-580 130,-574 130,-574 130,-562 130,-562 130,-556 136,-550 142,-550 142,-550 234,-550 234,-550 240,-550 246,-556 246,-562 246,-562 246,-574 246,-574 246,-580 240,-586 234,-586"/>
<text text-anchor="middle" x="188" y="-564.3" font-family="Times,serif" font-size="14.00">写入明文头到流</text>
</g>
<!-- construct_client_hello&#45;&gt;write_cleartext -->
<g id="edge7" class="edge">
<title>construct_client_hello&#45;&gt;write_cleartext</title>
<path fill="none" stroke="black" d="M188,-636.8C188,-625.16 188,-609.55 188,-596.24"/>
<polygon fill="black" stroke="black" points="191.5,-596.18 188,-586.18 184.5,-596.18 191.5,-596.18"/>
</g>
<!-- read_record -->
<g id="node9" class="node">
<title>read_record</title>
<path fill="none" stroke="black" d="M613.5,-499C613.5,-499 536.5,-499 536.5,-499 530.5,-499 524.5,-493 524.5,-487 524.5,-487 524.5,-475 524.5,-475 524.5,-469 530.5,-463 536.5,-463 536.5,-463 613.5,-463 613.5,-463 619.5,-463 625.5,-469 625.5,-475 625.5,-475 625.5,-487 625.5,-487 625.5,-493 619.5,-499 613.5,-499"/>
<text text-anchor="middle" x="575" y="-477.3" font-family="Times,serif" font-size="14.00">读取TLS记录</text>
</g>
<!-- write_cleartext&#45;&gt;read_record -->
<g id="edge8" class="edge">
<title>write_cleartext&#45;&gt;read_record</title>
<path fill="none" stroke="black" d="M246.36,-554.18C318.55,-538.33 440.89,-511.46 514.2,-495.35"/>
<polygon fill="black" stroke="black" points="515.19,-498.72 524.21,-493.16 513.69,-491.88 515.19,-498.72"/>
</g>
<!-- process_record -->
<g id="node10" class="node">
<title>process_record</title>
<path fill="none" stroke="black" d="M614,-412C614,-412 536,-412 536,-412 530,-412 524,-406 524,-400 524,-400 524,-388 524,-388 524,-382 530,-376 536,-376 536,-376 614,-376 614,-376 620,-376 626,-382 626,-388 626,-388 626,-400 626,-400 626,-406 620,-412 614,-412"/>
<text text-anchor="middle" x="575" y="-390.3" font-family="Times,serif" font-size="14.00">处理记录内容</text>
</g>
<!-- read_record&#45;&gt;process_record -->
<g id="edge9" class="edge">
<title>read_record&#45;&gt;process_record</title>
<path fill="none" stroke="black" d="M575,-462.8C575,-451.16 575,-435.55 575,-422.24"/>
<polygon fill="black" stroke="black" points="578.5,-422.18 575,-412.18 571.5,-422.18 578.5,-422.18"/>
<text text-anchor="middle" x="611" y="-433.8" font-family="Times,serif" font-size="14.00">读取记录头</text>
</g>
<!-- handle_server_hello -->
<g id="node11" class="node">
<title>handle_server_hello</title>
<path fill="none" stroke="black" d="M1285.5,-304C1285.5,-304 1174.5,-304 1174.5,-304 1168.5,-304 1162.5,-298 1162.5,-292 1162.5,-292 1162.5,-280 1162.5,-280 1162.5,-274 1168.5,-268 1174.5,-268 1174.5,-268 1285.5,-268 1285.5,-268 1291.5,-268 1297.5,-274 1297.5,-280 1297.5,-280 1297.5,-292 1297.5,-292 1297.5,-298 1291.5,-304 1285.5,-304"/>
<text text-anchor="middle" x="1230" y="-282.3" font-family="Times,serif" font-size="14.00">处理Server Hello</text>
</g>
<!-- process_record&#45;&gt;handle_server_hello -->
<g id="edge10" class="edge">
<title>process_record&#45;&gt;handle_server_hello</title>
<path fill="none" stroke="black" d="M626.25,-392.45C715.97,-390.8 907.05,-384.21 1066,-358 1105.89,-351.42 1116.92,-351.09 1154,-335 1169.5,-328.27 1185.49,-318.65 1198.77,-309.78"/>
<polygon fill="black" stroke="black" points="1200.8,-312.64 1207.08,-304.1 1196.85,-306.86 1200.8,-312.64"/>
<text text-anchor="middle" x="1177.5" y="-346.8" font-family="Times,serif" font-size="14.00">Server Hello</text>
</g>
<!-- handle_encrypted_ext -->
<g id="node12" class="node">
<title>handle_encrypted_ext</title>
<path fill="none" stroke="black" d="M947.5,-304C947.5,-304 768.5,-304 768.5,-304 762.5,-304 756.5,-298 756.5,-292 756.5,-292 756.5,-280 756.5,-280 756.5,-274 762.5,-268 768.5,-268 768.5,-268 947.5,-268 947.5,-268 953.5,-268 959.5,-274 959.5,-280 959.5,-280 959.5,-292 959.5,-292 959.5,-298 953.5,-304 947.5,-304"/>
<text text-anchor="middle" x="858" y="-282.3" font-family="Times,serif" font-size="14.00">处理Encrypted Extensions</text>
</g>
<!-- process_record&#45;&gt;handle_encrypted_ext -->
<g id="edge11" class="edge">
<title>process_record&#45;&gt;handle_encrypted_ext</title>
<path fill="none" stroke="black" d="M626.17,-381.85C650.93,-375.85 680.88,-367.68 707,-358 721.35,-352.68 724.18,-349.57 738,-343 762.35,-331.43 789.56,-318.71 811.91,-308.32"/>
<polygon fill="black" stroke="black" points="813.58,-311.41 821.17,-304.02 810.63,-305.06 813.58,-311.41"/>
<text text-anchor="middle" x="817" y="-346.8" font-family="Times,serif" font-size="14.00">Encrypted Extensions</text>
</g>
<!-- process_certificates -->
<g id="node13" class="node">
<title>process_certificates</title>
<path fill="none" stroke="black" d="M163,-304C163,-304 113,-304 113,-304 107,-304 101,-298 101,-292 101,-292 101,-280 101,-280 101,-274 107,-268 113,-268 113,-268 163,-268 163,-268 169,-268 175,-274 175,-280 175,-280 175,-292 175,-292 175,-298 169,-304 163,-304"/>
<text text-anchor="middle" x="138" y="-282.3" font-family="Times,serif" font-size="14.00">处理证书</text>
</g>
<!-- process_record&#45;&gt;process_certificates -->
<g id="edge12" class="edge">
<title>process_record&#45;&gt;process_certificates</title>
<path fill="none" stroke="black" d="M523.81,-392.29C457.22,-390.32 337.74,-383.2 239,-358 213.33,-351.45 205.85,-349.99 184,-335 174.62,-328.57 165.65,-319.98 158.16,-311.84"/>
<polygon fill="black" stroke="black" points="160.71,-309.44 151.47,-304.27 155.47,-314.08 160.71,-309.44"/>
<text text-anchor="middle" x="277" y="-346.8" font-family="Times,serif" font-size="14.00">Certificate</text>
</g>
<!-- handle_server_key_exchange -->
<g id="node15" class="node">
<title>handle_server_key_exchange</title>
<path fill="none" stroke="black" d="M379,-304C379,-304 205,-304 205,-304 199,-304 193,-298 193,-292 193,-292 193,-280 193,-280 193,-274 199,-268 205,-268 205,-268 379,-268 379,-268 385,-268 391,-274 391,-280 391,-280 391,-292 391,-292 391,-298 385,-304 379,-304"/>
<text text-anchor="middle" x="292" y="-282.3" font-family="Times,serif" font-size="14.00">处理Server Key Exchange</text>
</g>
<!-- process_record&#45;&gt;handle_server_key_exchange -->
<g id="edge13" class="edge">
<title>process_record&#45;&gt;handle_server_key_exchange</title>
<path fill="none" stroke="black" d="M523.94,-390.71C462.61,-387.08 364.2,-378.24 334,-358 318.39,-347.54 307.74,-329.14 301.08,-313.69"/>
<polygon fill="black" stroke="black" points="304.2,-312.08 297.26,-304.08 297.7,-314.67 304.2,-312.08"/>
<text text-anchor="middle" x="411" y="-346.8" font-family="Times,serif" font-size="14.00">Server Key Exchange</text>
</g>
<!-- handle_server_hello_done -->
<g id="node16" class="node">
<title>handle_server_hello_done</title>
<path fill="none" stroke="black" d="M573,-304C573,-304 421,-304 421,-304 415,-304 409,-298 409,-292 409,-292 409,-280 409,-280 409,-274 415,-268 421,-268 421,-268 573,-268 573,-268 579,-268 585,-274 585,-280 585,-280 585,-292 585,-292 585,-298 579,-304 573,-304"/>
<text text-anchor="middle" x="497" y="-282.3" font-family="Times,serif" font-size="14.00">处理Server Hello Done</text>
</g>
<!-- process_record&#45;&gt;handle_server_hello_done -->
<g id="edge14" class="edge">
<title>process_record&#45;&gt;handle_server_hello_done</title>
<path fill="none" stroke="black" d="M523.78,-379.47C513.62,-374.4 504.19,-367.46 498,-358 489.72,-345.34 489.15,-328.5 490.8,-314.4"/>
<polygon fill="black" stroke="black" points="494.3,-314.69 492.4,-304.27 487.38,-313.6 494.3,-314.69"/>
<text text-anchor="middle" x="564" y="-346.8" font-family="Times,serif" font-size="14.00">Server Hello Done</text>
</g>
<!-- handle_certificate_verify -->
<g id="node17" class="node">
<title>handle_certificate_verify</title>
<path fill="none" stroke="black" d="M1132.5,-304C1132.5,-304 989.5,-304 989.5,-304 983.5,-304 977.5,-298 977.5,-292 977.5,-292 977.5,-280 977.5,-280 977.5,-274 983.5,-268 989.5,-268 989.5,-268 1132.5,-268 1132.5,-268 1138.5,-268 1144.5,-274 1144.5,-280 1144.5,-280 1144.5,-292 1144.5,-292 1144.5,-298 1138.5,-304 1132.5,-304"/>
<text text-anchor="middle" x="1061" y="-282.3" font-family="Times,serif" font-size="14.00">处理Certificate Verify</text>
</g>
<!-- process_record&#45;&gt;handle_certificate_verify -->
<g id="edge15" class="edge">
<title>process_record&#45;&gt;handle_certificate_verify</title>
<path fill="none" stroke="black" d="M626.08,-390.53C689.82,-386.75 801.91,-377.75 896,-358 897.04,-357.78 968.02,-335.41 969,-335 986.95,-327.56 1006.1,-317.87 1022.25,-309.15"/>
<polygon fill="black" stroke="black" points="1024.3,-312.02 1031.39,-304.15 1020.94,-305.88 1024.3,-312.02"/>
<text text-anchor="middle" x="1004" y="-346.8" font-family="Times,serif" font-size="14.00">Certificate Verify</text>
</g>
<!-- handle_finished -->
<g id="node18" class="node">
<title>handle_finished</title>
<path fill="none" stroke="black" d="M726.5,-304C726.5,-304 615.5,-304 615.5,-304 609.5,-304 603.5,-298 603.5,-292 603.5,-292 603.5,-280 603.5,-280 603.5,-274 609.5,-268 615.5,-268 615.5,-268 726.5,-268 726.5,-268 732.5,-268 738.5,-274 738.5,-280 738.5,-280 738.5,-292 738.5,-292 738.5,-298 732.5,-304 726.5,-304"/>
<text text-anchor="middle" x="671" y="-282.3" font-family="Times,serif" font-size="14.00">处理Finished消息</text>
</g>
<!-- process_record&#45;&gt;handle_finished -->
<g id="edge16" class="edge">
<title>process_record&#45;&gt;handle_finished</title>
<path fill="none" stroke="black" d="M607.5,-375.95C615.44,-370.85 623.5,-364.78 630,-358 642.32,-345.14 652.39,-327.89 659.47,-313.61"/>
<polygon fill="black" stroke="black" points="662.76,-314.83 663.88,-304.29 656.44,-311.83 662.76,-314.83"/>
<text text-anchor="middle" x="672" y="-346.8" font-family="Times,serif" font-size="14.00">Finished</text>
</g>
<!-- error -->
<g id="node21" class="node">
<title>error</title>
<path fill="none" stroke="black" d="M286,-123C286,-123 236,-123 236,-123 230,-123 224,-117 224,-111 224,-111 224,-99 224,-99 224,-93 230,-87 236,-87 236,-87 286,-87 286,-87 292,-87 298,-93 298,-99 298,-99 298,-111 298,-111 298,-117 292,-123 286,-123"/>
<text text-anchor="middle" x="261" y="-101.3" font-family="Times,serif" font-size="14.00">错误处理</text>
</g>
<!-- process_record&#45;&gt;error -->
<g id="edge17" class="edge">
<title>process_record&#45;&gt;error</title>
<path fill="none" stroke="black" d="M523.72,-390.86C404.34,-385.32 115.9,-368.57 89,-335 29.64,-260.92 154.49,-169.96 221.8,-128.51"/>
<polygon fill="black" stroke="black" points="223.77,-131.41 230.5,-123.23 220.13,-125.42 223.77,-131.41"/>
<text text-anchor="middle" x="124" y="-238.8" font-family="Times,serif" font-size="14.00">错误类型</text>
</g>
<!-- verify_tls_version -->
<g id="node22" class="node">
<title>verify_tls_version</title>
<path fill="none" stroke="black" d="M1213,-673C1213,-673 1095,-673 1095,-673 1089,-673 1083,-667 1083,-661 1083,-661 1083,-649 1083,-649 1083,-643 1089,-637 1095,-637 1095,-637 1213,-637 1213,-637 1219,-637 1225,-643 1225,-649 1225,-649 1225,-661 1225,-661 1225,-667 1219,-673 1213,-673"/>
<text text-anchor="middle" x="1154" y="-651.3" font-family="Times,serif" font-size="14.00">verify_tls_version</text>
</g>
<!-- handle_server_hello&#45;&gt;verify_tls_version -->
<g id="edge18" class="edge">
<title>handle_server_hello&#45;&gt;verify_tls_version</title>
<path fill="none" stroke="black" d="M1248.8,-304.16C1268,-323.64 1295,-357.38 1295,-393 1295,-569 1295,-569 1295,-569 1295,-602.04 1266.25,-622.57 1234.72,-635.16"/>
<polygon fill="black" stroke="black" points="1233.48,-631.88 1225.33,-638.65 1235.92,-638.44 1233.48,-631.88"/>
<text text-anchor="middle" x="1337.5" y="-477.3" font-family="Times,serif" font-size="14.00">协商TLS版本</text>
</g>
<!-- handle_encrypted_ext&#45;&gt;read_record -->
<g id="edge21" class="edge">
<title>handle_encrypted_ext&#45;&gt;read_record</title>
<path fill="none" stroke="black" d="M890.59,-304.16C912.23,-314.78 941.6,-327.73 969,-335 1038.02,-353.32 1076.54,-311.96 1041,-358 991.52,-422.1 750.24,-459.03 635.65,-473.22"/>
<polygon fill="black" stroke="black" points="635.13,-469.76 625.63,-474.45 635.98,-476.71 635.13,-469.76"/>
<text text-anchor="middle" x="1063" y="-390.3" font-family="Times,serif" font-size="14.00">进入证书阶段</text>
</g>
<!-- verify_cert_chain -->
<g id="node14" class="node">
<title>verify_cert_chain</title>
<path fill="none" stroke="black" d="M76,-586C76,-586 12,-586 12,-586 6,-586 0,-580 0,-574 0,-574 0,-562 0,-562 0,-556 6,-550 12,-550 12,-550 76,-550 76,-550 82,-550 88,-556 88,-562 88,-562 88,-574 88,-574 88,-580 82,-586 76,-586"/>
<text text-anchor="middle" x="44" y="-564.3" font-family="Times,serif" font-size="14.00">验证证书链</text>
</g>
<!-- process_certificates&#45;&gt;verify_cert_chain -->
<g id="edge22" class="edge">
<title>process_certificates&#45;&gt;verify_cert_chain</title>
<path fill="none" stroke="black" d="M132.22,-304.23C116.37,-351.44 72.14,-483.19 53.01,-540.17"/>
<polygon fill="black" stroke="black" points="49.6,-539.31 49.74,-549.91 56.24,-541.54 49.6,-539.31"/>
</g>
<!-- verify_cert_chain&#45;&gt;read_record -->
<g id="edge23" class="edge">
<title>verify_cert_chain&#45;&gt;read_record</title>
<path fill="none" stroke="black" d="M76.5,-549.91C83.15,-546.92 90.2,-544.1 97,-542 242.06,-497.24 421.71,-485.79 513.98,-482.91"/>
<polygon fill="black" stroke="black" points="514.35,-486.4 524.25,-482.62 514.15,-479.41 514.35,-486.4"/>
<text text-anchor="middle" x="236" y="-520.8" font-family="Times,serif" font-size="14.00">继续验证或完成</text>
</g>
<!-- verify_signature -->
<g id="node24" class="node">
<title>verify_signature</title>
<path fill="none" stroke="black" d="M471.5,-586C471.5,-586 362.5,-586 362.5,-586 356.5,-586 350.5,-580 350.5,-574 350.5,-574 350.5,-562 350.5,-562 350.5,-556 356.5,-550 362.5,-550 362.5,-550 471.5,-550 471.5,-550 477.5,-550 483.5,-556 483.5,-562 483.5,-562 483.5,-574 483.5,-574 483.5,-580 477.5,-586 471.5,-586"/>
<text text-anchor="middle" x="417" y="-564.3" font-family="Times,serif" font-size="14.00">verify_signature</text>
</g>
<!-- handle_server_key_exchange&#45;&gt;verify_signature -->
<g id="edge24" class="edge">
<title>handle_server_key_exchange&#45;&gt;verify_signature</title>
<path fill="none" stroke="black" d="M241.32,-304.07C215.66,-315.96 191.85,-333.98 202,-358 238.1,-443.45 328.11,-511.2 379.49,-544.49"/>
<polygon fill="black" stroke="black" points="377.69,-547.5 388.01,-549.92 381.46,-541.6 377.69,-547.5"/>
<text text-anchor="middle" x="287" y="-433.8" font-family="Times,serif" font-size="14.00">验证签名</text>
</g>
<!-- send_client_key_exchange -->
<g id="node25" class="node">
<title>send_client_key_exchange</title>
<path fill="none" stroke="black" d="M586.5,-217C586.5,-217 407.5,-217 407.5,-217 401.5,-217 395.5,-211 395.5,-205 395.5,-205 395.5,-193 395.5,-193 395.5,-187 401.5,-181 407.5,-181 407.5,-181 586.5,-181 586.5,-181 592.5,-181 598.5,-187 598.5,-193 598.5,-193 598.5,-205 598.5,-205 598.5,-211 592.5,-217 586.5,-217"/>
<text text-anchor="middle" x="497" y="-195.3" font-family="Times,serif" font-size="14.00">send_client_key_exchange</text>
</g>
<!-- handle_server_hello_done&#45;&gt;send_client_key_exchange -->
<g id="edge26" class="edge">
<title>handle_server_hello_done&#45;&gt;send_client_key_exchange</title>
<path fill="none" stroke="black" d="M497,-267.8C497,-256.16 497,-240.55 497,-227.24"/>
<polygon fill="black" stroke="black" points="500.5,-227.18 497,-217.18 493.5,-227.18 500.5,-227.18"/>
<text text-anchor="middle" x="526" y="-238.8" font-family="Times,serif" font-size="14.00">发送密钥</text>
</g>
<!-- verify_signature_handshake -->
<g id="node26" class="node">
<title>verify_signature_handshake</title>
<path fill="none" stroke="black" d="M1231,-586C1231,-586 1039,-586 1039,-586 1033,-586 1027,-580 1027,-574 1027,-574 1027,-562 1027,-562 1027,-556 1033,-550 1039,-550 1039,-550 1231,-550 1231,-550 1237,-550 1243,-556 1243,-562 1243,-562 1243,-574 1243,-574 1243,-580 1237,-586 1231,-586"/>
<text text-anchor="middle" x="1135" y="-564.3" font-family="Times,serif" font-size="14.00">verify_signature_handshake</text>
</g>
<!-- handle_certificate_verify&#45;&gt;verify_signature_handshake -->
<g id="edge28" class="edge">
<title>handle_certificate_verify&#45;&gt;verify_signature_handshake</title>
<path fill="none" stroke="black" d="M1090.93,-304.18C1108.85,-314.02 1132.3,-326.14 1154,-335 1165.19,-339.57 1172.82,-333.27 1180,-343 1202.98,-374.11 1164.84,-487.79 1145.36,-540.21"/>
<polygon fill="black" stroke="black" points="1141.99,-539.24 1141.74,-549.83 1148.54,-541.7 1141.99,-539.24"/>
<text text-anchor="middle" x="1222" y="-433.8" font-family="Times,serif" font-size="14.00">验证握手签名</text>
</g>
<!-- setup_application_cipher -->
<g id="node19" class="node">
<title>setup_application_cipher</title>
<path fill="none" stroke="black" d="M543,-123C543,-123 451,-123 451,-123 445,-123 439,-117 439,-111 439,-111 439,-99 439,-99 439,-93 445,-87 451,-87 451,-87 543,-87 543,-87 549,-87 555,-93 555,-99 555,-99 555,-111 555,-111 555,-117 549,-123 543,-123"/>
<text text-anchor="middle" x="497" y="-101.3" font-family="Times,serif" font-size="14.00">设置应用层密码</text>
</g>
<!-- handle_finished&#45;&gt;setup_application_cipher -->
<g id="edge30" class="edge">
<title>handle_finished&#45;&gt;setup_application_cipher</title>
<path fill="none" stroke="black" d="M663.37,-267.64C653.1,-245.65 633.18,-207.46 608,-181 587.99,-159.97 561.11,-141.62 538.81,-128.34"/>
<polygon fill="black" stroke="black" points="540.29,-125.15 529.89,-123.14 536.77,-131.2 540.29,-125.15"/>
<text text-anchor="middle" x="678" y="-195.3" font-family="Times,serif" font-size="14.00">验证完成消息</text>
</g>
<!-- return_client -->
<g id="node20" class="node">
<title>return_client</title>
<path fill="none" stroke="black" d="M444,-36C444,-36 352,-36 352,-36 346,-36 340,-30 340,-24 340,-24 340,-12 340,-12 340,-6 346,0 352,0 352,0 444,0 444,0 450,0 456,-6 456,-12 456,-12 456,-24 456,-24 456,-30 450,-36 444,-36"/>
<text text-anchor="middle" x="398" y="-14.3" font-family="Times,serif" font-size="14.00">返回Client实例</text>
</g>
<!-- setup_application_cipher&#45;&gt;return_client -->
<g id="edge31" class="edge">
<title>setup_application_cipher&#45;&gt;return_client</title>
<path fill="none" stroke="black" d="M476.97,-86.8C462.21,-74.13 441.95,-56.73 425.65,-42.74"/>
<polygon fill="black" stroke="black" points="427.87,-40.03 418,-36.18 423.31,-45.35 427.87,-40.03"/>
<text text-anchor="middle" x="482" y="-57.8" font-family="Times,serif" font-size="14.00">完成握手</text>
</g>
<!-- error&#45;&gt;return_client -->
<g id="edge32" class="edge">
<title>error&#45;&gt;return_client</title>
<path fill="none" stroke="black" d="M288.72,-86.8C309.71,-73.78 338.72,-55.78 361.57,-41.6"/>
<polygon fill="black" stroke="black" points="363.67,-44.42 370.32,-36.18 359.97,-38.47 363.67,-44.42"/>
<text text-anchor="middle" x="366" y="-57.8" font-family="Times,serif" font-size="14.00">返回错误</text>
</g>
<!-- setup_handshake_cipher -->
<g id="node23" class="node">
<title>setup_handshake_cipher</title>
<path fill="none" stroke="black" d="M894.5,-586C894.5,-586 727.5,-586 727.5,-586 721.5,-586 715.5,-580 715.5,-574 715.5,-574 715.5,-562 715.5,-562 715.5,-556 721.5,-550 727.5,-550 727.5,-550 894.5,-550 894.5,-550 900.5,-550 906.5,-556 906.5,-562 906.5,-562 906.5,-574 906.5,-574 906.5,-580 900.5,-586 894.5,-586"/>
<text text-anchor="middle" x="811" y="-564.3" font-family="Times,serif" font-size="14.00">setup_handshake_cipher</text>
</g>
<!-- verify_tls_version&#45;&gt;setup_handshake_cipher -->
<g id="edge19" class="edge">
<title>verify_tls_version&#45;&gt;setup_handshake_cipher</title>
<path fill="none" stroke="black" d="M1085,-636.9C1028.6,-622.92 948.83,-603.16 889.9,-588.55"/>
<polygon fill="black" stroke="black" points="890.44,-585.08 879.89,-586.07 888.75,-591.87 890.44,-585.08"/>
<text text-anchor="middle" x="1046" y="-607.8" font-family="Times,serif" font-size="14.00">选择密码套件</text>
</g>
<!-- setup_handshake_cipher&#45;&gt;read_record -->
<g id="edge20" class="edge">
<title>setup_handshake_cipher&#45;&gt;read_record</title>
<path fill="none" stroke="black" d="M763.53,-549.9C725.52,-536.21 672.09,-516.97 631.82,-502.46"/>
<polygon fill="black" stroke="black" points="632.99,-499.17 622.4,-499.07 630.62,-505.75 632.99,-499.17"/>
<text text-anchor="middle" x="750" y="-520.8" font-family="Times,serif" font-size="14.00">继续读取记录</text>
</g>
<!-- verify_signature&#45;&gt;read_record -->
<g id="edge25" class="edge">
<title>verify_signature&#45;&gt;read_record</title>
<path fill="none" stroke="black" d="M448.97,-549.8C473.58,-536.56 507.74,-518.18 534.3,-503.9"/>
<polygon fill="black" stroke="black" points="536.2,-506.85 543.34,-499.03 532.88,-500.69 536.2,-506.85"/>
<text text-anchor="middle" x="585" y="-520.8" font-family="Times,serif" font-size="14.00">等待Server Hello Done</text>
</g>
<!-- send_client_key_exchange&#45;&gt;setup_application_cipher -->
<g id="edge27" class="edge">
<title>send_client_key_exchange&#45;&gt;setup_application_cipher</title>
<path fill="none" stroke="black" d="M497,-180.7C497,-167.46 497,-148.95 497,-133.66"/>
<polygon fill="black" stroke="black" points="500.5,-133.23 497,-123.23 493.5,-133.23 500.5,-133.23"/>
</g>
<!-- verify_signature_handshake&#45;&gt;read_record -->
<g id="edge29" class="edge">
<title>verify_signature_handshake&#45;&gt;read_record</title>
<path fill="none" stroke="black" d="M1026.69,-550.56C910.39,-532.91 729.72,-505.48 636.02,-491.26"/>
<polygon fill="black" stroke="black" points="636.26,-487.76 625.85,-489.72 635.21,-494.68 636.26,-487.76"/>
<text text-anchor="middle" x="933.5" y="-520.8" font-family="Times,serif" font-size="14.00">等待Finished</text>
</g>
</g>
</svg>
