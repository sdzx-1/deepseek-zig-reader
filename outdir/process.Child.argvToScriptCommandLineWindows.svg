<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="656pt" height="1116pt"
 viewBox="0.00 0.00 656.00 1116.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1112)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1112 652,-1112 652,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M494,-1108C494,-1108 464,-1108 464,-1108 458,-1108 452,-1102 452,-1096 452,-1096 452,-1084 452,-1084 452,-1078 458,-1072 464,-1072 464,-1072 494,-1072 494,-1072 500,-1072 506,-1078 506,-1084 506,-1084 506,-1096 506,-1096 506,-1102 500,-1108 494,-1108"/>
<text text-anchor="middle" x="479" y="-1086.3" font-family="Arial" font-size="14.00">开始</text>
</g>
<!-- init_buf -->
<g id="node2" class="node">
<title>init_buf</title>
<path fill="none" stroke="black" d="M529,-1035C529,-1035 429,-1035 429,-1035 423,-1035 417,-1029 417,-1023 417,-1023 417,-1009 417,-1009 417,-1003 423,-997 429,-997 429,-997 529,-997 529,-997 535,-997 541,-1003 541,-1009 541,-1009 541,-1023 541,-1023 541,-1029 535,-1035 529,-1035"/>
<text text-anchor="middle" x="479" y="-1019.8" font-family="Arial" font-size="14.00">初始化缓冲区 buf</text>
<text text-anchor="middle" x="479" y="-1004.8" font-family="Arial" font-size="14.00">容量64字节</text>
</g>
<!-- start&#45;&gt;init_buf -->
<g id="edge1" class="edge">
<title>start&#45;&gt;init_buf</title>
<path fill="none" stroke="black" d="M479,-1071.94C479,-1063.99 479,-1054.31 479,-1045.31"/>
<polygon fill="black" stroke="black" points="482.5,-1045.2 479,-1035.2 475.5,-1045.2 482.5,-1045.2"/>
</g>
<!-- add_cmd -->
<g id="node3" class="node">
<title>add_cmd</title>
<path fill="none" stroke="black" d="M563,-960C563,-960 395,-960 395,-960 389,-960 383,-954 383,-948 383,-948 383,-934 383,-934 383,-928 389,-922 395,-922 395,-922 563,-922 563,-922 569,-922 575,-928 575,-934 575,-934 575,-948 575,-948 575,-954 569,-960 563,-960"/>
<text text-anchor="middle" x="479" y="-944.8" font-family="Arial" font-size="14.00">添加基础命令</text>
<text text-anchor="middle" x="479" y="-929.8" font-family="Arial" font-size="14.00">cmd.exe /d /e:ON /v:OFF /c &quot;</text>
</g>
<!-- init_buf&#45;&gt;add_cmd -->
<g id="edge2" class="edge">
<title>init_buf&#45;&gt;add_cmd</title>
<path fill="none" stroke="black" d="M479,-996.96C479,-988.88 479,-979.18 479,-970.18"/>
<polygon fill="black" stroke="black" points="482.5,-970.09 479,-960.09 475.5,-970.09 482.5,-970.09"/>
</g>
<!-- handle_script_path -->
<g id="node4" class="node">
<title>handle_script_path</title>
<path fill="none" stroke="black" d="M518,-885C518,-885 440,-885 440,-885 434,-885 428,-879 428,-873 428,-873 428,-861 428,-861 428,-855 434,-849 440,-849 440,-849 518,-849 518,-849 524,-849 530,-855 530,-861 530,-861 530,-873 530,-873 530,-879 524,-885 518,-885"/>
<text text-anchor="middle" x="479" y="-863.3" font-family="Arial" font-size="14.00">处理脚本路径</text>
</g>
<!-- add_cmd&#45;&gt;handle_script_path -->
<g id="edge3" class="edge">
<title>add_cmd&#45;&gt;handle_script_path</title>
<path fill="none" stroke="black" d="M479,-921.83C479,-913.89 479,-904.41 479,-895.63"/>
<polygon fill="black" stroke="black" points="482.5,-895.42 479,-885.42 475.5,-895.42 482.5,-895.42"/>
</g>
<!-- check_separator -->
<g id="node5" class="node">
<title>check_separator</title>
<path fill="none" stroke="black" d="M467.08,-810.58C467.08,-810.58 339.93,-795.42 339.93,-795.42 333.97,-794.71 333.97,-793.29 339.93,-792.58 339.93,-792.58 467.08,-777.42 467.08,-777.42 473.04,-776.71 484.96,-776.71 490.92,-777.42 490.92,-777.42 618.07,-792.58 618.07,-792.58 624.03,-793.29 624.03,-794.71 618.07,-795.42 618.07,-795.42 490.92,-810.58 490.92,-810.58 484.96,-811.29 473.04,-811.29 467.08,-810.58"/>
<text text-anchor="middle" x="479" y="-790.3" font-family="Arial" font-size="14.00">检查路径是否包含 \ 或 /</text>
</g>
<!-- handle_script_path&#45;&gt;check_separator -->
<g id="edge4" class="edge">
<title>handle_script_path&#45;&gt;check_separator</title>
<path fill="none" stroke="black" d="M479,-848.81C479,-840.79 479,-831.05 479,-822.07"/>
<polygon fill="black" stroke="black" points="482.5,-822.03 479,-812.03 475.5,-822.03 482.5,-822.03"/>
</g>
<!-- add_prefix -->
<g id="node6" class="node">
<title>add_prefix</title>
<path fill="none" stroke="black" d="M470.5,-725C470.5,-725 405.5,-725 405.5,-725 399.5,-725 393.5,-719 393.5,-713 393.5,-713 393.5,-701 393.5,-701 393.5,-695 399.5,-689 405.5,-689 405.5,-689 470.5,-689 470.5,-689 476.5,-689 482.5,-695 482.5,-701 482.5,-701 482.5,-713 482.5,-713 482.5,-719 476.5,-725 470.5,-725"/>
<text text-anchor="middle" x="438" y="-703.3" font-family="Arial" font-size="14.00">添加 .\ 前缀</text>
</g>
<!-- check_separator&#45;&gt;add_prefix -->
<g id="edge5" class="edge">
<title>check_separator&#45;&gt;add_prefix</title>
<path fill="none" stroke="black" d="M471.09,-776.61C465.31,-764.62 457.34,-748.09 450.67,-734.27"/>
<polygon fill="black" stroke="black" points="453.8,-732.7 446.3,-725.21 447.5,-735.74 453.8,-732.7"/>
<text text-anchor="middle" x="468.5" y="-746.8" font-family="Arial" font-size="14.00">否</text>
</g>
<!-- encode_script -->
<g id="node7" class="node">
<title>encode_script</title>
<path fill="none" stroke="black" d="M552.5,-652C552.5,-652 403.5,-652 403.5,-652 397.5,-652 391.5,-646 391.5,-640 391.5,-640 391.5,-628 391.5,-628 391.5,-622 397.5,-616 403.5,-616 403.5,-616 552.5,-616 552.5,-616 558.5,-616 564.5,-622 564.5,-628 564.5,-628 564.5,-640 564.5,-640 564.5,-646 558.5,-652 552.5,-652"/>
<text text-anchor="middle" x="478" y="-630.3" font-family="Arial" font-size="14.00">转码脚本路径并添加引号</text>
</g>
<!-- check_separator&#45;&gt;encode_script -->
<g id="edge6" class="edge">
<title>check_separator&#45;&gt;encode_script</title>
<path fill="none" stroke="black" d="M483.3,-776.42C488.08,-755.9 494.66,-719.86 491,-689 489.95,-680.15 487.96,-670.65 485.85,-662.13"/>
<polygon fill="black" stroke="black" points="489.2,-661.1 483.27,-652.32 482.43,-662.88 489.2,-661.1"/>
<text text-anchor="middle" x="500.5" y="-703.3" font-family="Arial" font-size="14.00">是</text>
</g>
<!-- add_prefix&#45;&gt;encode_script -->
<g id="edge7" class="edge">
<title>add_prefix&#45;&gt;encode_script</title>
<path fill="none" stroke="black" d="M447.68,-688.81C452.4,-680.44 458.17,-670.2 463.41,-660.9"/>
<polygon fill="black" stroke="black" points="466.55,-662.46 468.41,-652.03 460.45,-659.02 466.55,-662.46"/>
</g>
<!-- loop_args -->
<g id="node8" class="node">
<title>loop_args</title>
<path fill="none" stroke="black" d="M517,-579C517,-579 439,-579 439,-579 433,-579 427,-573 427,-567 427,-567 427,-555 427,-555 427,-549 433,-543 439,-543 439,-543 517,-543 517,-543 523,-543 529,-549 529,-555 529,-555 529,-567 529,-567 529,-573 523,-579 517,-579"/>
<text text-anchor="middle" x="478" y="-557.3" font-family="Arial" font-size="14.00">遍历每个参数</text>
</g>
<!-- encode_script&#45;&gt;loop_args -->
<g id="edge8" class="edge">
<title>encode_script&#45;&gt;loop_args</title>
<path fill="none" stroke="black" d="M478,-615.81C478,-607.79 478,-598.05 478,-589.07"/>
<polygon fill="black" stroke="black" points="481.5,-589.03 478,-579.03 474.5,-589.03 481.5,-589.03"/>
</g>
<!-- check_invalid_chars -->
<g id="node9" class="node">
<title>check_invalid_chars</title>
<path fill="none" stroke="black" d="M176.24,-489.62C176.24,-489.62 11.76,-456.38 11.76,-456.38 5.88,-455.19 5.88,-452.81 11.76,-451.62 11.76,-451.62 176.24,-418.38 176.24,-418.38 182.12,-417.19 193.88,-417.19 199.76,-418.38 199.76,-418.38 364.24,-451.62 364.24,-451.62 370.12,-452.81 370.12,-455.19 364.24,-456.38 364.24,-456.38 199.76,-489.62 199.76,-489.62 193.88,-490.81 182.12,-490.81 176.24,-489.62"/>
<text text-anchor="middle" x="188" y="-457.8" font-family="Arial" font-size="14.00">检查参数是否包含非法字符</text>
<text text-anchor="middle" x="188" y="-442.8" font-family="Arial" font-size="14.00">(\x00, \r, \n)</text>
</g>
<!-- loop_args&#45;&gt;check_invalid_chars -->
<g id="edge9" class="edge">
<title>loop_args&#45;&gt;check_invalid_chars</title>
<path fill="none" stroke="black" d="M430.76,-542.9C385.43,-526.48 316.25,-501.43 263.31,-482.27"/>
<polygon fill="black" stroke="black" points="264.22,-478.88 253.63,-478.76 261.84,-485.46 264.22,-478.88"/>
</g>
<!-- finalize -->
<g id="node15" class="node">
<title>finalize</title>
<path fill="none" stroke="black" d="M550,-473C550,-473 406,-473 406,-473 400,-473 394,-467 394,-461 394,-461 394,-447 394,-447 394,-441 400,-435 406,-435 406,-435 550,-435 550,-435 556,-435 562,-441 562,-447 562,-447 562,-461 562,-461 562,-467 556,-473 550,-473"/>
<text text-anchor="middle" x="478" y="-457.8" font-family="Arial" font-size="14.00">闭合外层引号</text>
<text text-anchor="middle" x="478" y="-442.8" font-family="Arial" font-size="14.00">转码为UTF&#45;16 LE并返回</text>
</g>
<!-- loop_args&#45;&gt;finalize -->
<g id="edge18" class="edge">
<title>loop_args&#45;&gt;finalize</title>
<path fill="none" stroke="black" d="M478,-542.66C478,-526.52 478,-502.17 478,-483.22"/>
<polygon fill="black" stroke="black" points="481.5,-483.07 478,-473.07 474.5,-483.07 481.5,-483.07"/>
<text text-anchor="middle" x="507" y="-513.8" font-family="Arial" font-size="14.00">遍历完成</text>
</g>
<!-- error -->
<g id="node10" class="node">
<title>error</title>
<path fill="none" stroke="black" d="M170,-346C170,-346 48,-346 48,-346 42,-346 36,-340 36,-334 36,-334 36,-320 36,-320 36,-314 42,-308 48,-308 48,-308 170,-308 170,-308 176,-308 182,-314 182,-320 182,-320 182,-334 182,-334 182,-340 176,-346 170,-346"/>
<text text-anchor="middle" x="109" y="-330.8" font-family="Arial" font-size="14.00">返回错误</text>
<text text-anchor="middle" x="109" y="-315.8" font-family="Arial" font-size="14.00">InvalidBatchScriptArg</text>
</g>
<!-- check_invalid_chars&#45;&gt;error -->
<g id="edge10" class="edge">
<title>check_invalid_chars&#45;&gt;error</title>
<path fill="none" stroke="black" d="M167.24,-420.16C154.38,-399.8 138.06,-373.98 125.97,-354.85"/>
<polygon fill="black" stroke="black" points="128.88,-352.9 120.57,-346.31 122.96,-356.64 128.88,-352.9"/>
<text text-anchor="middle" x="168.5" y="-386.8" font-family="Arial" font-size="14.00">存在</text>
</g>
<!-- check_quotes_needed -->
<g id="node11" class="node">
<title>check_quotes_needed</title>
<path fill="none" stroke="black" d="M319.48,-361.66C319.48,-361.66 211.52,-330.34 211.52,-330.34 205.76,-328.67 205.76,-325.33 211.52,-323.66 211.52,-323.66 319.48,-292.34 319.48,-292.34 325.24,-290.67 336.76,-290.67 342.52,-292.34 342.52,-292.34 450.48,-323.66 450.48,-323.66 456.24,-325.33 456.24,-328.67 450.48,-330.34 450.48,-330.34 342.52,-361.66 342.52,-361.66 336.76,-363.33 325.24,-363.33 319.48,-361.66"/>
<text text-anchor="middle" x="331" y="-330.8" font-family="Arial" font-size="14.00">判断是否需要引号</text>
<text text-anchor="middle" x="331" y="-315.8" font-family="Arial" font-size="14.00">（空或末尾为\）</text>
</g>
<!-- check_invalid_chars&#45;&gt;check_quotes_needed -->
<g id="edge11" class="edge">
<title>check_invalid_chars&#45;&gt;check_quotes_needed</title>
<path fill="none" stroke="black" d="M222.62,-422.74C243.38,-404.59 269.85,-381.45 291.44,-362.58"/>
<polygon fill="black" stroke="black" points="293.92,-365.06 299.15,-355.84 289.31,-359.79 293.92,-365.06"/>
<text text-anchor="middle" x="290.5" y="-386.8" font-family="Arial" font-size="14.00">不存在</text>
</g>
<!-- check_special_chars -->
<g id="node12" class="node">
<title>check_special_chars</title>
<path fill="none" stroke="black" d="M319.48,-234.66C319.48,-234.66 211.52,-203.34 211.52,-203.34 205.76,-201.67 205.76,-198.33 211.52,-196.66 211.52,-196.66 319.48,-165.34 319.48,-165.34 325.24,-163.67 336.76,-163.67 342.52,-165.34 342.52,-165.34 450.48,-196.66 450.48,-196.66 456.24,-198.33 456.24,-201.67 450.48,-203.34 450.48,-203.34 342.52,-234.66 342.52,-234.66 336.76,-236.33 325.24,-236.33 319.48,-234.66"/>
<text text-anchor="middle" x="331" y="-203.8" font-family="Arial" font-size="14.00">检查特殊字符</text>
<text text-anchor="middle" x="331" y="-188.8" font-family="Arial" font-size="14.00">确定是否需要引号</text>
</g>
<!-- check_quotes_needed&#45;&gt;check_special_chars -->
<g id="edge12" class="edge">
<title>check_quotes_needed&#45;&gt;check_special_chars</title>
<path fill="none" stroke="black" d="M331,-288.83C331,-276.1 331,-261.68 331,-248.26"/>
<polygon fill="black" stroke="black" points="334.5,-248.24 331,-238.24 327.5,-248.24 334.5,-248.24"/>
<text text-anchor="middle" x="338.5" y="-259.8" font-family="Arial" font-size="14.00">否</text>
</g>
<!-- add_arg -->
<g id="node14" class="node">
<title>add_arg</title>
<path fill="none" stroke="black" d="M504.5,-36C504.5,-36 397.5,-36 397.5,-36 391.5,-36 385.5,-30 385.5,-24 385.5,-24 385.5,-12 385.5,-12 385.5,-6 391.5,0 397.5,0 397.5,0 504.5,0 504.5,0 510.5,0 516.5,-6 516.5,-12 516.5,-12 516.5,-24 516.5,-24 516.5,-30 510.5,-36 504.5,-36"/>
<text text-anchor="middle" x="451" y="-14.3" font-family="Arial" font-size="14.00">添加参数到缓冲区</text>
</g>
<!-- check_quotes_needed&#45;&gt;add_arg -->
<g id="edge13" class="edge">
<title>check_quotes_needed&#45;&gt;add_arg</title>
<path fill="none" stroke="black" d="M387.54,-305.3C417.65,-291.17 452.25,-269.27 471,-238 508.77,-175.02 497.91,-144.22 480,-73 477.56,-63.3 473,-53.44 468.21,-44.85"/>
<polygon fill="black" stroke="black" points="471.12,-42.9 463.01,-36.09 465.11,-46.48 471.12,-42.9"/>
<text text-anchor="middle" x="503.5" y="-132.8" font-family="Arial" font-size="14.00">是</text>
</g>
<!-- process_escapes -->
<g id="node13" class="node">
<title>process_escapes</title>
<path fill="none" stroke="black" d="M360,-111C360,-111 282,-111 282,-111 276,-111 270,-105 270,-99 270,-99 270,-85 270,-85 270,-79 276,-73 282,-73 282,-73 360,-73 360,-73 366,-73 372,-79 372,-85 372,-85 372,-99 372,-99 372,-105 366,-111 360,-111"/>
<text text-anchor="middle" x="321" y="-95.8" font-family="Arial" font-size="14.00">处理转义字符</text>
<text text-anchor="middle" x="321" y="-80.8" font-family="Arial" font-size="14.00">（\、&quot;、%）</text>
</g>
<!-- check_special_chars&#45;&gt;process_escapes -->
<g id="edge15" class="edge">
<title>check_special_chars&#45;&gt;process_escapes</title>
<path fill="none" stroke="black" d="M327.59,-162.82C326.3,-149.23 324.87,-134 323.66,-121.23"/>
<polygon fill="black" stroke="black" points="327.14,-120.81 322.72,-111.19 320.17,-121.47 327.14,-120.81"/>
<text text-anchor="middle" x="347.5" y="-132.8" font-family="Arial" font-size="14.00">不需要</text>
</g>
<!-- check_special_chars&#45;&gt;add_arg -->
<g id="edge14" class="edge">
<title>check_special_chars&#45;&gt;add_arg</title>
<path fill="none" stroke="black" d="M354.85,-168.83C360.92,-160.87 367.33,-152.2 373,-144 396.07,-110.65 420.48,-70.67 435.72,-45.06"/>
<polygon fill="black" stroke="black" points="438.82,-46.7 440.9,-36.31 432.79,-43.13 438.82,-46.7"/>
<text text-anchor="middle" x="448" y="-88.3" font-family="Arial" font-size="14.00">需要引号</text>
</g>
<!-- process_escapes&#45;&gt;add_arg -->
<g id="edge16" class="edge">
<title>process_escapes&#45;&gt;add_arg</title>
<path fill="none" stroke="black" d="M353.8,-72.83C371.18,-63.21 392.66,-51.31 411,-41.15"/>
<polygon fill="black" stroke="black" points="412.94,-44.08 420,-36.17 409.55,-37.95 412.94,-44.08"/>
</g>
<!-- add_arg&#45;&gt;loop_args -->
<g id="edge17" class="edge">
<title>add_arg&#45;&gt;loop_args</title>
<path fill="none" stroke="black" d="M516.84,-27.96C552.76,-36.97 590,-54.99 590,-91 590,-455 590,-455 590,-455 590,-492.48 556.21,-520.47 525.75,-538.08"/>
<polygon fill="black" stroke="black" points="523.92,-535.09 516.86,-542.99 527.3,-541.22 523.92,-535.09"/>
<text text-anchor="middle" x="619" y="-259.8" font-family="Arial" font-size="14.00">继续遍历</text>
</g>
<!-- end -->
<g id="node16" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M522,-345C522,-345 492,-345 492,-345 486,-345 480,-339 480,-333 480,-333 480,-321 480,-321 480,-315 486,-309 492,-309 492,-309 522,-309 522,-309 528,-309 534,-315 534,-321 534,-321 534,-333 534,-333 534,-339 528,-345 522,-345"/>
<text text-anchor="middle" x="507" y="-323.3" font-family="Arial" font-size="14.00">结束</text>
</g>
<!-- finalize&#45;&gt;end -->
<g id="edge19" class="edge">
<title>finalize&#45;&gt;end</title>
<path fill="none" stroke="black" d="M482.22,-434.82C487.06,-413.94 495.06,-379.47 500.66,-355.34"/>
<polygon fill="black" stroke="black" points="504.11,-355.92 502.97,-345.39 497.3,-354.34 504.11,-355.92"/>
</g>
</g>
</svg>
