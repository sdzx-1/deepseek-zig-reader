graph TD
    A[开始 airCmp] --> B[解析lhs和rhs操作数]
    B --> C[锁定寄存器]
    C --> D{类型检查}
    D -->|浮点类型| E[处理浮点比较]
    D -->|Optional类型| F[处理Optional比较]
    D -->|其他类型| G[处理整数/通用比较]
    
    E --> E1{检查硬件支持}
    E1 -->|支持| E2[生成SSE指令]
    E1 -->|不支持| E3[调用libc比较函数]
    E2 --> E4[设置浮点比较结果]
    E3 --> E4
    
    F --> F1[提取payload]
    F1 --> F2[生成null检查]
    F2 --> F3[生成payload比较]
    F3 --> F4[设置条件跳转]
    F4 --> F5[合并null和payload结果]
    
    G --> G1{操作数大小判断}
    G1 -->|>8字节| G2[多段比较循环]
    G1 -->|≤8字节| G3[单次比较]
    G2 --> G4[组合多段结果]
    G3 --> G5[生成CMP指令]
    G4 --> G6[设置整数比较结果]
    G5 --> G6
    
    E4 --> H[设置eflags]
    F5 --> H
    G6 --> H
    
    H --> I[处理条件跳转重定位]
    I --> J[释放寄存器锁]
    J --> K[返回比较结果]
