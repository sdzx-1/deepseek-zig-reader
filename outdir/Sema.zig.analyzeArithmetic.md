graph TD
    A[开始: analyzeArithmetic] --> B[检查操作数类型]
    B --> C{是否为指针?}
    C -- 是 --> D[处理指针运算]
    D --> D1{指针类型是否允许运算?}
    D1 -- 是 --> D2[计算指针偏移]
    D2 --> D3[生成IR指令]
    D3 --> E[返回结果]
    D1 -- 否 --> D4[报错: 无效指针运算]
    D4 --> E

    C -- 否 --> F[解析操作数类型]
    F --> G[类型检查和转换]
    G --> H{操作符类型?}
    H --> I1[处理加法]
    H --> I2[处理减法]
    H --> I3[处理乘法]

    subgraph 加法处理
        I1 --> I1A{是否有零操作数?}
        I1A -- 是 --> I1B[返回非零操作数]
        I1A -- 否 --> I1C[检查未定义值]
        I1C -- 存在undef --> I1D{是否为整数?}
        I1D -- 是 --> I1E[报错: 使用未定义]
        I1D -- 否 --> I1F[返回undef]
        I1C -- 无 --> I1G[处理溢出/生成IR]
    end

    subgraph 减法处理
        I2 --> I2A{右操作数是否为零?}
        I2A -- 是 --> I2B[返回左操作数]
        I2A -- 否 --> I2C[检查未定义值]
        I2C -- 存在undef --> I2D{是否为整数?}
        I2D -- 是 --> I2E[报错: 使用未定义]
        I2D -- 否 --> I2F[返回undef]
        I2C -- 无 --> I2G[处理溢出/生成IR]
    end

    subgraph 乘法处理
        I3 --> I3A{是否有零操作数?}
        I3A -- 是 --> I3B[返回零值]
        I3A -- 否 --> I3C[检查未定义值]
        I3C -- 存在undef --> I3D{是否为整数?}
        I3D -- 是 --> I3E[报错: 使用未定义]
        I3D -- 否 --> I3F[返回undef]
        I3C -- 无 --> I3G[处理溢出/生成IR]
    end

    I1G --> J[安全模式检查]
    I2G --> J
    I3G --> J
    J --> K{需要溢出检查?}
    K -- 是 --> L[插入溢出检测指令]
    L --> M[生成安全指令]
    K -- 否 --> M
    M --> E
