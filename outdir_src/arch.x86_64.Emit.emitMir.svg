<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="716pt" height="826pt"
 viewBox="0.00 0.00 715.50 826.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 822)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-822 711.5,-822 711.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M523,-818C523,-818 453,-818 453,-818 447,-818 441,-812 441,-806 441,-806 441,-794 441,-794 441,-788 447,-782 453,-782 453,-782 523,-782 523,-782 529,-782 535,-788 535,-794 535,-794 535,-806 535,-806 535,-812 529,-818 523,-818"/>
<text text-anchor="middle" x="488" y="-796.3" font-family="Arial" font-size="14.00">开始 emitMir</text>
</g>
<!-- init_vars -->
<g id="node2" class="node">
<title>init_vars</title>
<path fill="none" stroke="black" d="M569,-745C569,-745 407,-745 407,-745 401,-745 395,-739 395,-733 395,-733 395,-704 395,-704 395,-698 401,-692 407,-692 407,-692 569,-692 569,-692 575,-692 581,-698 581,-704 581,-704 581,-733 581,-733 581,-739 575,-745 569,-745"/>
<text text-anchor="middle" x="488" y="-729.8" font-family="Arial" font-size="14.00">初始化变量</text>
<text text-anchor="middle" x="488" y="-714.8" font-family="Arial" font-size="14.00">&#45; 分配 code_offset_mapping</text>
<text text-anchor="middle" x="488" y="-699.8" font-family="Arial" font-size="14.00">&#45; 初始化 relocs/table_relocs</text>
</g>
<!-- start&#45;&gt;init_vars -->
<g id="edge1" class="edge">
<title>start&#45;&gt;init_vars</title>
<path fill="none" stroke="black" d="M488,-781.75C488,-773.99 488,-764.51 488,-755.32"/>
<polygon fill="black" stroke="black" points="491.5,-755.18 488,-745.18 484.5,-755.18 491.5,-755.18"/>
</g>
<!-- loop_mir -->
<g id="node3" class="node">
<title>loop_mir</title>
<path fill="none" stroke="black" d="M557.5,-655C557.5,-655 418.5,-655 418.5,-655 412.5,-655 406.5,-649 406.5,-643 406.5,-643 406.5,-631 406.5,-631 406.5,-625 412.5,-619 418.5,-619 418.5,-619 557.5,-619 557.5,-619 563.5,-619 569.5,-625 569.5,-631 569.5,-631 569.5,-643 569.5,-643 569.5,-649 563.5,-655 557.5,-655"/>
<text text-anchor="middle" x="488" y="-633.3" font-family="Arial" font-size="14.00">循环遍历每条 MIR 指令</text>
</g>
<!-- init_vars&#45;&gt;loop_mir -->
<g id="edge2" class="edge">
<title>init_vars&#45;&gt;loop_mir</title>
<path fill="none" stroke="black" d="M488,-691.91C488,-683.48 488,-674.08 488,-665.52"/>
<polygon fill="black" stroke="black" points="491.5,-665.26 488,-655.26 484.5,-665.26 491.5,-665.26"/>
</g>
<!-- handle_mir -->
<g id="node4" class="node">
<title>handle_mir</title>
<path fill="none" stroke="black" d="M445.5,-568C445.5,-568 278.5,-568 278.5,-568 272.5,-568 266.5,-562 266.5,-556 266.5,-556 266.5,-527 266.5,-527 266.5,-521 272.5,-515 278.5,-515 278.5,-515 445.5,-515 445.5,-515 451.5,-515 457.5,-521 457.5,-527 457.5,-527 457.5,-556 457.5,-556 457.5,-562 451.5,-568 445.5,-568"/>
<text text-anchor="middle" x="362" y="-552.8" font-family="Arial" font-size="14.00">处理 MIR 指令</text>
<text text-anchor="middle" x="362" y="-537.8" font-family="Arial" font-size="14.00">&#45; 记录 code_offset_mapping</text>
<text text-anchor="middle" x="362" y="-522.8" font-family="Arial" font-size="14.00">&#45; 调用 lowerMir 生成 lowered</text>
</g>
<!-- loop_mir&#45;&gt;handle_mir -->
<g id="edge3" class="edge">
<title>loop_mir&#45;&gt;handle_mir</title>
<path fill="none" stroke="black" d="M415.92,-618.9C405.76,-614.28 396.05,-608.42 388,-601 381.11,-594.65 375.94,-586.14 372.1,-577.58"/>
<polygon fill="black" stroke="black" points="375.25,-576.02 368.32,-568.01 368.74,-578.6 375.25,-576.02"/>
<text text-anchor="middle" x="431" y="-589.8" font-family="Arial" font-size="14.00">遍历每条指令</text>
</g>
<!-- process_relocs -->
<g id="node11" class="node">
<title>process_relocs</title>
<path fill="none" stroke="black" d="M658.5,-560.5C658.5,-560.5 537.5,-560.5 537.5,-560.5 531.5,-560.5 525.5,-554.5 525.5,-548.5 525.5,-548.5 525.5,-534.5 525.5,-534.5 525.5,-528.5 531.5,-522.5 537.5,-522.5 537.5,-522.5 658.5,-522.5 658.5,-522.5 664.5,-522.5 670.5,-528.5 670.5,-534.5 670.5,-534.5 670.5,-548.5 670.5,-548.5 670.5,-554.5 664.5,-560.5 658.5,-560.5"/>
<text text-anchor="middle" x="598" y="-545.3" font-family="Arial" font-size="14.00">处理所有 relocs</text>
<text text-anchor="middle" x="598" y="-530.3" font-family="Arial" font-size="14.00">计算位移并写入代码</text>
</g>
<!-- loop_mir&#45;&gt;process_relocs -->
<g id="edge13" class="edge">
<title>loop_mir&#45;&gt;process_relocs</title>
<path fill="none" stroke="black" d="M508.18,-618.85C525.11,-604.46 549.52,-583.71 568.62,-567.47"/>
<polygon fill="black" stroke="black" points="571.1,-569.96 576.45,-560.82 566.56,-564.63 571.1,-569.96"/>
<text text-anchor="middle" x="604.5" y="-589.8" font-family="Arial" font-size="14.00">所有指令处理完成</text>
</g>
<!-- loop_lowered_insts -->
<g id="node5" class="node">
<title>loop_lowered_insts</title>
<path fill="none" stroke="black" d="M407,-463C407,-463 303,-463 303,-463 297,-463 291,-457 291,-451 291,-451 291,-439 291,-439 291,-433 297,-427 303,-427 303,-427 407,-427 407,-427 413,-427 419,-433 419,-439 419,-439 419,-451 419,-451 419,-457 413,-463 407,-463"/>
<text text-anchor="middle" x="355" y="-441.3" font-family="Arial" font-size="14.00">遍历 lowered 指令</text>
</g>
<!-- handle_mir&#45;&gt;loop_lowered_insts -->
<g id="edge4" class="edge">
<title>handle_mir&#45;&gt;loop_lowered_insts</title>
<path fill="none" stroke="black" d="M360.09,-514.68C359.14,-501.87 357.99,-486.4 357.03,-473.38"/>
<polygon fill="black" stroke="black" points="360.5,-472.85 356.27,-463.14 353.52,-473.37 360.5,-472.85"/>
</g>
<!-- check_prefix -->
<g id="node6" class="node">
<title>check_prefix</title>
<path fill="none" stroke="black" d="M311.5,-375C311.5,-375 190.5,-375 190.5,-375 184.5,-375 178.5,-369 178.5,-363 178.5,-363 178.5,-349 178.5,-349 178.5,-343 184.5,-337 190.5,-337 190.5,-337 311.5,-337 311.5,-337 317.5,-337 323.5,-343 323.5,-349 323.5,-349 323.5,-363 323.5,-363 323.5,-369 317.5,-375 311.5,-375"/>
<text text-anchor="middle" x="251" y="-359.8" font-family="Arial" font-size="14.00">检查指令前缀</text>
<text text-anchor="middle" x="251" y="-344.8" font-family="Arial" font-size="14.00">是否为伪指令 (.cfi_*)</text>
</g>
<!-- loop_lowered_insts&#45;&gt;check_prefix -->
<g id="edge5" class="edge">
<title>loop_lowered_insts&#45;&gt;check_prefix</title>
<path fill="none" stroke="black" d="M334.45,-426.81C319.09,-413.96 297.86,-396.2 280.66,-381.81"/>
<polygon fill="black" stroke="black" points="282.49,-378.78 272.58,-375.05 278,-384.15 282.49,-378.78"/>
</g>
<!-- check_empty_insts -->
<g id="node10" class="node">
<title>check_empty_insts</title>
<path fill="none" stroke="black" d="M535.5,-375C535.5,-375 428.5,-375 428.5,-375 422.5,-375 416.5,-369 416.5,-363 416.5,-363 416.5,-349 416.5,-349 416.5,-343 422.5,-337 428.5,-337 428.5,-337 535.5,-337 535.5,-337 541.5,-337 547.5,-343 547.5,-349 547.5,-349 547.5,-363 547.5,-363 547.5,-369 541.5,-375 535.5,-375"/>
<text text-anchor="middle" x="482" y="-359.8" font-family="Arial" font-size="14.00">检查是否有空指令</text>
<text text-anchor="middle" x="482" y="-344.8" font-family="Arial" font-size="14.00">处理调试伪指令</text>
</g>
<!-- loop_lowered_insts&#45;&gt;check_empty_insts -->
<g id="edge11" class="edge">
<title>loop_lowered_insts&#45;&gt;check_empty_insts</title>
<path fill="none" stroke="black" d="M362.61,-426.84C368.24,-415.86 376.86,-402.03 388,-393 394.3,-387.89 401.41,-383.46 408.82,-379.61"/>
<polygon fill="black" stroke="black" points="410.82,-382.53 418.33,-375.05 407.8,-376.22 410.82,-382.53"/>
<text text-anchor="middle" x="431" y="-396.8" font-family="Arial" font-size="14.00">指令处理完成</text>
</g>
<!-- handle_dwarf -->
<g id="node7" class="node">
<title>handle_dwarf</title>
<path fill="none" stroke="black" d="M146,-285C146,-285 12,-285 12,-285 6,-285 0,-279 0,-273 0,-273 0,-261 0,-261 0,-255 6,-249 12,-249 12,-249 146,-249 146,-249 152,-249 158,-255 158,-261 158,-261 158,-273 158,-273 158,-279 152,-285 146,-285"/>
<text text-anchor="middle" x="79" y="-263.3" font-family="Arial" font-size="14.00">生成 DWARF 调试信息</text>
</g>
<!-- check_prefix&#45;&gt;handle_dwarf -->
<g id="edge6" class="edge">
<title>check_prefix&#45;&gt;handle_dwarf</title>
<path fill="none" stroke="black" d="M215.36,-336.97C188.19,-323.23 150.67,-304.25 121.86,-289.68"/>
<polygon fill="black" stroke="black" points="123.34,-286.51 112.84,-285.12 120.18,-292.75 123.34,-286.51"/>
<text text-anchor="middle" x="205" y="-307.8" font-family="Arial" font-size="14.00">是伪指令</text>
</g>
<!-- encode_inst -->
<g id="node8" class="node">
<title>encode_inst</title>
<path fill="none" stroke="black" d="M314,-285C314,-285 188,-285 188,-285 182,-285 176,-279 176,-273 176,-273 176,-261 176,-261 176,-255 182,-249 188,-249 188,-249 314,-249 314,-249 320,-249 326,-255 326,-261 326,-261 326,-273 326,-273 326,-279 320,-285 314,-285"/>
<text text-anchor="middle" x="251" y="-263.3" font-family="Arial" font-size="14.00">编码指令到 emit.code</text>
</g>
<!-- check_prefix&#45;&gt;encode_inst -->
<g id="edge7" class="edge">
<title>check_prefix&#45;&gt;encode_inst</title>
<path fill="none" stroke="black" d="M251,-336.97C251,-324.96 251,-308.93 251,-295.36"/>
<polygon fill="black" stroke="black" points="254.5,-295.12 251,-285.12 247.5,-295.12 254.5,-295.12"/>
<text text-anchor="middle" x="280" y="-307.8" font-family="Arial" font-size="14.00">非伪指令</text>
</g>
<!-- handle_relocs -->
<g id="node9" class="node">
<title>handle_relocs</title>
<path fill="none" stroke="black" d="M365,-211C365,-211 157,-211 157,-211 151,-211 145,-205 145,-199 145,-199 145,-185 145,-185 145,-179 151,-173 157,-173 157,-173 365,-173 365,-173 371,-173 377,-179 377,-185 377,-185 377,-199 377,-199 377,-205 371,-211 365,-211"/>
<text text-anchor="middle" x="261" y="-195.8" font-family="Arial" font-size="14.00">处理重定位信息</text>
<text text-anchor="middle" x="261" y="-180.8" font-family="Arial" font-size="14.00">根据类型添加到 relocs/table_relocs</text>
</g>
<!-- handle_dwarf&#45;&gt;handle_relocs -->
<g id="edge8" class="edge">
<title>handle_dwarf&#45;&gt;handle_relocs</title>
<path fill="none" stroke="black" d="M121.67,-248.88C147.05,-238.71 179.49,-225.7 206.68,-214.79"/>
<polygon fill="black" stroke="black" points="208.08,-218 216.06,-211.03 205.47,-211.5 208.08,-218"/>
</g>
<!-- handle_cfi_directive -->
<g id="node14" class="node">
<title>handle_cfi_directive</title>
<path fill="none" stroke="black" d="M115,-211C115,-211 23,-211 23,-211 17,-211 11,-205 11,-199 11,-199 11,-185 11,-185 11,-179 17,-173 23,-173 23,-173 115,-173 115,-173 121,-173 127,-179 127,-185 127,-185 127,-199 127,-199 127,-205 121,-211 115,-211"/>
<text text-anchor="middle" x="69" y="-195.8" font-family="Arial" font-size="14.00">根据 .cfi_* 类型</text>
<text text-anchor="middle" x="69" y="-180.8" font-family="Arial" font-size="14.00">生成对应调试帧</text>
</g>
<!-- handle_dwarf&#45;&gt;handle_cfi_directive -->
<!-- encode_inst&#45;&gt;handle_relocs -->
<g id="edge9" class="edge">
<title>encode_inst&#45;&gt;handle_relocs</title>
<path fill="none" stroke="black" d="M253.37,-248.7C254.49,-240.49 255.87,-230.47 257.14,-221.2"/>
<polygon fill="black" stroke="black" points="260.62,-221.58 258.51,-211.19 253.68,-220.63 260.62,-221.58"/>
</g>
<!-- handle_relocs&#45;&gt;loop_lowered_insts -->
<g id="edge10" class="edge">
<title>handle_relocs&#45;&gt;loop_lowered_insts</title>
<path fill="none" stroke="black" d="M296.88,-211.08C311.15,-220.16 326.22,-232.55 335,-248 365.49,-301.67 362.93,-377.06 358.77,-416.89"/>
<polygon fill="black" stroke="black" points="355.28,-416.57 357.61,-426.9 362.24,-417.37 355.28,-416.57"/>
<text text-anchor="middle" x="401" y="-307.8" font-family="Arial" font-size="14.00">继续遍历指令</text>
</g>
<!-- reloc_switch -->
<g id="node15" class="node">
<title>reloc_switch</title>
<path fill="none" stroke="black" d="M338.5,-136C338.5,-136 183.5,-136 183.5,-136 177.5,-136 171.5,-130 171.5,-124 171.5,-124 171.5,-95 171.5,-95 171.5,-89 177.5,-83 183.5,-83 183.5,-83 338.5,-83 338.5,-83 344.5,-83 350.5,-89 350.5,-95 350.5,-95 350.5,-124 350.5,-124 350.5,-130 344.5,-136 338.5,-136"/>
<text text-anchor="middle" x="261" y="-120.8" font-family="Arial" font-size="14.00">根据重定位类型</text>
<text text-anchor="middle" x="261" y="-105.8" font-family="Arial" font-size="14.00">(inst/table/linker_extern_fn)</text>
<text text-anchor="middle" x="261" y="-90.8" font-family="Arial" font-size="14.00">分发到不同处理逻辑</text>
</g>
<!-- handle_relocs&#45;&gt;reloc_switch -->
<!-- check_empty_insts&#45;&gt;loop_mir -->
<g id="edge12" class="edge">
<title>check_empty_insts&#45;&gt;loop_mir</title>
<path fill="none" stroke="black" d="M482.39,-375.25C483.42,-423.02 486.19,-551.96 487.41,-608.64"/>
<polygon fill="black" stroke="black" points="483.92,-609.04 487.63,-618.97 490.92,-608.89 483.92,-609.04"/>
<text text-anchor="middle" x="535" y="-485.8" font-family="Arial" font-size="14.00">继续下一条 MIR</text>
</g>
<!-- handle_pseudo -->
<g id="node16" class="node">
<title>handle_pseudo</title>
<path fill="none" stroke="black" d="M564,-286C564,-286 400,-286 400,-286 394,-286 388,-280 388,-274 388,-274 388,-260 388,-260 388,-254 394,-248 400,-248 400,-248 564,-248 564,-248 570,-248 576,-254 576,-260 576,-260 576,-274 576,-274 576,-280 570,-286 564,-286"/>
<text text-anchor="middle" x="482" y="-270.8" font-family="Arial" font-size="14.00">处理伪指令</text>
<text text-anchor="middle" x="482" y="-255.8" font-family="Arial" font-size="14.00">如调试标记、局部变量信息</text>
</g>
<!-- check_empty_insts&#45;&gt;handle_pseudo -->
<!-- process_table_relocs -->
<g id="node12" class="node">
<title>process_table_relocs</title>
<path fill="none" stroke="black" d="M695.5,-464C695.5,-464 528.5,-464 528.5,-464 522.5,-464 516.5,-458 516.5,-452 516.5,-452 516.5,-438 516.5,-438 516.5,-432 522.5,-426 528.5,-426 528.5,-426 695.5,-426 695.5,-426 701.5,-426 707.5,-432 707.5,-438 707.5,-438 707.5,-452 707.5,-452 707.5,-458 701.5,-464 695.5,-464"/>
<text text-anchor="middle" x="612" y="-448.8" font-family="Arial" font-size="14.00">处理 table_relocs</text>
<text text-anchor="middle" x="612" y="-433.8" font-family="Arial" font-size="14.00">生成 ELF 重定位并填充代码</text>
</g>
<!-- process_relocs&#45;&gt;process_table_relocs -->
<g id="edge14" class="edge">
<title>process_relocs&#45;&gt;process_table_relocs</title>
<path fill="none" stroke="black" d="M600.7,-522.28C602.71,-508.68 605.5,-489.85 607.81,-474.3"/>
<polygon fill="black" stroke="black" points="611.31,-474.57 609.31,-464.16 604.38,-473.54 611.31,-474.57"/>
</g>
<!-- end -->
<g id="node13" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M637,-374C637,-374 587,-374 587,-374 581,-374 575,-368 575,-362 575,-362 575,-350 575,-350 575,-344 581,-338 587,-338 587,-338 637,-338 637,-338 643,-338 649,-344 649,-350 649,-350 649,-362 649,-362 649,-368 643,-374 637,-374"/>
<text text-anchor="middle" x="612" y="-352.3" font-family="Arial" font-size="14.00">函数结束</text>
</g>
<!-- process_table_relocs&#45;&gt;end -->
<g id="edge15" class="edge">
<title>process_table_relocs&#45;&gt;end</title>
<path fill="none" stroke="black" d="M612,-425.97C612,-413.96 612,-397.93 612,-384.36"/>
<polygon fill="black" stroke="black" points="615.5,-384.12 612,-374.12 608.5,-384.12 615.5,-384.12"/>
</g>
<!-- elf_reloc -->
<g id="node17" class="node">
<title>elf_reloc</title>
<path fill="none" stroke="black" d="M160,-36C160,-36 68,-36 68,-36 62,-36 56,-30 56,-24 56,-24 56,-12 56,-12 56,-6 62,0 68,0 68,0 160,0 160,0 166,0 172,-6 172,-12 172,-12 172,-24 172,-24 172,-30 166,-36 160,-36"/>
<text text-anchor="middle" x="114" y="-14.3" font-family="Arial" font-size="14.00">ELF 重定位处理</text>
</g>
<!-- reloc_switch&#45;&gt;elf_reloc -->
<g id="edge19" class="edge">
<title>reloc_switch&#45;&gt;elf_reloc</title>
<path fill="none" stroke="black" d="M218.88,-82.85C197.44,-69.8 171.63,-54.09 150.98,-41.51"/>
<polygon fill="black" stroke="black" points="152.54,-38.37 142.18,-36.15 148.9,-44.34 152.54,-38.37"/>
<text text-anchor="middle" x="197.5" y="-57" font-family="Arial" font-size="10.00">ELF</text>
</g>
<!-- macho_reloc -->
<g id="node18" class="node">
<title>macho_reloc</title>
<path fill="none" stroke="black" d="M319.5,-36C319.5,-36 202.5,-36 202.5,-36 196.5,-36 190.5,-30 190.5,-24 190.5,-24 190.5,-12 190.5,-12 190.5,-6 196.5,0 202.5,0 202.5,0 319.5,0 319.5,0 325.5,0 331.5,-6 331.5,-12 331.5,-12 331.5,-24 331.5,-24 331.5,-30 325.5,-36 319.5,-36"/>
<text text-anchor="middle" x="261" y="-14.3" font-family="Arial" font-size="14.00">Mach&#45;O 重定位处理</text>
</g>
<!-- reloc_switch&#45;&gt;macho_reloc -->
<g id="edge20" class="edge">
<title>reloc_switch&#45;&gt;macho_reloc</title>
<path fill="none" stroke="black" d="M261,-82.61C261,-71.15 261,-57.67 261,-46.07"/>
<polygon fill="black" stroke="black" points="264.5,-46.06 261,-36.06 257.5,-46.06 264.5,-46.06"/>
<text text-anchor="middle" x="278.5" y="-57" font-family="Arial" font-size="10.00">Mach&#45;O</text>
</g>
<!-- coff_reloc -->
<g id="node19" class="node">
<title>coff_reloc</title>
<path fill="none" stroke="black" d="M466.5,-36C466.5,-36 361.5,-36 361.5,-36 355.5,-36 349.5,-30 349.5,-24 349.5,-24 349.5,-12 349.5,-12 349.5,-6 355.5,0 361.5,0 361.5,0 466.5,0 466.5,0 472.5,0 478.5,-6 478.5,-12 478.5,-12 478.5,-24 478.5,-24 478.5,-30 472.5,-36 466.5,-36"/>
<text text-anchor="middle" x="414" y="-14.3" font-family="Arial" font-size="14.00">COFF 重定位处理</text>
</g>
<!-- reloc_switch&#45;&gt;coff_reloc -->
<g id="edge21" class="edge">
<title>reloc_switch&#45;&gt;coff_reloc</title>
<path fill="none" stroke="black" d="M304.84,-82.85C327.25,-69.75 354.26,-53.95 375.8,-41.34"/>
<polygon fill="black" stroke="black" points="377.81,-44.23 384.67,-36.15 374.28,-38.18 377.81,-44.23"/>
<text text-anchor="middle" x="366" y="-57" font-family="Arial" font-size="10.00">COFF</text>
</g>
</g>
</svg>
