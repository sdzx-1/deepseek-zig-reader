<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Blake2sFlow Pages: 1 -->
<svg width="478pt" height="520pt"
 viewBox="0.00 0.00 477.50 520.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 516)">
<title>Blake2sFlow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-516 473.5,-516 473.5,4 -4,4"/>
<!-- init -->
<g id="node1" class="node">
<title>init</title>
<path fill="none" stroke="black" d="M407,-512C407,-512 282,-512 282,-512 276,-512 270,-506 270,-500 270,-500 270,-456 270,-456 270,-450 276,-444 282,-444 282,-444 407,-444 407,-444 413,-444 419,-450 419,-456 419,-456 419,-500 419,-500 419,-506 413,-512 407,-512"/>
<text text-anchor="middle" x="344.5" y="-496.8" font-family="Times,serif" font-size="14.00">初始化 (init)</text>
<text text-anchor="middle" x="344.5" y="-481.8" font-family="Times,serif" font-size="14.00">&#45; 设置初始向量IV</text>
<text text-anchor="middle" x="344.5" y="-466.8" font-family="Times,serif" font-size="14.00">&#45; 处理密钥/盐/上下文</text>
<text text-anchor="middle" x="344.5" y="-451.8" font-family="Times,serif" font-size="14.00">&#45; 异或操作调整参数</text>
</g>
<!-- update -->
<g id="node3" class="node">
<title>update</title>
<path fill="none" stroke="black" d="M218.5,-393C218.5,-393 104.5,-393 104.5,-393 98.5,-393 92.5,-387 92.5,-381 92.5,-381 92.5,-337 92.5,-337 92.5,-331 98.5,-325 104.5,-325 104.5,-325 218.5,-325 218.5,-325 224.5,-325 230.5,-331 230.5,-337 230.5,-337 230.5,-381 230.5,-381 230.5,-387 224.5,-393 218.5,-393"/>
<text text-anchor="middle" x="161.5" y="-377.8" font-family="Times,serif" font-size="14.00">更新数据 (update)</text>
<text text-anchor="middle" x="161.5" y="-362.8" font-family="Times,serif" font-size="14.00">&#45; 处理缓存数据</text>
<text text-anchor="middle" x="161.5" y="-347.8" font-family="Times,serif" font-size="14.00">&#45; 分块处理输入</text>
<text text-anchor="middle" x="161.5" y="-332.8" font-family="Times,serif" font-size="14.00">&#45; 保存剩余到缓存</text>
</g>
<!-- init&#45;&gt;update -->
<g id="edge2" class="edge">
<title>init&#45;&gt;update</title>
<path fill="none" stroke="black" d="M292.55,-443.79C270.53,-429.71 244.73,-413.21 221.87,-398.6"/>
<polygon fill="black" stroke="black" points="223.57,-395.53 213.26,-393.09 219.8,-401.43 223.57,-395.53"/>
<text text-anchor="middle" x="300.5" y="-414.8" font-family="Times,serif" font-size="14.00">存在密钥时</text>
</g>
<!-- IV/参数配置 -->
<g id="node7" class="node">
<title>IV/参数配置</title>
<path fill="none" stroke="black" d="M448,-377C448,-377 379,-377 379,-377 373,-377 367,-371 367,-365 367,-365 367,-353 367,-353 367,-347 373,-341 379,-341 379,-341 448,-341 448,-341 454,-341 460,-347 460,-353 460,-353 460,-365 460,-365 460,-371 454,-377 448,-377"/>
<text text-anchor="middle" x="413.5" y="-355.3" font-family="Times,serif" font-size="14.00">IV/参数配置</text>
</g>
<!-- init&#45;&gt;IV/参数配置 -->
<g id="edge10" class="edge">
<title>init&#45;&gt;IV/参数配置</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M364.09,-443.79C374.91,-425.43 388.16,-402.96 398.22,-385.92"/>
<polygon fill="black" stroke="black" points="401.37,-387.46 403.44,-377.06 395.34,-383.9 401.37,-387.46"/>
<text text-anchor="middle" x="426.5" y="-414.8" font-family="Times,serif" font-size="14.00">初始向量调整</text>
</g>
<!-- hash -->
<g id="node2" class="node">
<title>hash</title>
<path fill="none" stroke="black" d="M183,-497C183,-497 12,-497 12,-497 6,-497 0,-491 0,-485 0,-485 0,-471 0,-471 0,-465 6,-459 12,-459 12,-459 183,-459 183,-459 189,-459 195,-465 195,-471 195,-471 195,-485 195,-485 195,-491 189,-497 183,-497"/>
<text text-anchor="middle" x="97.5" y="-481.8" font-family="Times,serif" font-size="14.00">哈希入口 (hash)</text>
<text text-anchor="middle" x="97.5" y="-466.8" font-family="Times,serif" font-size="14.00">调用 init → update → final</text>
</g>
<!-- hash&#45;&gt;init -->
<g id="edge1" class="edge">
<title>hash&#45;&gt;init</title>
<path fill="none" stroke="black" d="M195.12,-478C216.44,-478 238.84,-478 259.62,-478"/>
<polygon fill="black" stroke="black" points="259.68,-481.5 269.68,-478 259.68,-474.5 259.68,-481.5"/>
<text text-anchor="middle" x="232.5" y="-484.8" font-family="Times,serif" font-size="14.00">创建实例</text>
</g>
<!-- hash&#45;&gt;update -->
<g id="edge3" class="edge">
<title>hash&#45;&gt;update</title>
<path fill="none" stroke="black" d="M107.36,-458.98C115.59,-443.92 127.66,-421.86 138.32,-402.38"/>
<polygon fill="black" stroke="black" points="141.52,-403.81 143.25,-393.36 135.38,-400.45 141.52,-403.81"/>
<text text-anchor="middle" x="176.5" y="-414.8" font-family="Times,serif" font-size="14.00">处理输入数据</text>
</g>
<!-- final -->
<g id="node4" class="node">
<title>final</title>
<path fill="none" stroke="black" d="M134,-155C134,-155 33,-155 33,-155 27,-155 21,-149 21,-143 21,-143 21,-99 21,-99 21,-93 27,-87 33,-87 33,-87 134,-87 134,-87 140,-87 146,-93 146,-99 146,-99 146,-143 146,-143 146,-149 140,-155 134,-155"/>
<text text-anchor="middle" x="83.5" y="-139.8" font-family="Times,serif" font-size="14.00">最终处理 (final)</text>
<text text-anchor="middle" x="83.5" y="-124.8" font-family="Times,serif" font-size="14.00">&#45; 填充零字节</text>
<text text-anchor="middle" x="83.5" y="-109.8" font-family="Times,serif" font-size="14.00">&#45; 执行最后一轮</text>
<text text-anchor="middle" x="83.5" y="-94.8" font-family="Times,serif" font-size="14.00">&#45; 转换字节序输出</text>
</g>
<!-- hash&#45;&gt;final -->
<g id="edge6" class="edge">
<title>hash&#45;&gt;final</title>
<path fill="none" stroke="black" d="M94.36,-459C91.43,-442 86.99,-415.8 83.5,-393 68.69,-296.23 61.71,-270.3 72.5,-173 72.79,-170.35 73.17,-167.63 73.59,-164.9"/>
<polygon fill="black" stroke="black" points="77.04,-165.49 75.35,-155.03 70.15,-164.27 77.04,-165.49"/>
<text text-anchor="middle" x="114.5" y="-295.8" font-family="Times,serif" font-size="14.00">完成所有数据</text>
</g>
<!-- update&#45;&gt;update -->
<g id="edge5" class="edge">
<title>update&#45;&gt;update</title>
<path fill="none" stroke="black" d="M230.77,-368.92C241.33,-367.4 248.5,-364.1 248.5,-359 248.5,-355.73 245.56,-353.2 240.67,-351.41"/>
<polygon fill="black" stroke="black" points="241.31,-347.97 230.77,-349.08 239.71,-354.78 241.31,-347.97"/>
<text text-anchor="middle" x="298.5" y="-355.3" font-family="Times,serif" font-size="14.00">循环处理完整块</text>
</g>
<!-- round -->
<g id="node5" class="node">
<title>round</title>
<path fill="none" stroke="black" d="M212,-274C212,-274 111,-274 111,-274 105,-274 99,-268 99,-262 99,-262 99,-218 99,-218 99,-212 105,-206 111,-206 111,-206 212,-206 212,-206 218,-206 224,-212 224,-218 224,-218 224,-262 224,-262 224,-268 218,-274 212,-274"/>
<text text-anchor="middle" x="161.5" y="-258.8" font-family="Times,serif" font-size="14.00">轮函数 (round)</text>
<text text-anchor="middle" x="161.5" y="-243.8" font-family="Times,serif" font-size="14.00">&#45; 消息调度</text>
<text text-anchor="middle" x="161.5" y="-228.8" font-family="Times,serif" font-size="14.00">&#45; 压缩函数处理</text>
<text text-anchor="middle" x="161.5" y="-213.8" font-family="Times,serif" font-size="14.00">&#45; 更新状态寄存器</text>
</g>
<!-- update&#45;&gt;round -->
<g id="edge4" class="edge">
<title>update&#45;&gt;round</title>
<path fill="none" stroke="black" d="M161.5,-324.79C161.5,-312.31 161.5,-297.94 161.5,-284.66"/>
<polygon fill="black" stroke="black" points="165,-284.3 161.5,-274.3 158,-284.3 165,-284.3"/>
<text text-anchor="middle" x="199.5" y="-295.8" font-family="Times,serif" font-size="14.00">每64字节块</text>
</g>
<!-- 缓存管理 -->
<g id="node8" class="node">
<title>缓存管理</title>
<path fill="none" stroke="black" d="M304.5,-258C304.5,-258 254.5,-258 254.5,-258 248.5,-258 242.5,-252 242.5,-246 242.5,-246 242.5,-234 242.5,-234 242.5,-228 248.5,-222 254.5,-222 254.5,-222 304.5,-222 304.5,-222 310.5,-222 316.5,-228 316.5,-234 316.5,-234 316.5,-246 316.5,-246 316.5,-252 310.5,-258 304.5,-258"/>
<text text-anchor="middle" x="279.5" y="-236.3" font-family="Times,serif" font-size="14.00">缓存管理</text>
</g>
<!-- update&#45;&gt;缓存管理 -->
<g id="edge11" class="edge">
<title>update&#45;&gt;缓存管理</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M220.84,-324.86C228.24,-319.42 235.35,-313.43 241.5,-307 252.42,-295.58 261.43,-280.43 267.93,-267.53"/>
<polygon fill="black" stroke="black" points="271.23,-268.73 272.4,-258.2 264.92,-265.71 271.23,-268.73"/>
<text text-anchor="middle" x="289.5" y="-295.8" font-family="Times,serif" font-size="14.00">部分块处理</text>
</g>
<!-- final&#45;&gt;round -->
<g id="edge7" class="edge">
<title>final&#45;&gt;round</title>
<path fill="none" stroke="black" d="M127.78,-155.05C133.29,-160.58 138.41,-166.61 142.5,-173 146.98,-180 150.42,-188.08 153.07,-196.13"/>
<polygon fill="black" stroke="black" points="149.75,-197.24 155.92,-205.86 156.47,-195.28 149.75,-197.24"/>
<text text-anchor="middle" x="193.5" y="-176.8" font-family="Times,serif" font-size="14.00">最后一块数据</text>
</g>
<!-- 输出摘要 -->
<g id="node6" class="node">
<title>输出摘要</title>
<path fill="none" stroke="black" d="M108.5,-36C108.5,-36 58.5,-36 58.5,-36 52.5,-36 46.5,-30 46.5,-24 46.5,-24 46.5,-12 46.5,-12 46.5,-6 52.5,0 58.5,0 58.5,0 108.5,0 108.5,0 114.5,0 120.5,-6 120.5,-12 120.5,-12 120.5,-24 120.5,-24 120.5,-30 114.5,-36 108.5,-36"/>
<text text-anchor="middle" x="83.5" y="-14.3" font-family="Times,serif" font-size="14.00">输出摘要</text>
</g>
<!-- final&#45;&gt;输出摘要 -->
<g id="edge9" class="edge">
<title>final&#45;&gt;输出摘要</title>
<path fill="none" stroke="black" d="M83.5,-86.93C83.5,-73.85 83.5,-58.99 83.5,-46.51"/>
<polygon fill="black" stroke="black" points="87,-46.26 83.5,-36.26 80,-46.26 87,-46.26"/>
<text text-anchor="middle" x="119.5" y="-57.8" font-family="Times,serif" font-size="14.00">小端序转换</text>
</g>
<!-- round&#45;&gt;final -->
<g id="edge8" class="edge">
<title>round&#45;&gt;final</title>
<path fill="none" stroke="black" d="M98.67,-209.17C91.4,-203.17 85,-196.15 80.5,-188 76.68,-181.08 75.13,-173.1 74.91,-165.14"/>
<polygon fill="black" stroke="black" points="78.41,-165.26 75.27,-155.14 71.42,-165.01 78.41,-165.26"/>
<text text-anchor="middle" x="109.5" y="-176.8" font-family="Times,serif" font-size="14.00">更新状态</text>
</g>
<!-- 压缩函数细节 -->
<g id="node9" class="node">
<title>压缩函数细节</title>
<path fill="none" stroke="black" d="M312.5,-139C312.5,-139 234.5,-139 234.5,-139 228.5,-139 222.5,-133 222.5,-127 222.5,-127 222.5,-115 222.5,-115 222.5,-109 228.5,-103 234.5,-103 234.5,-103 312.5,-103 312.5,-103 318.5,-103 324.5,-109 324.5,-115 324.5,-115 324.5,-127 324.5,-127 324.5,-133 318.5,-139 312.5,-139"/>
<text text-anchor="middle" x="273.5" y="-117.3" font-family="Times,serif" font-size="14.00">压缩函数细节</text>
</g>
<!-- round&#45;&gt;压缩函数细节 -->
<g id="edge12" class="edge">
<title>round&#45;&gt;压缩函数细节</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M220.85,-205.81C227.96,-200.41 234.73,-194.44 240.5,-188 250.72,-176.6 258.59,-161.45 264.08,-148.55"/>
<polygon fill="black" stroke="black" points="267.35,-149.8 267.81,-139.21 260.85,-147.2 267.35,-149.8"/>
<text text-anchor="middle" x="289.5" y="-176.8" font-family="Times,serif" font-size="14.00">16次轮操作</text>
</g>
</g>
</svg>
