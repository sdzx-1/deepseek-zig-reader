<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="731pt" height="1312pt"
 viewBox="0.00 0.00 730.77 1312.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1308)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1308 726.77,-1308 726.77,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="none" stroke="black" cx="483.77" cy="-1286" rx="94.78" ry="18"/>
<text text-anchor="middle" x="483.77" y="-1282.3" font-family="Helvetica,sans-Serif" font-size="14.00">开始 createEmpty()</text>
</g>
<!-- validate_target -->
<g id="node2" class="node">
<title>validate_target</title>
<path fill="none" stroke="black" d="M562.27,-1231C562.27,-1231 405.27,-1231 405.27,-1231 399.27,-1231 393.27,-1225 393.27,-1219 393.27,-1219 393.27,-1207 393.27,-1207 393.27,-1201 399.27,-1195 405.27,-1195 405.27,-1195 562.27,-1195 562.27,-1195 568.27,-1195 574.27,-1201 574.27,-1207 574.27,-1207 574.27,-1219 574.27,-1219 574.27,-1225 568.27,-1231 562.27,-1231"/>
<text text-anchor="middle" x="483.77" y="-1209.3" font-family="Helvetica,sans-Serif" font-size="14.00">断言 target.ofmt == .elf</text>
</g>
<!-- start&#45;&gt;validate_target -->
<g id="edge1" class="edge">
<title>start&#45;&gt;validate_target</title>
<path fill="none" stroke="black" d="M483.77,-1267.81C483.77,-1259.79 483.77,-1250.05 483.77,-1241.07"/>
<polygon fill="black" stroke="black" points="487.27,-1241.03 483.77,-1231.03 480.27,-1241.03 487.27,-1241.03"/>
</g>
<!-- setup_config -->
<g id="node3" class="node">
<title>setup_config</title>
<path fill="none" stroke="black" d="M634.27,-1158C634.27,-1158 333.27,-1158 333.27,-1158 327.27,-1158 321.27,-1152 321.27,-1146 321.27,-1146 321.27,-1132 321.27,-1132 321.27,-1126 327.27,-1120 333.27,-1120 333.27,-1120 634.27,-1120 634.27,-1120 640.27,-1120 646.27,-1126 646.27,-1132 646.27,-1132 646.27,-1146 646.27,-1146 646.27,-1152 640.27,-1158 634.27,-1158"/>
<text text-anchor="middle" x="483.77" y="-1142.8" font-family="Helvetica,sans-Serif" font-size="14.00">设置配置选项</text>
<text text-anchor="middle" x="483.77" y="-1127.8" font-family="Helvetica,sans-Serif" font-size="14.00">(use_lld, use_llvm, output_mode, link_mode)</text>
</g>
<!-- validate_target&#45;&gt;setup_config -->
<g id="edge2" class="edge">
<title>validate_target&#45;&gt;setup_config</title>
<path fill="none" stroke="black" d="M483.77,-1194.94C483.77,-1186.99 483.77,-1177.31 483.77,-1168.31"/>
<polygon fill="black" stroke="black" points="487.27,-1168.2 483.77,-1158.2 480.27,-1168.2 487.27,-1168.2"/>
</g>
<!-- page_size_switch -->
<g id="node4" class="node">
<title>page_size_switch</title>
<path fill="none" stroke="black" d="M471.98,-1080.78C471.98,-1080.78 293.56,-1047.22 293.56,-1047.22 287.66,-1046.11 287.66,-1043.89 293.56,-1042.78 293.56,-1042.78 471.98,-1009.22 471.98,-1009.22 477.87,-1008.11 489.66,-1008.11 495.56,-1009.22 495.56,-1009.22 673.98,-1042.78 673.98,-1042.78 679.87,-1043.89 679.87,-1046.11 673.98,-1047.22 673.98,-1047.22 495.56,-1080.78 495.56,-1080.78 489.66,-1081.89 477.87,-1081.89 471.98,-1080.78"/>
<text text-anchor="middle" x="483.77" y="-1048.8" font-family="Helvetica,sans-Serif" font-size="14.00">根据目标架构设置 page_size</text>
<text text-anchor="middle" x="483.77" y="-1033.8" font-family="Helvetica,sans-Serif" font-size="14.00">（多分支 switch）</text>
</g>
<!-- setup_config&#45;&gt;page_size_switch -->
<g id="edge3" class="edge">
<title>setup_config&#45;&gt;page_size_switch</title>
<path fill="none" stroke="black" d="M483.77,-1119.82C483.77,-1112.13 483.77,-1102.78 483.77,-1093.35"/>
<polygon fill="black" stroke="black" points="487.27,-1093.16 483.77,-1083.16 480.27,-1093.16 487.27,-1093.16"/>
</g>
<!-- dynamic_lib_check -->
<g id="node5" class="node">
<title>dynamic_lib_check</title>
<path fill="none" stroke="black" d="M537.27,-970C537.27,-970 430.27,-970 430.27,-970 424.27,-970 418.27,-964 418.27,-958 418.27,-958 418.27,-944 418.27,-944 418.27,-938 424.27,-932 430.27,-932 430.27,-932 537.27,-932 537.27,-932 543.27,-932 549.27,-938 549.27,-944 549.27,-944 549.27,-958 549.27,-958 549.27,-964 543.27,-970 537.27,-970"/>
<text text-anchor="middle" x="483.77" y="-954.8" font-family="Helvetica,sans-Serif" font-size="14.00">检查是否为动态库</text>
<text text-anchor="middle" x="483.77" y="-939.8" font-family="Helvetica,sans-Serif" font-size="14.00">(is_dyn_lib)</text>
</g>
<!-- page_size_switch&#45;&gt;dynamic_lib_check -->
<g id="edge4" class="edge">
<title>page_size_switch&#45;&gt;dynamic_lib_check</title>
<path fill="none" stroke="black" d="M483.77,-1006.85C483.77,-997.94 483.77,-988.57 483.77,-980.15"/>
<polygon fill="black" stroke="black" points="487.27,-980.09 483.77,-970.09 480.27,-980.09 487.27,-980.09"/>
</g>
<!-- sym_version -->
<g id="node6" class="node">
<title>sym_version</title>
<path fill="none" stroke="black" d="M567.27,-895C567.27,-895 400.27,-895 400.27,-895 394.27,-895 388.27,-889 388.27,-883 388.27,-883 388.27,-871 388.27,-871 388.27,-865 394.27,-859 400.27,-859 400.27,-859 567.27,-859 567.27,-859 573.27,-859 579.27,-865 579.27,-871 579.27,-871 579.27,-883 579.27,-883 579.27,-889 573.27,-895 567.27,-895"/>
<text text-anchor="middle" x="483.77" y="-873.3" font-family="Helvetica,sans-Serif" font-size="14.00">设置 default_sym_version</text>
</g>
<!-- dynamic_lib_check&#45;&gt;sym_version -->
<g id="edge5" class="edge">
<title>dynamic_lib_check&#45;&gt;sym_version</title>
<path fill="none" stroke="black" d="M483.77,-931.83C483.77,-923.89 483.77,-914.41 483.77,-905.63"/>
<polygon fill="black" stroke="black" points="487.27,-905.42 483.77,-895.42 480.27,-905.42 487.27,-905.42"/>
</g>
<!-- create_rpath -->
<g id="node7" class="node">
<title>create_rpath</title>
<path fill="none" stroke="black" d="M535.27,-822C535.27,-822 432.27,-822 432.27,-822 426.27,-822 420.27,-816 420.27,-810 420.27,-810 420.27,-796 420.27,-796 420.27,-790 426.27,-784 432.27,-784 432.27,-784 535.27,-784 535.27,-784 541.27,-784 547.27,-790 547.27,-796 547.27,-796 547.27,-810 547.27,-810 547.27,-816 541.27,-822 535.27,-822"/>
<text text-anchor="middle" x="483.77" y="-806.8" font-family="Helvetica,sans-Serif" font-size="14.00">创建 rpath_table</text>
<text text-anchor="middle" x="483.77" y="-791.8" font-family="Helvetica,sans-Serif" font-size="14.00">并复制 entries</text>
</g>
<!-- sym_version&#45;&gt;create_rpath -->
<g id="edge6" class="edge">
<title>sym_version&#45;&gt;create_rpath</title>
<path fill="none" stroke="black" d="M483.77,-858.94C483.77,-850.99 483.77,-841.31 483.77,-832.31"/>
<polygon fill="black" stroke="black" points="487.27,-832.2 483.77,-822.2 480.27,-832.2 487.27,-832.2"/>
</g>
<!-- init_elf -->
<g id="node8" class="node">
<title>init_elf</title>
<path fill="none" stroke="black" d="M537.27,-747C537.27,-747 430.27,-747 430.27,-747 424.27,-747 418.27,-741 418.27,-735 418.27,-735 418.27,-721 418.27,-721 418.27,-715 424.27,-709 430.27,-709 430.27,-709 537.27,-709 537.27,-709 543.27,-709 549.27,-715 549.27,-721 549.27,-721 549.27,-735 549.27,-735 549.27,-741 543.27,-747 537.27,-747"/>
<text text-anchor="middle" x="483.77" y="-731.8" font-family="Helvetica,sans-Serif" font-size="14.00">初始化 Elf 结构体</text>
<text text-anchor="middle" x="483.77" y="-716.8" font-family="Helvetica,sans-Serif" font-size="14.00">填充所有配置参数</text>
</g>
<!-- create_rpath&#45;&gt;init_elf -->
<g id="edge7" class="edge">
<title>create_rpath&#45;&gt;init_elf</title>
<path fill="none" stroke="black" d="M483.77,-783.96C483.77,-775.88 483.77,-766.18 483.77,-757.18"/>
<polygon fill="black" stroke="black" points="487.27,-757.09 483.77,-747.09 480.27,-757.09 487.27,-757.09"/>
</g>
<!-- llvm_lld_handling -->
<g id="node9" class="node">
<title>llvm_lld_handling</title>
<path fill="none" stroke="black" d="M565.77,-672C565.77,-672 401.77,-672 401.77,-672 395.77,-672 389.77,-666 389.77,-660 389.77,-660 389.77,-646 389.77,-646 389.77,-640 395.77,-634 401.77,-634 401.77,-634 565.77,-634 565.77,-634 571.77,-634 577.77,-640 577.77,-646 577.77,-646 577.77,-660 577.77,-660 577.77,-666 571.77,-672 565.77,-672"/>
<text text-anchor="middle" x="483.77" y="-656.8" font-family="Helvetica,sans-Serif" font-size="14.00">处理 LLVM/LLD 路径</text>
<text text-anchor="middle" x="483.77" y="-641.8" font-family="Helvetica,sans-Serif" font-size="14.00">（zcu_object_sub_path）</text>
</g>
<!-- init_elf&#45;&gt;llvm_lld_handling -->
<g id="edge8" class="edge">
<title>init_elf&#45;&gt;llvm_lld_handling</title>
<path fill="none" stroke="black" d="M483.77,-708.96C483.77,-700.88 483.77,-691.18 483.77,-682.18"/>
<polygon fill="black" stroke="black" points="487.27,-682.09 483.77,-672.09 480.27,-682.09 487.27,-682.09"/>
</g>
<!-- create_file -->
<g id="node10" class="node">
<title>create_file</title>
<path fill="none" stroke="black" d="M523.77,-597C523.77,-597 443.77,-597 443.77,-597 437.77,-597 431.77,-591 431.77,-585 431.77,-585 431.77,-571 431.77,-571 431.77,-565 437.77,-559 443.77,-559 443.77,-559 523.77,-559 523.77,-559 529.77,-559 535.77,-565 535.77,-571 535.77,-571 535.77,-585 535.77,-585 535.77,-591 529.77,-597 523.77,-597"/>
<text text-anchor="middle" x="483.77" y="-581.8" font-family="Helvetica,sans-Serif" font-size="14.00">创建输出文件</text>
<text text-anchor="middle" x="483.77" y="-566.8" font-family="Helvetica,sans-Serif" font-size="14.00">（base.file）</text>
</g>
<!-- llvm_lld_handling&#45;&gt;create_file -->
<g id="edge9" class="edge">
<title>llvm_lld_handling&#45;&gt;create_file</title>
<path fill="none" stroke="black" d="M483.77,-633.96C483.77,-625.88 483.77,-616.18 483.77,-607.18"/>
<polygon fill="black" stroke="black" points="487.27,-607.09 483.77,-597.09 480.27,-607.09 487.27,-607.09"/>
</g>
<!-- errdefer -->
<g id="node11" class="node">
<title>errdefer</title>
<path fill="none" stroke="black" d="M543.77,-522C543.77,-522 423.77,-522 423.77,-522 417.77,-522 411.77,-516 411.77,-510 411.77,-510 411.77,-496 411.77,-496 411.77,-490 417.77,-484 423.77,-484 423.77,-484 543.77,-484 543.77,-484 549.77,-484 555.77,-490 555.77,-496 555.77,-496 555.77,-510 555.77,-510 555.77,-516 549.77,-522 543.77,-522"/>
<text text-anchor="middle" x="483.77" y="-506.8" font-family="Helvetica,sans-Serif" font-size="14.00">注册 errdefer</text>
<text text-anchor="middle" x="483.77" y="-491.8" font-family="Helvetica,sans-Serif" font-size="14.00">self.base.destroy()</text>
</g>
<!-- create_file&#45;&gt;errdefer -->
<g id="edge10" class="edge">
<title>create_file&#45;&gt;errdefer</title>
<path fill="none" stroke="black" d="M483.77,-558.96C483.77,-550.88 483.77,-541.18 483.77,-532.18"/>
<polygon fill="black" stroke="black" points="487.27,-532.09 483.77,-522.09 480.27,-532.09 487.27,-532.09"/>
</g>
<!-- handle_lld_llvm -->
<g id="node12" class="node">
<title>handle_lld_llvm</title>
<path fill="none" stroke="black" d="M471.82,-431.85C471.82,-431.85 309.03,-416.15 309.03,-416.15 303.06,-415.58 303.06,-414.42 309.03,-413.85 309.03,-413.85 471.82,-398.15 471.82,-398.15 477.8,-397.58 489.74,-397.58 495.71,-398.15 495.71,-398.15 658.5,-413.85 658.5,-413.85 664.47,-414.42 664.47,-415.58 658.5,-416.15 658.5,-416.15 495.71,-431.85 495.71,-431.85 489.74,-432.42 477.8,-432.42 471.82,-431.85"/>
<text text-anchor="middle" x="483.77" y="-411.3" font-family="Helvetica,sans-Serif" font-size="14.00">使用 LLD/LLVM 时的特殊处理</text>
</g>
<!-- errdefer&#45;&gt;handle_lld_llvm -->
<g id="edge11" class="edge">
<title>errdefer&#45;&gt;handle_lld_llvm</title>
<path fill="none" stroke="black" d="M483.77,-483.76C483.77,-471.93 483.77,-456.32 483.77,-443.05"/>
<polygon fill="black" stroke="black" points="487.27,-443.04 483.77,-433.04 480.27,-443.04 487.27,-443.04"/>
<text text-anchor="middle" x="603.27" y="-454.8" font-family="Helvetica,sans-Serif" font-size="14.00">use_lld &amp;&amp; (use_llvm || !have_zcu)</text>
</g>
<!-- verbose_link -->
<g id="node13" class="node">
<title>verbose_link</title>
<path fill="none" stroke="black" d="M448.77,-346C448.77,-346 326.77,-346 326.77,-346 320.77,-346 314.77,-340 314.77,-334 314.77,-334 314.77,-322 314.77,-322 314.77,-316 320.77,-310 326.77,-310 326.77,-310 448.77,-310 448.77,-310 454.77,-310 460.77,-316 460.77,-322 460.77,-322 460.77,-334 460.77,-334 460.77,-340 454.77,-346 448.77,-346"/>
<text text-anchor="middle" x="387.77" y="-324.3" font-family="Helvetica,sans-Serif" font-size="14.00">处理 &#45;&#45;verbose&#45;link</text>
</g>
<!-- handle_lld_llvm&#45;&gt;verbose_link -->
<g id="edge13" class="edge">
<title>handle_lld_llvm&#45;&gt;verbose_link</title>
<path fill="none" stroke="black" d="M466.16,-398.41C451.83,-385.72 431.37,-367.6 414.94,-353.06"/>
<polygon fill="black" stroke="black" points="417.05,-350.25 407.25,-346.25 412.41,-355.5 417.05,-350.25"/>
<text text-anchor="middle" x="455.27" y="-367.8" font-family="Helvetica,sans-Serif" font-size="14.00">否则</text>
</g>
<!-- return -->
<g id="node17" class="node">
<title>return</title>
<ellipse fill="none" stroke="black" cx="462.77" cy="-18" rx="47.39" ry="18"/>
<text text-anchor="middle" x="462.77" y="-14.3" font-family="Helvetica,sans-Serif" font-size="14.00">返回 self</text>
</g>
<!-- handle_lld_llvm&#45;&gt;return -->
<g id="edge12" class="edge">
<title>handle_lld_llvm&#45;&gt;return</title>
<path fill="none" stroke="black" d="M499.86,-398.36C514.48,-382.42 533.77,-356.22 533.77,-329 533.77,-329 533.77,-329 533.77,-91 533.77,-68.67 516.24,-50.76 498.61,-38.38"/>
<polygon fill="black" stroke="black" points="500.3,-35.31 490.02,-32.76 496.46,-41.16 500.3,-35.31"/>
<text text-anchor="middle" x="562.77" y="-207.8" font-family="Helvetica,sans-Serif" font-size="14.00">直接返回</text>
</g>
<!-- obj_or_ar_check -->
<g id="node14" class="node">
<title>obj_or_ar_check</title>
<path fill="none" stroke="black" d="M240.8,-272.15C240.8,-272.15 12.2,-255.85 12.2,-255.85 6.22,-255.43 6.22,-254.57 12.2,-254.15 12.2,-254.15 240.8,-237.85 240.8,-237.85 246.78,-237.43 258.75,-237.43 264.74,-237.85 264.74,-237.85 493.34,-254.15 493.34,-254.15 499.32,-254.57 499.32,-255.43 493.34,-255.85 493.34,-255.85 264.74,-272.15 264.74,-272.15 258.75,-272.57 246.78,-272.57 240.8,-272.15"/>
<text text-anchor="middle" x="252.77" y="-251.3" font-family="Helvetica,sans-Serif" font-size="14.00">检查 output_mode 是否为 Obj 或静态库</text>
</g>
<!-- verbose_link&#45;&gt;obj_or_ar_check -->
<g id="edge14" class="edge">
<title>verbose_link&#45;&gt;obj_or_ar_check</title>
<path fill="none" stroke="black" d="M355.43,-309.99C335.95,-299.75 311.05,-286.65 290.65,-275.92"/>
<polygon fill="black" stroke="black" points="292.11,-272.73 281.63,-271.18 288.85,-278.93 292.11,-272.73"/>
</g>
<!-- phdr_init -->
<g id="node15" class="node">
<title>phdr_init</title>
<path fill="none" stroke="black" d="M344.77,-186C344.77,-186 160.77,-186 160.77,-186 154.77,-186 148.77,-180 148.77,-174 148.77,-174 148.77,-160 148.77,-160 148.77,-154 154.77,-148 160.77,-148 160.77,-148 344.77,-148 344.77,-148 350.77,-148 356.77,-154 356.77,-160 356.77,-160 356.77,-174 356.77,-174 356.77,-180 350.77,-186 344.77,-186"/>
<text text-anchor="middle" x="252.77" y="-170.8" font-family="Helvetica,sans-Serif" font-size="14.00">初始化 PT_PHDR 和 PT_LOAD</text>
<text text-anchor="middle" x="252.77" y="-155.8" font-family="Helvetica,sans-Serif" font-size="14.00">程序头</text>
</g>
<!-- obj_or_ar_check&#45;&gt;phdr_init -->
<g id="edge15" class="edge">
<title>obj_or_ar_check&#45;&gt;phdr_init</title>
<path fill="none" stroke="black" d="M252.77,-236.6C252.77,-225.06 252.77,-209.65 252.77,-196.36"/>
<polygon fill="black" stroke="black" points="256.27,-196.27 252.77,-186.27 249.27,-196.27 256.27,-196.27"/>
<text text-anchor="middle" x="297.27" y="-207.8" font-family="Helvetica,sans-Serif" font-size="14.00">非 Obj/静态库</text>
</g>
<!-- zig_object_init -->
<g id="node16" class="node">
<title>zig_object_init</title>
<path fill="none" stroke="black" d="M446.27,-111C446.27,-111 339.27,-111 339.27,-111 333.27,-111 327.27,-105 327.27,-99 327.27,-99 327.27,-85 327.27,-85 327.27,-79 333.27,-73 339.27,-73 339.27,-73 446.27,-73 446.27,-73 452.27,-73 458.27,-79 458.27,-85 458.27,-85 458.27,-99 458.27,-99 458.27,-105 452.27,-111 446.27,-111"/>
<text text-anchor="middle" x="392.77" y="-95.8" font-family="Helvetica,sans-Serif" font-size="14.00">初始化 ZigObject</text>
<text text-anchor="middle" x="392.77" y="-80.8" font-family="Helvetica,sans-Serif" font-size="14.00">（非 LLVM 路径）</text>
</g>
<!-- obj_or_ar_check&#45;&gt;zig_object_init -->
<g id="edge16" class="edge">
<title>obj_or_ar_check&#45;&gt;zig_object_init</title>
<path fill="none" stroke="black" d="M306.23,-240.73C320.11,-235.54 334.35,-228.48 345.77,-219 375.04,-194.69 386.09,-150.26 390.26,-121.19"/>
<polygon fill="black" stroke="black" points="393.73,-121.59 391.5,-111.24 386.79,-120.72 393.73,-121.59"/>
<text text-anchor="middle" x="420.77" y="-163.3" font-family="Helvetica,sans-Serif" font-size="14.00">Obj/静态库</text>
</g>
<!-- phdr_init&#45;&gt;zig_object_init -->
<g id="edge17" class="edge">
<title>phdr_init&#45;&gt;zig_object_init</title>
<path fill="none" stroke="black" d="M287.37,-147.96C306.05,-138.22 329.29,-126.1 349.19,-115.72"/>
<polygon fill="black" stroke="black" points="350.83,-118.82 358.07,-111.09 347.59,-112.61 350.83,-118.82"/>
</g>
<!-- zig_object_init&#45;&gt;return -->
<g id="edge18" class="edge">
<title>zig_object_init&#45;&gt;return</title>
<path fill="none" stroke="black" d="M410.43,-72.83C419.34,-63.67 430.25,-52.44 439.8,-42.62"/>
<polygon fill="black" stroke="black" points="442.32,-45.05 446.79,-35.44 437.31,-40.17 442.32,-45.05"/>
</g>
</g>
</svg>
