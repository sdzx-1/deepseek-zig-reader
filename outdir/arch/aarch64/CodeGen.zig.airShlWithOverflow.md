flowchart TD
    A[开始] --> B{指令是否未使用?}
    B --> |是| C[返回.dead结果]
    B --> |否| D{操作数类型?}
    D --> |向量| E[返回错误:未实现向量]
    D --> |整数| F{整数位数≤64?}
    F --> |否| G[返回错误:不支持>64位]
    F --> |是| H[分配栈空间]
    H --> I{rhs是立即数?}
    I --> |是| J[分配寄存器，读取lhs]
    J --> K[生成lsl立即数指令]
    K --> L[截断寄存器]
    L --> M[生成asr/lsr立即数指令]
    I --> |否| N[分配寄存器，读取lhs和rhs]
    N --> O[生成lsl寄存器指令]
    O --> P[截断寄存器]
    P --> Q[生成asr/lsr寄存器指令]
    M --> R[比较lhs和重构值]
    Q --> R
    R --> S[存储结果到栈]
    S --> T[设置溢出标志位]
    T --> U[返回栈偏移结果]
    C --> V[结束]
    E --> V
    G --> V
    U --> V
