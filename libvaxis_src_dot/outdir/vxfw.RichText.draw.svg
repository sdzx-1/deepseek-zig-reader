<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="637pt" height="1151pt"
 viewBox="0.00 0.00 637.00 1151.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1147)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1147 633,-1147 633,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="none" stroke="black" cx="70" cy="-1125" rx="38.03" ry="18"/>
<text text-anchor="middle" x="70" y="-1122.5" font-family="Arial" font-size="10.00">开始 draw()</text>
</g>
<!-- check_ctx_width -->
<g id="node2" class="node">
<title>check_ctx_width</title>
<polygon fill="none" stroke="black" points="140,-1070 0,-1070 0,-1034 140,-1034 140,-1070"/>
<text text-anchor="middle" x="70" y="-1049.5" font-family="Arial" font-size="10.00">检查 ctx.max.width 是否为 0</text>
</g>
<!-- start&#45;&gt;check_ctx_width -->
<g id="edge1" class="edge">
<title>start&#45;&gt;check_ctx_width</title>
<path fill="none" stroke="black" d="M70,-1106.81C70,-1098.79 70,-1089.05 70,-1080.07"/>
<polygon fill="black" stroke="black" points="73.5,-1080.03 70,-1070.03 66.5,-1080.03 73.5,-1080.03"/>
</g>
<!-- return_empty_surface -->
<g id="node3" class="node">
<title>return_empty_surface</title>
<polygon fill="none" stroke="black" points="90,-933 8,-933 8,-897 90,-897 90,-933"/>
<text text-anchor="middle" x="49" y="-912.5" font-family="Arial" font-size="10.00">返回空 Surface</text>
</g>
<!-- check_ctx_width&#45;&gt;return_empty_surface -->
<g id="edge2" class="edge">
<title>check_ctx_width&#45;&gt;return_empty_surface</title>
<path fill="none" stroke="black" d="M67.34,-1033.9C63.79,-1011.1 57.47,-970.48 53.26,-943.39"/>
<polygon fill="black" stroke="black" points="56.7,-942.73 51.7,-933.39 49.78,-943.8 56.7,-942.73"/>
<text text-anchor="middle" x="70" y="-1008" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- init_softwrap_iter -->
<g id="node4" class="node">
<title>init_softwrap_iter</title>
<polygon fill="none" stroke="black" points="203,-987 85,-987 85,-951 203,-951 203,-987"/>
<text text-anchor="middle" x="144" y="-966.5" font-family="Arial" font-size="10.00">初始化 SoftwrapIterator</text>
</g>
<!-- check_ctx_width&#45;&gt;init_softwrap_iter -->
<g id="edge3" class="edge">
<title>check_ctx_width&#45;&gt;init_softwrap_iter</title>
<path fill="none" stroke="black" d="M85.69,-1033.82C96.09,-1022.44 109.9,-1007.33 121.47,-994.66"/>
<polygon fill="black" stroke="black" points="124.17,-996.9 128.33,-987.15 119,-992.18 124.17,-996.9"/>
<text text-anchor="middle" x="117" y="-1008" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- trim_surface -->
<g id="node11" class="node">
<title>trim_surface</title>
<ellipse fill="none" stroke="black" cx="349" cy="-330" rx="72.99" ry="18"/>
<text text-anchor="middle" x="349" y="-327.5" font-family="Arial" font-size="10.00">修剪 Surface 高度并返回</text>
</g>
<!-- return_empty_surface&#45;&gt;trim_surface -->
<!-- find_container_size -->
<g id="node5" class="node">
<title>find_container_size</title>
<polygon fill="none" stroke="black" points="251.5,-879 90.5,-879 90.5,-843 251.5,-843 251.5,-879"/>
<text text-anchor="middle" x="171" y="-858.5" font-family="Arial" font-size="10.00">计算容器大小 (findContainerSize)</text>
</g>
<!-- init_softwrap_iter&#45;&gt;find_container_size -->
<g id="edge4" class="edge">
<title>init_softwrap_iter&#45;&gt;find_container_size</title>
<path fill="none" stroke="black" d="M148.34,-950.97C152.58,-934.3 159.12,-908.65 164.08,-889.16"/>
<polygon fill="black" stroke="black" points="167.51,-889.9 166.58,-879.34 160.72,-888.17 167.51,-889.9"/>
</g>
<!-- create_surface -->
<g id="node6" class="node">
<title>create_surface</title>
<polygon fill="none" stroke="black" points="225,-806 153,-806 153,-770 225,-770 225,-806"/>
<text text-anchor="middle" x="189" y="-785.5" font-family="Arial" font-size="10.00">创建 Surface</text>
</g>
<!-- find_container_size&#45;&gt;create_surface -->
<g id="edge5" class="edge">
<title>find_container_size&#45;&gt;create_surface</title>
<path fill="none" stroke="black" d="M175.36,-842.81C177.41,-834.7 179.91,-824.84 182.21,-815.78"/>
<polygon fill="black" stroke="black" points="185.62,-816.58 184.68,-806.03 178.83,-814.86 185.62,-816.58"/>
</g>
<!-- fill_buffer -->
<g id="node7" class="node">
<title>fill_buffer</title>
<polygon fill="none" stroke="black" points="272,-733 144,-733 144,-697 272,-697 272,-733"/>
<text text-anchor="middle" x="208" y="-712.5" font-family="Arial" font-size="10.00">用 base_style 填充缓冲区</text>
</g>
<!-- create_surface&#45;&gt;fill_buffer -->
<g id="edge6" class="edge">
<title>create_surface&#45;&gt;fill_buffer</title>
<path fill="none" stroke="black" d="M193.6,-769.81C195.77,-761.7 198.41,-751.84 200.83,-742.78"/>
<polygon fill="black" stroke="black" points="204.24,-743.59 203.44,-733.03 197.48,-741.78 204.24,-743.59"/>
</g>
<!-- check_softwrap -->
<g id="node8" class="node">
<title>check_softwrap</title>
<polygon fill="none" stroke="black" points="241,-660 136.88,-642 241,-624 345.12,-642 241,-660"/>
<text text-anchor="middle" x="241" y="-639.5" font-family="Arial" font-size="10.00">self.softwrap 是否为真？</text>
</g>
<!-- fill_buffer&#45;&gt;check_softwrap -->
<g id="edge7" class="edge">
<title>fill_buffer&#45;&gt;check_softwrap</title>
<path fill="none" stroke="black" d="M215.99,-696.81C219.95,-688.28 224.82,-677.81 229.2,-668.38"/>
<polygon fill="black" stroke="black" points="232.5,-669.6 233.54,-659.06 226.15,-666.65 232.5,-669.6"/>
</g>
<!-- process_softwrap -->
<g id="node9" class="node">
<title>process_softwrap</title>
<polygon fill="none" stroke="black" points="273.5,-577 208.5,-577 208.5,-541 273.5,-541 273.5,-577"/>
<text text-anchor="middle" x="241" y="-556.5" font-family="Arial" font-size="10.00">处理软换行</text>
</g>
<!-- check_softwrap&#45;&gt;process_softwrap -->
<g id="edge8" class="edge">
<title>check_softwrap&#45;&gt;process_softwrap</title>
<path fill="none" stroke="black" d="M241,-623.82C241,-613.19 241,-599.31 241,-587.2"/>
<polygon fill="black" stroke="black" points="244.5,-587.15 241,-577.15 237.5,-587.15 244.5,-587.15"/>
<text text-anchor="middle" x="246" y="-598" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- process_hardbreak -->
<g id="node10" class="node">
<title>process_hardbreak</title>
<polygon fill="none" stroke="black" points="381.5,-577 316.5,-577 316.5,-541 381.5,-541 381.5,-577"/>
<text text-anchor="middle" x="349" y="-556.5" font-family="Arial" font-size="10.00">处理硬换行</text>
</g>
<!-- check_softwrap&#45;&gt;process_hardbreak -->
<g id="edge16" class="edge">
<title>check_softwrap&#45;&gt;process_hardbreak</title>
<path fill="none" stroke="black" d="M259.81,-626.89C275.92,-614.81 299.43,-597.18 318.27,-583.05"/>
<polygon fill="black" stroke="black" points="320.39,-585.84 326.29,-577.04 316.19,-580.24 320.39,-585.84"/>
<text text-anchor="middle" x="306" y="-598" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- process_softwrap&#45;&gt;trim_surface -->
<!-- softwrap_loop -->
<g id="node12" class="node">
<title>softwrap_loop</title>
<polygon fill="none" stroke="black" points="254,-504 138,-504 138,-468 254,-468 254,-504"/>
<text text-anchor="middle" x="196" y="-483.5" font-family="Arial" font-size="10.00">循环每一行 (iter.next())</text>
</g>
<!-- process_softwrap&#45;&gt;softwrap_loop -->
<g id="edge9" class="edge">
<title>process_softwrap&#45;&gt;softwrap_loop</title>
<path fill="none" stroke="black" d="M230.11,-540.81C224.75,-532.35 218.17,-521.98 212.23,-512.61"/>
<polygon fill="black" stroke="black" points="215.1,-510.6 206.79,-504.03 209.19,-514.35 215.1,-510.6"/>
</g>
<!-- process_hardbreak&#45;&gt;trim_surface -->
<!-- hardbreak_loop -->
<g id="node17" class="node">
<title>hardbreak_loop</title>
<polygon fill="none" stroke="black" points="549,-504 387,-504 387,-468 549,-468 549,-504"/>
<text text-anchor="middle" x="468" y="-483.5" font-family="Arial" font-size="10.00">循环每一行 (iter.nextHardBreak())</text>
</g>
<!-- process_hardbreak&#45;&gt;hardbreak_loop -->
<g id="edge17" class="edge">
<title>process_hardbreak&#45;&gt;hardbreak_loop</title>
<path fill="none" stroke="black" d="M377.5,-540.99C393.43,-531.49 413.47,-519.54 430.64,-509.29"/>
<polygon fill="black" stroke="black" points="432.52,-512.24 439.32,-504.11 428.94,-506.23 432.52,-512.24"/>
</g>
<!-- end -->
<g id="node25" class="node">
<title>end</title>
<ellipse fill="none" stroke="black" cx="349" cy="-247" rx="27" ry="18"/>
<text text-anchor="middle" x="349" y="-244.5" font-family="Arial" font-size="10.00">结束</text>
</g>
<!-- trim_surface&#45;&gt;end -->
<g id="edge31" class="edge">
<title>trim_surface&#45;&gt;end</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349,-311.82C349,-301.19 349,-287.31 349,-275.2"/>
<polygon fill="black" stroke="black" points="352.5,-275.15 349,-265.15 345.5,-275.15 352.5,-275.15"/>
<text text-anchor="middle" x="376.5" y="-286" font-family="Arial" font-size="10.00">返回 surface</text>
</g>
<!-- check_max_height_soft -->
<g id="node13" class="node">
<title>check_max_height_soft</title>
<polygon fill="none" stroke="black" points="196,-431 109.34,-413 196,-395 282.66,-413 196,-431"/>
<text text-anchor="middle" x="196" y="-410.5" font-family="Arial" font-size="10.00">是否超出最大高度？</text>
</g>
<!-- softwrap_loop&#45;&gt;check_max_height_soft -->
<g id="edge10" class="edge">
<title>softwrap_loop&#45;&gt;check_max_height_soft</title>
<path fill="none" stroke="black" d="M196,-467.81C196,-459.79 196,-450.05 196,-441.07"/>
<polygon fill="black" stroke="black" points="199.5,-441.03 196,-431.03 192.5,-441.03 199.5,-441.03"/>
</g>
<!-- check_max_height_soft&#45;&gt;trim_surface -->
<g id="edge11" class="edge">
<title>check_max_height_soft&#45;&gt;trim_surface</title>
<path fill="none" stroke="black" d="M219.24,-399.7C243.45,-386.88 281.8,-366.58 310.54,-351.36"/>
<polygon fill="black" stroke="black" points="312.3,-354.39 319.5,-346.62 309.03,-348.2 312.3,-354.39"/>
<text text-anchor="middle" x="286" y="-369" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- align_text_soft -->
<g id="node14" class="node">
<title>align_text_soft</title>
<polygon fill="none" stroke="black" points="258,-348 134,-348 134,-312 258,-312 258,-348"/>
<text text-anchor="middle" x="196" y="-327.5" font-family="Arial" font-size="10.00">根据对齐方式设置列位置</text>
</g>
<!-- check_max_height_soft&#45;&gt;align_text_soft -->
<g id="edge12" class="edge">
<title>check_max_height_soft&#45;&gt;align_text_soft</title>
<path fill="none" stroke="black" d="M196,-394.82C196,-384.19 196,-370.31 196,-358.2"/>
<polygon fill="black" stroke="black" points="199.5,-358.15 196,-348.15 192.5,-358.15 199.5,-358.15"/>
<text text-anchor="middle" x="201" y="-369" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- write_cells_soft -->
<g id="node15" class="node">
<title>write_cells_soft</title>
<polygon fill="none" stroke="black" points="229.5,-265 118.5,-265 118.5,-229 229.5,-229 229.5,-265"/>
<text text-anchor="middle" x="174" y="-244.5" font-family="Arial" font-size="10.00">写入单元格到 Surface</text>
</g>
<!-- align_text_soft&#45;&gt;write_cells_soft -->
<g id="edge13" class="edge">
<title>align_text_soft&#45;&gt;write_cells_soft</title>
<path fill="none" stroke="black" d="M191.33,-311.82C188.42,-301.08 184.6,-287.03 181.29,-274.84"/>
<polygon fill="black" stroke="black" points="184.66,-273.89 178.66,-265.15 177.9,-275.72 184.66,-273.89"/>
</g>
<!-- increment_row_soft -->
<g id="node16" class="node">
<title>increment_row_soft</title>
<polygon fill="none" stroke="black" points="164,-192 108,-192 108,-156 164,-156 164,-192"/>
<text text-anchor="middle" x="136" y="-171.5" font-family="Arial" font-size="10.00">row += 1</text>
</g>
<!-- write_cells_soft&#45;&gt;increment_row_soft -->
<g id="edge14" class="edge">
<title>write_cells_soft&#45;&gt;increment_row_soft</title>
<path fill="none" stroke="black" d="M164.8,-228.81C160.32,-220.44 154.84,-210.2 149.86,-200.9"/>
<polygon fill="black" stroke="black" points="152.92,-199.19 145.11,-192.03 146.75,-202.5 152.92,-199.19"/>
</g>
<!-- increment_row_soft&#45;&gt;softwrap_loop -->
<g id="edge15" class="edge">
<title>increment_row_soft&#45;&gt;softwrap_loop</title>
<path fill="none" stroke="black" d="M109.51,-192.15C93.44,-204.84 76,-223.73 76,-246 76,-414 76,-414 76,-414 76,-442.26 100.95,-459.51 128.1,-469.91"/>
<polygon fill="black" stroke="black" points="127.16,-473.29 137.76,-473.32 129.49,-466.69 127.16,-473.29"/>
<text text-anchor="middle" x="96" y="-327.5" font-family="Arial" font-size="10.00">继续循环</text>
</g>
<!-- check_max_height_hard -->
<g id="node18" class="node">
<title>check_max_height_hard</title>
<polygon fill="none" stroke="black" points="468,-431 381.34,-413 468,-395 554.66,-413 468,-431"/>
<text text-anchor="middle" x="468" y="-410.5" font-family="Arial" font-size="10.00">是否超出最大高度？</text>
</g>
<!-- hardbreak_loop&#45;&gt;check_max_height_hard -->
<g id="edge18" class="edge">
<title>hardbreak_loop&#45;&gt;check_max_height_hard</title>
<path fill="none" stroke="black" d="M468,-467.81C468,-459.79 468,-450.05 468,-441.07"/>
<polygon fill="black" stroke="black" points="471.5,-441.03 468,-431.03 464.5,-441.03 471.5,-441.03"/>
</g>
<!-- check_max_height_hard&#45;&gt;trim_surface -->
<g id="edge19" class="edge">
<title>check_max_height_hard&#45;&gt;trim_surface</title>
<path fill="none" stroke="black" d="M448.62,-398.81C430.44,-386.43 402.92,-367.7 381.4,-353.06"/>
<polygon fill="black" stroke="black" points="383.13,-350 372.89,-347.26 379.19,-355.78 383.13,-350"/>
<text text-anchor="middle" x="420" y="-369" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- calculate_line_width -->
<g id="node19" class="node">
<title>calculate_line_width</title>
<polygon fill="none" stroke="black" points="504.5,-348 439.5,-348 439.5,-312 504.5,-312 504.5,-348"/>
<text text-anchor="middle" x="472" y="-327.5" font-family="Arial" font-size="10.00">计算行宽度</text>
</g>
<!-- check_max_height_hard&#45;&gt;calculate_line_width -->
<g id="edge20" class="edge">
<title>check_max_height_hard&#45;&gt;calculate_line_width</title>
<path fill="none" stroke="black" d="M468.85,-394.82C469.37,-384.19 470.06,-370.31 470.66,-358.2"/>
<polygon fill="black" stroke="black" points="474.16,-358.31 471.15,-348.15 467.16,-357.97 474.16,-358.31"/>
<text text-anchor="middle" x="475" y="-369" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- align_text_hard -->
<g id="node20" class="node">
<title>align_text_hard</title>
<polygon fill="none" stroke="black" points="523,-265 399,-265 399,-229 523,-229 523,-265"/>
<text text-anchor="middle" x="461" y="-244.5" font-family="Arial" font-size="10.00">根据对齐方式设置列位置</text>
</g>
<!-- calculate_line_width&#45;&gt;align_text_hard -->
<g id="edge21" class="edge">
<title>calculate_line_width&#45;&gt;align_text_hard</title>
<path fill="none" stroke="black" d="M469.67,-311.82C468.22,-301.19 466.34,-287.31 464.69,-275.2"/>
<polygon fill="black" stroke="black" points="468.14,-274.59 463.33,-265.15 461.21,-275.53 468.14,-274.59"/>
</g>
<!-- check_overflow -->
<g id="node21" class="node">
<title>check_overflow</title>
<polygon fill="none" stroke="black" points="458,-192 354.54,-174 458,-156 561.46,-174 458,-192"/>
<text text-anchor="middle" x="458" y="-171.5" font-family="Arial" font-size="10.00">是否溢出且需要省略号？</text>
</g>
<!-- align_text_hard&#45;&gt;check_overflow -->
<g id="edge22" class="edge">
<title>align_text_hard&#45;&gt;check_overflow</title>
<path fill="none" stroke="black" d="M460.27,-228.81C459.93,-220.79 459.52,-211.05 459.14,-202.07"/>
<polygon fill="black" stroke="black" points="462.64,-201.87 458.72,-192.03 455.64,-202.17 462.64,-201.87"/>
</g>
<!-- write_ellipsis -->
<g id="node22" class="node">
<title>write_ellipsis</title>
<polygon fill="none" stroke="black" points="560.5,-109 495.5,-109 495.5,-73 560.5,-73 560.5,-109"/>
<text text-anchor="middle" x="528" y="-88.5" font-family="Arial" font-size="10.00">写入省略号</text>
</g>
<!-- check_overflow&#45;&gt;write_ellipsis -->
<g id="edge23" class="edge">
<title>check_overflow&#45;&gt;write_ellipsis</title>
<path fill="none" stroke="black" d="M470.84,-158.14C480.87,-146.54 495.02,-130.16 506.74,-116.6"/>
<polygon fill="black" stroke="black" points="509.41,-118.86 513.3,-109 504.12,-114.28 509.41,-118.86"/>
<text text-anchor="middle" x="502" y="-130" font-family="Arial" font-size="10.00">是</text>
</g>
<!-- write_cell_hard -->
<g id="node23" class="node">
<title>write_cell_hard</title>
<polygon fill="none" stroke="black" points="477.5,-109 412.5,-109 412.5,-73 477.5,-73 477.5,-109"/>
<text text-anchor="middle" x="445" y="-88.5" font-family="Arial" font-size="10.00">写入单元格</text>
</g>
<!-- check_overflow&#45;&gt;write_cell_hard -->
<g id="edge24" class="edge">
<title>check_overflow&#45;&gt;write_cell_hard</title>
<path fill="none" stroke="black" d="M455.31,-156.22C453.59,-145.54 451.33,-131.46 449.37,-119.21"/>
<polygon fill="black" stroke="black" points="452.78,-118.36 447.73,-109.04 445.86,-119.47 452.78,-118.36"/>
<text text-anchor="middle" x="457" y="-130" font-family="Arial" font-size="10.00">否</text>
</g>
<!-- increment_row_hard -->
<g id="node24" class="node">
<title>increment_row_hard</title>
<polygon fill="none" stroke="black" points="556,-36 500,-36 500,0 556,0 556,-36"/>
<text text-anchor="middle" x="528" y="-15.5" font-family="Arial" font-size="10.00">row += 1</text>
</g>
<!-- write_ellipsis&#45;&gt;increment_row_hard -->
<g id="edge25" class="edge">
<title>write_ellipsis&#45;&gt;increment_row_hard</title>
<path fill="none" stroke="black" d="M528,-72.81C528,-64.79 528,-55.05 528,-46.07"/>
<polygon fill="black" stroke="black" points="531.5,-46.03 528,-36.03 524.5,-46.03 531.5,-46.03"/>
</g>
<!-- write_cell_hard&#45;&gt;increment_row_hard -->
<g id="edge26" class="edge">
<title>write_cell_hard&#45;&gt;increment_row_hard</title>
<path fill="none" stroke="black" d="M465.09,-72.81C475.69,-63.74 488.87,-52.48 500.41,-42.6"/>
<polygon fill="black" stroke="black" points="502.77,-45.19 508.09,-36.03 498.22,-39.87 502.77,-45.19"/>
</g>
<!-- increment_row_hard&#45;&gt;hardbreak_loop -->
<g id="edge27" class="edge">
<title>increment_row_hard&#45;&gt;hardbreak_loop</title>
<path fill="none" stroke="black" d="M554.93,-36.05C571.27,-48.69 589,-67.57 589,-90 589,-414 589,-414 589,-414 589,-437.23 572.21,-453.01 551.13,-463.66"/>
<polygon fill="black" stroke="black" points="549.49,-460.56 541.87,-467.91 552.42,-466.92 549.49,-460.56"/>
<text text-anchor="middle" x="609" y="-244.5" font-family="Arial" font-size="10.00">继续循环</text>
</g>
</g>
</svg>
