<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="741pt" height="1576pt"
 viewBox="0.00 0.00 740.50 1576.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1572)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1572 736.5,-1572 736.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<polygon fill="none" stroke="black" points="206.5,-1568 104.5,-1568 104.5,-1532 206.5,-1532 206.5,-1568"/>
<text text-anchor="middle" x="155.5" y="-1547.5" font-family="Courier,monospace" font-size="10.00">generate() 入口</text>
</g>
<!-- init_vars -->
<g id="node2" class="node">
<title>init_vars</title>
<polygon fill="none" stroke="black" points="311,-1495 0,-1495 0,-1459 311,-1459 311,-1495"/>
<text text-anchor="middle" x="155.5" y="-1474.5" font-family="Courier,monospace" font-size="10.00">初始化变量 (zcu, comp, gpa, ip, func, fn_type, mod)</text>
</g>
<!-- start&#45;&gt;init_vars -->
<g id="edge1" class="edge">
<title>start&#45;&gt;init_vars</title>
<path fill="none" stroke="black" d="M155.5,-1531.81C155.5,-1523.79 155.5,-1514.05 155.5,-1505.07"/>
<polygon fill="black" stroke="black" points="159,-1505.03 155.5,-1495.03 152,-1505.03 159,-1505.03"/>
</g>
<!-- create_function_struct -->
<g id="node3" class="node">
<title>create_function_struct</title>
<polygon fill="none" stroke="black" points="218,-1422 93,-1422 93,-1386 218,-1386 218,-1422"/>
<text text-anchor="middle" x="155.5" y="-1401.5" font-family="Courier,monospace" font-size="10.00">创建 function 结构体</text>
</g>
<!-- init_vars&#45;&gt;create_function_struct -->
<g id="edge2" class="edge">
<title>init_vars&#45;&gt;create_function_struct</title>
<path fill="none" stroke="black" d="M155.5,-1458.81C155.5,-1450.79 155.5,-1441.05 155.5,-1432.07"/>
<polygon fill="black" stroke="black" points="159,-1432.03 155.5,-1422.03 152,-1432.03 159,-1432.03"/>
</g>
<!-- defer_cleanup -->
<g id="node4" class="node">
<title>defer_cleanup</title>
<polygon fill="none" stroke="black" points="404.5,-109 108.5,-109 108.5,-73 404.5,-73 404.5,-109"/>
<text text-anchor="middle" x="256.5" y="-88.5" font-family="Courier,monospace" font-size="10.00">defer 块：资源释放（frame_allocs, blocks, mir 等）</text>
</g>
<!-- create_function_struct&#45;&gt;defer_cleanup -->
<g id="edge3" class="edge">
<title>create_function_struct&#45;&gt;defer_cleanup</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M150.96,-1385.92C147.57,-1371.62 143.5,-1350.63 143.5,-1332 143.5,-1332 143.5,-1332 143.5,-163 143.5,-139.99 160.51,-124.15 181.32,-113.37"/>
<polygon fill="black" stroke="black" points="182.9,-116.5 190.44,-109.06 179.9,-110.17 182.9,-116.5"/>
<text text-anchor="middle" x="165" y="-772.5" font-family="Courier,monospace" font-size="10.00">(defer)</text>
</g>
<!-- inst_tracking_setup -->
<g id="node5" class="node">
<title>inst_tracking_setup</title>
<polygon fill="none" stroke="black" points="391,-1349 188,-1349 188,-1313 391,-1313 391,-1349"/>
<text text-anchor="middle" x="289.5" y="-1328.5" font-family="Courier,monospace" font-size="10.00">初始化 inst_tracking 容量和临时索引</text>
</g>
<!-- create_function_struct&#45;&gt;inst_tracking_setup -->
<g id="edge4" class="edge">
<title>create_function_struct&#45;&gt;inst_tracking_setup</title>
<path fill="none" stroke="black" d="M187.6,-1385.99C205.78,-1376.36 228.72,-1364.21 248.22,-1353.87"/>
<polygon fill="black" stroke="black" points="250,-1356.89 257.2,-1349.11 246.73,-1350.7 250,-1356.89"/>
</g>
<!-- end -->
<g id="node23" class="node">
<title>end</title>
<polygon fill="none" stroke="black" points="283.5,-36 229.5,-36 229.5,0 283.5,0 283.5,-36"/>
<text text-anchor="middle" x="256.5" y="-15.5" font-family="Courier,monospace" font-size="10.00">end</text>
</g>
<!-- defer_cleanup&#45;&gt;end -->
<!-- wip_mir_log -->
<g id="node6" class="node">
<title>wip_mir_log</title>
<polygon fill="none" stroke="black" points="353,-1276 246,-1276 246,-1240 353,-1240 353,-1276"/>
<text text-anchor="middle" x="299.5" y="-1255.5" font-family="Courier,monospace" font-size="10.00">记录 wip_mir_log</text>
</g>
<!-- inst_tracking_setup&#45;&gt;wip_mir_log -->
<g id="edge5" class="edge">
<title>inst_tracking_setup&#45;&gt;wip_mir_log</title>
<path fill="none" stroke="black" d="M291.92,-1312.81C293.05,-1304.79 294.42,-1295.05 295.69,-1286.07"/>
<polygon fill="black" stroke="black" points="299.17,-1286.42 297.1,-1276.03 292.24,-1285.44 299.17,-1286.42"/>
</g>
<!-- frame_allocs_init -->
<g id="node7" class="node">
<title>frame_allocs_init</title>
<polygon fill="none" stroke="black" points="441,-1203 172,-1203 172,-1167 441,-1167 441,-1203"/>
<text text-anchor="middle" x="306.5" y="-1182.5" font-family="Courier,monospace" font-size="10.00">设置 frame_allocs (stack_frame, call_frame)</text>
</g>
<!-- wip_mir_log&#45;&gt;frame_allocs_init -->
<g id="edge6" class="edge">
<title>wip_mir_log&#45;&gt;frame_allocs_init</title>
<path fill="none" stroke="black" d="M301.19,-1239.81C301.99,-1231.79 302.95,-1222.05 303.83,-1213.07"/>
<polygon fill="black" stroke="black" points="307.32,-1213.32 304.82,-1203.03 300.36,-1212.64 307.32,-1213.32"/>
</g>
<!-- resolve_cc_values -->
<g id="node8" class="node">
<title>resolve_cc_values</title>
<polygon fill="none" stroke="black" points="423,-1130 190,-1130 190,-1094 423,-1094 423,-1130"/>
<text text-anchor="middle" x="306.5" y="-1109.5" font-family="Courier,monospace" font-size="10.00">调用 resolveCallingConventionValues()</text>
</g>
<!-- frame_allocs_init&#45;&gt;resolve_cc_values -->
<g id="edge7" class="edge">
<title>frame_allocs_init&#45;&gt;resolve_cc_values</title>
<path fill="none" stroke="black" d="M306.5,-1166.81C306.5,-1158.79 306.5,-1149.05 306.5,-1140.07"/>
<polygon fill="black" stroke="black" points="310,-1140.03 306.5,-1130.03 303,-1140.03 310,-1140.03"/>
</g>
<!-- resolve_cc_error -->
<g id="node9" class="node">
<title>resolve_cc_error</title>
<polygon fill="none" stroke="black" points="364.5,-993 158.5,-993 158.5,-957 364.5,-957 364.5,-993"/>
<text text-anchor="middle" x="261.5" y="-972.5" font-family="Courier,monospace" font-size="10.00">错误处理：CodegenFail 或其他错误返回</text>
</g>
<!-- resolve_cc_values&#45;&gt;resolve_cc_error -->
<g id="edge8" class="edge">
<title>resolve_cc_values&#45;&gt;resolve_cc_error</title>
<path fill="none" stroke="black" d="M299.25,-1093.78C293.99,-1081 286.88,-1063.06 281.5,-1047 276.68,-1032.63 272.04,-1016.37 268.45,-1003.04"/>
<polygon fill="black" stroke="black" points="271.75,-1001.84 265.81,-993.07 264.99,-1003.63 271.75,-1001.84"/>
<text text-anchor="middle" x="311.5" y="-1068" font-family="Courier,monospace" font-size="10.00">错误分支</text>
</g>
<!-- setup_args_ret -->
<g id="node10" class="node">
<title>setup_args_ret</title>
<polygon fill="none" stroke="black" points="523,-1047 290,-1047 290,-1011 523,-1011 523,-1047"/>
<text text-anchor="middle" x="406.5" y="-1026.5" font-family="Courier,monospace" font-size="10.00">配置 args, ret_mcv, err_ret_trace_reg</text>
</g>
<!-- resolve_cc_values&#45;&gt;setup_args_ret -->
<g id="edge9" class="edge">
<title>resolve_cc_values&#45;&gt;setup_args_ret</title>
<path fill="none" stroke="black" d="M327.71,-1093.82C342.16,-1082.12 361.48,-1066.47 377.37,-1053.6"/>
<polygon fill="black" stroke="black" points="379.76,-1056.17 385.32,-1047.15 375.35,-1050.73 379.76,-1056.17"/>
<text text-anchor="middle" x="371.5" y="-1068" font-family="Courier,monospace" font-size="10.00">成功</text>
</g>
<!-- resolve_cc_error&#45;&gt;defer_cleanup -->
<g id="edge25" class="edge">
<title>resolve_cc_error&#45;&gt;defer_cleanup</title>
<path fill="none" stroke="black" d="M247.42,-956.78C234.88,-939.66 218.5,-912.11 218.5,-885 218.5,-885 218.5,-885 218.5,-163 218.5,-146.53 226.55,-130.18 235.24,-117.33"/>
<polygon fill="black" stroke="black" points="238.22,-119.18 241.26,-109.04 232.55,-115.07 238.22,-119.18"/>
</g>
<!-- frame_allocs_config -->
<g id="node11" class="node">
<title>frame_allocs_config</title>
<polygon fill="none" stroke="black" points="562,-939 251,-939 251,-903 562,-903 562,-939"/>
<text text-anchor="middle" x="406.5" y="-918.5" font-family="Courier,monospace" font-size="10.00">设置 frame_allocs (ret_addr, base_ptr, args_frame)</text>
</g>
<!-- setup_args_ret&#45;&gt;frame_allocs_config -->
<g id="edge10" class="edge">
<title>setup_args_ret&#45;&gt;frame_allocs_config</title>
<path fill="none" stroke="black" d="M406.5,-1010.97C406.5,-994.38 406.5,-968.88 406.5,-949.43"/>
<polygon fill="black" stroke="black" points="410,-949.34 406.5,-939.34 403,-949.34 410,-949.34"/>
</g>
<!-- va_info_config -->
<g id="node12" class="node">
<title>va_info_config</title>
<polygon fill="none" stroke="black" points="552.5,-866 260.5,-866 260.5,-830 552.5,-830 552.5,-866"/>
<text text-anchor="middle" x="406.5" y="-845.5" font-family="Courier,monospace" font-size="10.00">根据调用约定配置 va_info (x86_64_sysv/x86_64_win)</text>
</g>
<!-- frame_allocs_config&#45;&gt;va_info_config -->
<g id="edge11" class="edge">
<title>frame_allocs_config&#45;&gt;va_info_config</title>
<path fill="none" stroke="black" d="M406.5,-902.81C406.5,-894.79 406.5,-885.05 406.5,-876.07"/>
<polygon fill="black" stroke="black" points="410,-876.03 406.5,-866.03 403,-876.03 410,-876.03"/>
</g>
<!-- err_ret_trace_reg_check -->
<g id="node13" class="node">
<title>err_ret_trace_reg_check</title>
<polygon fill="none" stroke="black" points="406.5,-793 257.47,-775 406.5,-757 555.53,-775 406.5,-793"/>
<text text-anchor="middle" x="406.5" y="-772.5" font-family="Courier,monospace" font-size="10.00">err_ret_trace_reg != .none?</text>
</g>
<!-- va_info_config&#45;&gt;err_ret_trace_reg_check -->
<g id="edge12" class="edge">
<title>va_info_config&#45;&gt;err_ret_trace_reg_check</title>
<path fill="none" stroke="black" d="M406.5,-829.81C406.5,-821.79 406.5,-812.05 406.5,-803.07"/>
<polygon fill="black" stroke="black" points="410,-803.03 406.5,-793.03 403,-803.03 410,-803.03"/>
</g>
<!-- reg_save -->
<g id="node14" class="node">
<title>reg_save</title>
<polygon fill="none" stroke="black" points="425.5,-710 267.5,-710 267.5,-674 425.5,-674 425.5,-710"/>
<text text-anchor="middle" x="346.5" y="-689.5" font-family="Courier,monospace" font-size="10.00">保存寄存器到 inst_tracking</text>
</g>
<!-- err_ret_trace_reg_check&#45;&gt;reg_save -->
<g id="edge13" class="edge">
<title>err_ret_trace_reg_check&#45;&gt;reg_save</title>
<path fill="none" stroke="black" d="M394.93,-758.38C386.55,-747.07 375.04,-731.53 365.34,-718.43"/>
<polygon fill="black" stroke="black" points="368.04,-716.2 359.28,-710.25 362.42,-720.37 368.04,-716.2"/>
<text text-anchor="middle" x="384.5" y="-731" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- gen_call -->
<g id="node15" class="node">
<title>gen_call</title>
<polygon fill="none" stroke="black" points="506.5,-637 390.5,-637 390.5,-601 506.5,-601 506.5,-637"/>
<text text-anchor="middle" x="448.5" y="-616.5" font-family="Courier,monospace" font-size="10.00">调用 gen() 生成代码</text>
</g>
<!-- err_ret_trace_reg_check&#45;&gt;gen_call -->
<g id="edge14" class="edge">
<title>err_ret_trace_reg_check&#45;&gt;gen_call</title>
<path fill="none" stroke="black" d="M414.95,-757.86C421.25,-745.17 429.58,-726.88 434.5,-710 440.5,-689.41 444.07,-665.38 446.1,-647.33"/>
<polygon fill="black" stroke="black" points="449.6,-647.51 447.15,-637.21 442.64,-646.79 449.6,-647.51"/>
<text text-anchor="middle" x="446.5" y="-689.5" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- reg_save&#45;&gt;gen_call -->
<g id="edge15" class="edge">
<title>reg_save&#45;&gt;gen_call</title>
<path fill="none" stroke="black" d="M370.93,-673.99C384.33,-664.67 401.13,-652.97 415.66,-642.86"/>
<polygon fill="black" stroke="black" points="417.71,-645.7 423.91,-637.11 413.71,-639.95 417.71,-645.7"/>
</g>
<!-- gen_error -->
<g id="node16" class="node">
<title>gen_error</title>
<polygon fill="none" stroke="black" points="499.5,-500 233.5,-500 233.5,-464 499.5,-464 499.5,-500"/>
<text text-anchor="middle" x="366.5" y="-479.5" font-family="Courier,monospace" font-size="10.00">错误处理：CodegenFail/OutOfRegisters/其他错误</text>
</g>
<!-- gen_call&#45;&gt;gen_error -->
<g id="edge16" class="edge">
<title>gen_call&#45;&gt;gen_error</title>
<path fill="none" stroke="black" d="M434.5,-600.94C430.14,-595.36 425.45,-589.03 421.5,-583 405.66,-558.82 390.01,-529.72 379.48,-509.16"/>
<polygon fill="black" stroke="black" points="382.52,-507.43 374.88,-500.09 376.28,-510.6 382.52,-507.43"/>
<text text-anchor="middle" x="441.5" y="-575" font-family="Courier,monospace" font-size="10.00">错误分支</text>
</g>
<!-- create_mir -->
<g id="node17" class="node">
<title>create_mir</title>
<polygon fill="none" stroke="black" points="554.5,-554 420.5,-554 420.5,-518 554.5,-518 554.5,-554"/>
<text text-anchor="middle" x="487.5" y="-533.5" font-family="Courier,monospace" font-size="10.00">创建 Mir 结构体并初始化</text>
</g>
<!-- gen_call&#45;&gt;create_mir -->
<g id="edge17" class="edge">
<title>gen_call&#45;&gt;create_mir</title>
<path fill="none" stroke="black" d="M456.77,-600.82C461.99,-589.98 468.85,-575.74 474.75,-563.47"/>
<polygon fill="black" stroke="black" points="478.06,-564.68 479.24,-554.15 471.75,-561.64 478.06,-564.68"/>
<text text-anchor="middle" x="479.5" y="-575" font-family="Courier,monospace" font-size="10.00">成功</text>
</g>
<!-- gen_error&#45;&gt;defer_cleanup -->
<g id="edge26" class="edge">
<title>gen_error&#45;&gt;defer_cleanup</title>
<path fill="none" stroke="black" d="M319.21,-463.92C289.4,-449.78 256.5,-426.39 256.5,-392 256.5,-392 256.5,-392 256.5,-163 256.5,-148.65 256.5,-132.67 256.5,-119.51"/>
<polygon fill="black" stroke="black" points="260,-119.22 256.5,-109.22 253,-119.22 260,-119.22"/>
</g>
<!-- create_emit -->
<g id="node18" class="node">
<title>create_emit</title>
<polygon fill="none" stroke="black" points="584.5,-446 444.5,-446 444.5,-410 584.5,-410 584.5,-446"/>
<text text-anchor="middle" x="514.5" y="-425.5" font-family="Courier,monospace" font-size="10.00">创建 Emit 结构体并初始化</text>
</g>
<!-- create_mir&#45;&gt;create_emit -->
<g id="edge18" class="edge">
<title>create_mir&#45;&gt;create_emit</title>
<path fill="none" stroke="black" d="M494.54,-517.74C496.65,-512.14 498.84,-505.86 500.5,-500 504.54,-485.69 507.84,-469.43 510.21,-456.09"/>
<polygon fill="black" stroke="black" points="513.69,-456.56 511.92,-446.11 506.79,-455.38 513.69,-456.56"/>
</g>
<!-- emit_mir -->
<g id="node19" class="node">
<title>emit_mir</title>
<polygon fill="none" stroke="black" points="562,-373 467,-373 467,-337 562,-337 562,-373"/>
<text text-anchor="middle" x="514.5" y="-352.5" font-family="Courier,monospace" font-size="10.00">调用 emitMir()</text>
</g>
<!-- create_emit&#45;&gt;emit_mir -->
<g id="edge19" class="edge">
<title>create_emit&#45;&gt;emit_mir</title>
<path fill="none" stroke="black" d="M514.5,-409.81C514.5,-401.79 514.5,-392.05 514.5,-383.07"/>
<polygon fill="black" stroke="black" points="518,-383.03 514.5,-373.03 511,-383.03 518,-383.03"/>
</g>
<!-- emit_errors -->
<g id="node20" class="node">
<title>emit_errors</title>
<polygon fill="none" stroke="black" points="444.5,-290 382.13,-272 444.5,-254 506.87,-272 444.5,-290"/>
<text text-anchor="middle" x="444.5" y="-269.5" font-family="Courier,monospace" font-size="10.00">错误类型判断</text>
</g>
<!-- emit_mir&#45;&gt;emit_errors -->
<g id="edge20" class="edge">
<title>emit_mir&#45;&gt;emit_errors</title>
<path fill="none" stroke="black" d="M499.65,-336.82C488.95,-324.44 474.44,-307.64 462.98,-294.39"/>
<polygon fill="black" stroke="black" points="465.5,-291.94 456.31,-286.67 460.2,-296.52 465.5,-291.94"/>
<text text-anchor="middle" x="503.5" y="-311" font-family="Courier,monospace" font-size="10.00">错误分支</text>
</g>
<!-- success -->
<g id="node22" class="node">
<title>success</title>
<polygon fill="none" stroke="black" points="732.5,-236 676.5,-236 676.5,-200 732.5,-200 732.5,-236"/>
<text text-anchor="middle" x="704.5" y="-215.5" font-family="Courier,monospace" font-size="10.00">成功返回</text>
</g>
<!-- emit_mir&#45;&gt;success -->
<g id="edge24" class="edge">
<title>emit_mir&#45;&gt;success</title>
<path fill="none" stroke="black" d="M538.56,-336.9C572.45,-312.83 634.31,-268.87 672.17,-241.97"/>
<polygon fill="black" stroke="black" points="674.21,-244.82 680.33,-236.17 670.15,-239.11 674.21,-244.82"/>
<text text-anchor="middle" x="586.5" y="-311" font-family="Courier,monospace" font-size="10.00">成功</text>
</g>
<!-- error_handling -->
<g id="node21" class="node">
<title>error_handling</title>
<polygon fill="none" stroke="black" points="445.5,-182 321.5,-182 321.5,-146 445.5,-146 445.5,-182"/>
<text text-anchor="middle" x="383.5" y="-161.5" font-family="Courier,monospace" font-size="10.00">处理错误并返回相应信息</text>
</g>
<!-- emit_errors&#45;&gt;error_handling -->
<g id="edge21" class="edge">
<title>emit_errors&#45;&gt;error_handling</title>
<path fill="none" stroke="black" d="M399.63,-266.94C359.16,-262.23 303.97,-252.87 290.5,-236 280.52,-223.5 281.39,-213.16 290.5,-200 296.04,-192 303.65,-185.82 312.15,-181.06"/>
<polygon fill="black" stroke="black" points="313.85,-184.13 321.29,-176.59 310.77,-177.84 313.85,-184.13"/>
<text text-anchor="middle" x="345" y="-215.5" font-family="Courier,monospace" font-size="10.00">LowerFail/EmitFail</text>
</g>
<!-- emit_errors&#45;&gt;error_handling -->
<g id="edge22" class="edge">
<title>emit_errors&#45;&gt;error_handling</title>
<path fill="none" stroke="black" d="M435.1,-256.47C431.13,-250.22 426.5,-242.8 422.5,-236 413.89,-221.37 404.73,-204.75 397.45,-191.27"/>
<polygon fill="black" stroke="black" points="400.34,-189.24 392.52,-182.09 394.17,-192.55 400.34,-189.24"/>
<text text-anchor="middle" x="516" y="-215.5" font-family="Courier,monospace" font-size="10.00">InvalidInstruction/CannotEncode</text>
</g>
<!-- emit_errors&#45;&gt;error_handling -->
<g id="edge23" class="edge">
<title>emit_errors&#45;&gt;error_handling</title>
<path fill="none" stroke="black" d="M491.71,-267.48C535.12,-263.15 594.89,-254.03 609.5,-236 619.57,-223.57 619.91,-212.15 609.5,-200 599.45,-188.27 518.14,-177.87 455.89,-171.52"/>
<polygon fill="black" stroke="black" points="455.99,-168.01 445.69,-170.49 455.29,-174.98 455.99,-168.01"/>
<text text-anchor="middle" x="636.5" y="-215.5" font-family="Courier,monospace" font-size="10.00">其他错误</text>
</g>
<!-- error_handling&#45;&gt;defer_cleanup -->
<g id="edge27" class="edge">
<title>error_handling&#45;&gt;defer_cleanup</title>
<path fill="none" stroke="black" d="M353.08,-145.99C335.93,-136.4 314.31,-124.32 295.87,-114.01"/>
<polygon fill="black" stroke="black" points="297.55,-110.94 287.11,-109.11 294.13,-117.05 297.55,-110.94"/>
</g>
<!-- success&#45;&gt;defer_cleanup -->
</g>
</svg>
