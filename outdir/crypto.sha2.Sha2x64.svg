<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Sha2x64 Pages: 1 -->
<svg width="919pt" height="673pt"
 viewBox="0.00 0.00 918.50 673.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 669)">
<title>Sha2x64</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-669 914.5,-669 914.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Sha2x64</title>
<polygon fill="none" stroke="black" points="202,-65 202,-436 727,-436 727,-65 202,-65"/>
<text text-anchor="middle" x="464.5" y="-420.8" font-family="Courier,monospace" font-size="14.00">Sha2x64 结构</text>
</g>
<!-- init -->
<g id="node1" class="node">
<title>init</title>
<path fill="none" stroke="black" d="M140,-515C140,-515 12,-515 12,-515 6,-515 0,-509 0,-503 0,-503 0,-489 0,-489 0,-483 6,-477 12,-477 12,-477 140,-477 140,-477 146,-477 152,-483 152,-489 152,-489 152,-503 152,-503 152,-509 146,-515 140,-515"/>
<text text-anchor="middle" x="76" y="-499.8" font-family="Courier,monospace" font-size="14.00">init(options)</text>
<text text-anchor="middle" x="76" y="-484.8" font-family="Courier,monospace" font-size="14.00">初始化状态 with IV</text>
</g>
<!-- update -->
<g id="node2" class="node">
<title>update</title>
<path fill="none" stroke="black" d="M448,-515C448,-515 200,-515 200,-515 194,-515 188,-509 188,-503 188,-503 188,-489 188,-489 188,-483 194,-477 200,-477 200,-477 448,-477 448,-477 454,-477 460,-483 460,-489 460,-489 460,-503 460,-503 460,-509 454,-515 448,-515"/>
<text text-anchor="middle" x="324" y="-499.8" font-family="Courier,monospace" font-size="14.00">update(d: *Self, b: []const u8)</text>
<text text-anchor="middle" x="324" y="-484.8" font-family="Courier,monospace" font-size="14.00">处理输入数据</text>
</g>
<!-- init&#45;&gt;update -->
<g id="edge1" class="edge">
<title>init&#45;&gt;update</title>
<path fill="none" stroke="black" d="M152.05,-496C160.66,-496 169.27,-496 177.88,-496"/>
<polygon fill="black" stroke="black" points="177.98,-499.5 187.98,-496 177.98,-492.5 177.98,-499.5"/>
</g>
<!-- update_partial -->
<g id="node3" class="node">
<title>update_partial</title>
<path fill="none" stroke="black" d="M384,-186C384,-186 222,-186 222,-186 216,-186 210,-180 210,-174 210,-174 210,-160 210,-160 210,-154 216,-148 222,-148 222,-148 384,-148 384,-148 390,-148 396,-154 396,-160 396,-160 396,-174 396,-174 396,-180 390,-186 384,-186"/>
<text text-anchor="middle" x="303" y="-170.8" font-family="Courier,monospace" font-size="14.00">处理部分块</text>
<text text-anchor="middle" x="303" y="-155.8" font-family="Courier,monospace" font-size="14.00">复制到缓冲区并调用round</text>
</g>
<!-- update&#45;&gt;update_partial -->
<g id="edge2" class="edge">
<title>update&#45;&gt;update_partial</title>
<path fill="none" stroke="black" d="M305.7,-476.7C287.73,-456.7 263,-422.85 263,-388 263,-388 263,-388 263,-240 263,-223.5 271.12,-207.25 280.05,-194.37"/>
<polygon fill="black" stroke="black" points="283.1,-196.15 286.27,-186.04 277.48,-191.96 283.1,-196.15"/>
<text text-anchor="middle" x="306" y="-310.3" font-family="Times,serif" font-size="14.00">缓冲区非空时</text>
</g>
<!-- update_full -->
<g id="node4" class="node">
<title>update_full</title>
<path fill="none" stroke="black" d="M516.5,-186C516.5,-186 425.5,-186 425.5,-186 419.5,-186 413.5,-180 413.5,-174 413.5,-174 413.5,-160 413.5,-160 413.5,-154 419.5,-148 425.5,-148 425.5,-148 516.5,-148 516.5,-148 522.5,-148 528.5,-154 528.5,-160 528.5,-160 528.5,-174 528.5,-174 528.5,-180 522.5,-186 516.5,-186"/>
<text text-anchor="middle" x="471" y="-170.8" font-family="Courier,monospace" font-size="14.00">处理完整块</text>
<text text-anchor="middle" x="471" y="-155.8" font-family="Courier,monospace" font-size="14.00">循环调用round</text>
</g>
<!-- update&#45;&gt;update_full -->
<g id="edge3" class="edge">
<title>update&#45;&gt;update_full</title>
<path fill="none" stroke="black" d="M342.3,-476.7C360.27,-456.7 385,-422.85 385,-388 385,-388 385,-388 385,-240 385,-219 400.26,-202.91 417.93,-191.33"/>
<polygon fill="black" stroke="black" points="419.99,-194.17 426.74,-186 416.37,-188.18 419.99,-194.17"/>
<text text-anchor="middle" x="421" y="-310.3" font-family="Times,serif" font-size="14.00">处理完整块</text>
</g>
<!-- update_remainder -->
<g id="node5" class="node">
<title>update_remainder</title>
<path fill="none" stroke="black" d="M559.5,-405C559.5,-405 424.5,-405 424.5,-405 418.5,-405 412.5,-399 412.5,-393 412.5,-393 412.5,-381 412.5,-381 412.5,-375 418.5,-369 424.5,-369 424.5,-369 559.5,-369 559.5,-369 565.5,-369 571.5,-375 571.5,-381 571.5,-381 571.5,-393 571.5,-393 571.5,-399 565.5,-405 559.5,-405"/>
<text text-anchor="middle" x="492" y="-383.3" font-family="Courier,monospace" font-size="14.00">保存剩余数据到缓冲区</text>
</g>
<!-- update&#45;&gt;update_remainder -->
<g id="edge4" class="edge">
<title>update&#45;&gt;update_remainder</title>
<path fill="none" stroke="black" d="M365.67,-476.86C376.75,-471.54 388.53,-465.41 399,-459 422.13,-444.83 446.44,-426.12 464.4,-411.46"/>
<polygon fill="black" stroke="black" points="466.69,-414.11 472.18,-405.05 462.23,-408.71 466.69,-414.11"/>
<text text-anchor="middle" x="463" y="-447.8" font-family="Times,serif" font-size="14.00">保存剩余数据</text>
</g>
<!-- final -->
<g id="node6" class="node">
<title>final</title>
<path fill="none" stroke="black" d="M898.5,-515C898.5,-515 575.5,-515 575.5,-515 569.5,-515 563.5,-509 563.5,-503 563.5,-503 563.5,-489 563.5,-489 563.5,-483 569.5,-477 575.5,-477 575.5,-477 898.5,-477 898.5,-477 904.5,-477 910.5,-483 910.5,-489 910.5,-489 910.5,-503 910.5,-503 910.5,-509 904.5,-515 898.5,-515"/>
<text text-anchor="middle" x="737" y="-499.8" font-family="Courier,monospace" font-size="14.00">final(d: *Self, out: *[digest_length]u8)</text>
<text text-anchor="middle" x="737" y="-484.8" font-family="Courier,monospace" font-size="14.00">填充数据并生成最终哈希</text>
</g>
<!-- update&#45;&gt;final -->
<g id="edge7" class="edge">
<title>update&#45;&gt;final</title>
<path fill="none" stroke="black" d="M460.09,-496C489.89,-496 521.91,-496 553.22,-496"/>
<polygon fill="black" stroke="black" points="553.36,-499.5 563.36,-496 553.36,-492.5 553.36,-499.5"/>
<text text-anchor="middle" x="511.75" y="-502.8" font-family="Times,serif" font-size="14.00">结束数据输入</text>
</g>
<!-- round -->
<g id="node12" class="node">
<title>round</title>
<path fill="none" stroke="black" d="M565.5,-111C565.5,-111 292.5,-111 292.5,-111 286.5,-111 280.5,-105 280.5,-99 280.5,-99 280.5,-85 280.5,-85 280.5,-79 286.5,-73 292.5,-73 292.5,-73 565.5,-73 565.5,-73 571.5,-73 577.5,-79 577.5,-85 577.5,-85 577.5,-99 577.5,-99 577.5,-105 571.5,-111 565.5,-111"/>
<text text-anchor="middle" x="429" y="-95.8" font-family="Courier,monospace" font-size="14.00">round(d: *Self, b: *const [128]u8)</text>
<text text-anchor="middle" x="429" y="-80.8" font-family="Courier,monospace" font-size="14.00">处理单个128字节块</text>
</g>
<!-- update_partial&#45;&gt;round -->
<g id="edge5" class="edge">
<title>update_partial&#45;&gt;round</title>
<path fill="none" stroke="black" d="M334.15,-147.96C350.65,-138.39 371.12,-126.53 388.81,-116.28"/>
<polygon fill="black" stroke="black" points="390.88,-119.13 397.78,-111.09 387.37,-113.08 390.88,-119.13"/>
</g>
<!-- update_full&#45;&gt;round -->
<g id="edge6" class="edge">
<title>update_full&#45;&gt;round</title>
<path fill="none" stroke="black" d="M460.62,-147.96C455.77,-139.53 449.9,-129.33 444.54,-120.01"/>
<polygon fill="black" stroke="black" points="447.43,-118.01 439.41,-111.09 441.36,-121.5 447.43,-118.01"/>
</g>
<!-- final_pad -->
<g id="node7" class="node">
<title>final_pad</title>
<path fill="none" stroke="black" d="M706.5,-405C706.5,-405 601.5,-405 601.5,-405 595.5,-405 589.5,-399 589.5,-393 589.5,-393 589.5,-381 589.5,-381 589.5,-375 595.5,-369 601.5,-369 601.5,-369 706.5,-369 706.5,-369 712.5,-369 718.5,-375 718.5,-381 718.5,-381 718.5,-393 718.5,-393 718.5,-399 712.5,-405 706.5,-405"/>
<text text-anchor="middle" x="654" y="-383.3" font-family="Courier,monospace" font-size="14.00">添加填充位 0x80</text>
</g>
<!-- final&#45;&gt;final_pad -->
<g id="edge8" class="edge">
<title>final&#45;&gt;final_pad</title>
<path fill="none" stroke="black" d="M722.92,-476.85C709.38,-459.4 688.8,-432.86 673.65,-413.33"/>
<polygon fill="black" stroke="black" points="676.22,-410.93 667.32,-405.18 670.69,-415.22 676.22,-410.93"/>
</g>
<!-- final_check -->
<g id="node8" class="node">
<title>final_check</title>
<path fill="none" stroke="black" d="M706.5,-332C706.5,-332 585.5,-332 585.5,-332 579.5,-332 573.5,-326 573.5,-320 573.5,-320 573.5,-308 573.5,-308 573.5,-302 579.5,-296 585.5,-296 585.5,-296 706.5,-296 706.5,-296 712.5,-296 718.5,-302 718.5,-308 718.5,-308 718.5,-320 718.5,-320 718.5,-326 712.5,-332 706.5,-332"/>
<text text-anchor="middle" x="646" y="-310.3" font-family="Courier,monospace" font-size="14.00">检查块空间是否足够</text>
</g>
<!-- final_pad&#45;&gt;final_check -->
<g id="edge9" class="edge">
<title>final_pad&#45;&gt;final_check</title>
<path fill="none" stroke="black" d="M652.06,-368.81C651.16,-360.79 650.06,-351.05 649.05,-342.07"/>
<polygon fill="black" stroke="black" points="652.52,-341.57 647.92,-332.03 645.56,-342.36 652.52,-341.57"/>
</g>
<!-- final_length -->
<g id="node9" class="node">
<title>final_length</title>
<path fill="none" stroke="black" d="M598,-259C598,-259 520,-259 520,-259 514,-259 508,-253 508,-247 508,-247 508,-235 508,-235 508,-229 514,-223 520,-223 520,-223 598,-223 598,-223 604,-223 610,-229 610,-235 610,-235 610,-247 610,-247 610,-253 604,-259 598,-259"/>
<text text-anchor="middle" x="559" y="-237.3" font-family="Courier,monospace" font-size="14.00">追加消息长度</text>
</g>
<!-- final_check&#45;&gt;final_length -->
<g id="edge11" class="edge">
<title>final_check&#45;&gt;final_length</title>
<path fill="none" stroke="black" d="M624.94,-295.81C613.83,-286.74 600.02,-275.48 587.92,-265.6"/>
<polygon fill="black" stroke="black" points="589.83,-262.64 579.87,-259.03 585.4,-268.06 589.83,-262.64"/>
</g>
<!-- final_round -->
<g id="node10" class="node">
<title>final_round</title>
<path fill="none" stroke="black" d="M707,-185C707,-185 559,-185 559,-185 553,-185 547,-179 547,-173 547,-173 547,-161 547,-161 547,-155 553,-149 559,-149 559,-149 707,-149 707,-149 713,-149 719,-155 719,-161 719,-161 719,-173 719,-173 719,-179 713,-185 707,-185"/>
<text text-anchor="middle" x="633" y="-163.3" font-family="Courier,monospace" font-size="14.00">调用round处理最后一块</text>
</g>
<!-- final_check&#45;&gt;final_round -->
<g id="edge10" class="edge">
<title>final_check&#45;&gt;final_round</title>
<path fill="none" stroke="black" d="M644.46,-295.8C642.23,-270.94 638.09,-224.74 635.44,-195.23"/>
<polygon fill="black" stroke="black" points="638.92,-194.83 634.54,-185.18 631.95,-195.45 638.92,-194.83"/>
<text text-anchor="middle" x="677" y="-237.3" font-family="Times,serif" font-size="14.00">空间不足时</text>
</g>
<!-- final_length&#45;&gt;final_round -->
<g id="edge12" class="edge">
<title>final_length&#45;&gt;final_round</title>
<path fill="none" stroke="black" d="M576.54,-222.94C585.96,-213.77 597.74,-202.31 608.1,-192.23"/>
<polygon fill="black" stroke="black" points="610.61,-194.67 615.33,-185.19 605.72,-189.66 610.61,-194.67"/>
</g>
<!-- final_output -->
<g id="node11" class="node">
<title>final_output</title>
<path fill="none" stroke="black" d="M700,-110C700,-110 608,-110 608,-110 602,-110 596,-104 596,-98 596,-98 596,-86 596,-86 596,-80 602,-74 608,-74 608,-74 700,-74 700,-74 706,-74 712,-80 712,-86 712,-86 712,-98 712,-98 712,-104 706,-110 700,-110"/>
<text text-anchor="middle" x="654" y="-88.3" font-family="Courier,monospace" font-size="14.00">生成输出哈希值</text>
</g>
<!-- final_round&#45;&gt;final_output -->
<g id="edge14" class="edge">
<title>final_round&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M637.98,-148.7C640.44,-140.15 643.46,-129.65 646.21,-120.07"/>
<polygon fill="black" stroke="black" points="649.66,-120.75 649.06,-110.18 642.93,-118.82 649.66,-120.75"/>
</g>
<!-- final_round&#45;&gt;round -->
<g id="edge13" class="edge">
<title>final_round&#45;&gt;round</title>
<path fill="none" stroke="black" d="M585.43,-148.98C556.74,-138.71 519.94,-125.54 489.24,-114.55"/>
<polygon fill="black" stroke="black" points="490.09,-111.14 479.5,-111.07 487.74,-117.74 490.09,-111.14"/>
</g>
<!-- round_expand -->
<g id="node13" class="node">
<title>round_expand</title>
<path fill="none" stroke="black" d="M483.5,-36C483.5,-36 374.5,-36 374.5,-36 368.5,-36 362.5,-30 362.5,-24 362.5,-24 362.5,-12 362.5,-12 362.5,-6 368.5,0 374.5,0 374.5,0 483.5,0 483.5,0 489.5,0 495.5,-6 495.5,-12 495.5,-12 495.5,-24 495.5,-24 495.5,-30 489.5,-36 483.5,-36"/>
<text text-anchor="middle" x="429" y="-14.3" font-family="Courier,monospace" font-size="14.00">扩展消息到80个字</text>
</g>
<!-- round&#45;&gt;round_expand -->
<g id="edge15" class="edge">
<title>round&#45;&gt;round_expand</title>
<path fill="none" stroke="black" d="M429,-72.83C429,-64.89 429,-55.41 429,-46.63"/>
<polygon fill="black" stroke="black" points="432.5,-46.42 429,-36.42 425.5,-46.42 432.5,-46.42"/>
</g>
<!-- round_compress -->
<g id="node14" class="node">
<title>round_compress</title>
<path fill="none" stroke="black" d="M652.5,-36C652.5,-36 543.5,-36 543.5,-36 537.5,-36 531.5,-30 531.5,-24 531.5,-24 531.5,-12 531.5,-12 531.5,-6 537.5,0 543.5,0 543.5,0 652.5,0 652.5,0 658.5,0 664.5,-6 664.5,-12 664.5,-12 664.5,-24 664.5,-24 664.5,-30 658.5,-36 652.5,-36"/>
<text text-anchor="middle" x="598" y="-14.3" font-family="Courier,monospace" font-size="14.00">压缩函数处理80轮</text>
</g>
<!-- round_expand&#45;&gt;round_compress -->
<g id="edge16" class="edge">
<title>round_expand&#45;&gt;round_compress</title>
<path fill="none" stroke="black" d="M495.68,-18C504.2,-18 512.72,-18 521.24,-18"/>
<polygon fill="black" stroke="black" points="521.25,-21.5 531.25,-18 521.25,-14.5 521.25,-21.5"/>
</g>
<!-- round_update -->
<g id="node15" class="node">
<title>round_update</title>
<path fill="none" stroke="black" d="M804,-36C804,-36 712,-36 712,-36 706,-36 700,-30 700,-24 700,-24 700,-12 700,-12 700,-6 706,0 712,0 712,0 804,0 804,0 810,0 816,-6 816,-12 816,-12 816,-24 816,-24 816,-30 810,-36 804,-36"/>
<text text-anchor="middle" x="758" y="-14.3" font-family="Courier,monospace" font-size="14.00">更新状态寄存器</text>
</g>
<!-- round_compress&#45;&gt;round_update -->
<g id="edge17" class="edge">
<title>round_compress&#45;&gt;round_update</title>
<path fill="none" stroke="black" d="M664.56,-18C672.95,-18 681.34,-18 689.73,-18"/>
<polygon fill="black" stroke="black" points="689.97,-21.5 699.97,-18 689.97,-14.5 689.97,-21.5"/>
</g>
<!-- hash -->
<g id="node16" class="node">
<title>hash</title>
<path fill="none" stroke="black" d="M502,-665C502,-665 146,-665 146,-665 140,-665 134,-659 134,-653 134,-653 134,-639 134,-639 134,-633 140,-627 146,-627 146,-627 502,-627 502,-627 508,-627 514,-633 514,-639 514,-639 514,-653 514,-653 514,-659 508,-665 502,-665"/>
<text text-anchor="middle" x="324" y="-649.8" font-family="Courier,monospace" font-size="14.00">hash(b: []const u8, out: *[digest_length]u8)</text>
<text text-anchor="middle" x="324" y="-634.8" font-family="Courier,monospace" font-size="14.00">一次性哈希入口</text>
</g>
<!-- hash&#45;&gt;init -->
<g id="edge18" class="edge">
<title>hash&#45;&gt;init</title>
<path fill="none" stroke="black" d="M293.59,-626.85C248.66,-600.04 164.53,-549.84 115.08,-520.32"/>
<polygon fill="black" stroke="black" points="116.65,-517.18 106.27,-515.06 113.06,-523.19 116.65,-517.18"/>
</g>
<!-- hash&#45;&gt;update -->
<g id="edge19" class="edge">
<title>hash&#45;&gt;update</title>
<path fill="none" stroke="black" d="M324,-626.85C324,-601.55 324,-555.43 324,-525.52"/>
<polygon fill="black" stroke="black" points="327.5,-525.3 324,-515.3 320.5,-525.3 327.5,-525.3"/>
</g>
<!-- hash&#45;&gt;final -->
<g id="edge20" class="edge">
<title>hash&#45;&gt;final</title>
<path fill="none" stroke="black" d="M374.64,-626.85C451.02,-599.48 595.4,-547.74 676.96,-518.51"/>
<polygon fill="black" stroke="black" points="678.36,-521.73 686.59,-515.06 676,-515.14 678.36,-521.73"/>
</g>
<!-- peek -->
<g id="node17" class="node">
<title>peek</title>
<path fill="none" stroke="black" d="M797.5,-665C797.5,-665 676.5,-665 676.5,-665 670.5,-665 664.5,-659 664.5,-653 664.5,-653 664.5,-639 664.5,-639 664.5,-633 670.5,-627 676.5,-627 676.5,-627 797.5,-627 797.5,-627 803.5,-627 809.5,-633 809.5,-639 809.5,-639 809.5,-653 809.5,-653 809.5,-659 803.5,-665 797.5,-665"/>
<text text-anchor="middle" x="737" y="-649.8" font-family="Courier,monospace" font-size="14.00">peek(d: Self)</text>
<text text-anchor="middle" x="737" y="-634.8" font-family="Courier,monospace" font-size="14.00">复制状态并生成哈希</text>
</g>
<!-- finalResult -->
<g id="node18" class="node">
<title>finalResult</title>
<path fill="none" stroke="black" d="M787,-590C787,-590 687,-590 687,-590 681,-590 675,-584 675,-578 675,-578 675,-564 675,-564 675,-558 681,-552 687,-552 687,-552 787,-552 787,-552 793,-552 799,-558 799,-564 799,-564 799,-578 799,-578 799,-584 793,-590 787,-590"/>
<text text-anchor="middle" x="737" y="-574.8" font-family="Courier,monospace" font-size="14.00">finalResult()</text>
<text text-anchor="middle" x="737" y="-559.8" font-family="Courier,monospace" font-size="14.00">返回最终哈希值</text>
</g>
<!-- peek&#45;&gt;finalResult -->
<g id="edge21" class="edge">
<title>peek&#45;&gt;finalResult</title>
<path fill="none" stroke="black" d="M737,-626.96C737,-618.88 737,-609.18 737,-600.18"/>
<polygon fill="black" stroke="black" points="740.5,-600.09 737,-590.09 733.5,-600.09 740.5,-600.09"/>
</g>
<!-- finalResult&#45;&gt;final -->
<g id="edge22" class="edge">
<title>finalResult&#45;&gt;final</title>
<path fill="none" stroke="black" d="M737,-551.96C737,-543.88 737,-534.18 737,-525.18"/>
<polygon fill="black" stroke="black" points="740.5,-525.09 737,-515.09 733.5,-525.09 740.5,-525.09"/>
</g>
</g>
</svg>
