graph TD
    A[开始] --> B[初始化跟踪和缓存]
    B --> C[计算哈希值]
    C --> D[检查缓存命中]
    D -->|命中且文件存在| E[设置actual_hit=true]
    D -->|命中但文件不存在| F[撤销缓存命中,设置actual_hit=false]
    E & F --> G{是否缓存命中?}
    G -->|否| H[创建临时目录和文件]
    H --> I[构建编译命令参数]
    I --> J{前端类型?}
    J -->|clang| K[调用Clang转换C代码]
    J -->|aro| L[触发未实现错误]
    K --> M{转换是否成功?}
    M -->|是| N[生成AST树并渲染Zig代码]
    M -->|否| O[返回错误信息]
    N --> P[写入生成的Zig文件]
    P --> Q[更新缓存清单]
    G -->|是| Q
    Q --> R[释放临时资源]
    R --> S[检查独占锁并更新清单]
    S --> T[返回结果]
