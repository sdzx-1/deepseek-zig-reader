
digraph flowchart {
    node [shape=rectangle, style="rounded", fontname="Arial"];
    edge [fontname="Arial"];

    start [label="开始"];
    read_cu_cwd [label="读取编译单元目录(compile_unit_cwd)"];
    read_line_info_offset [label="读取行信息偏移(line_info_offset)"];
    init_fbr [label="初始化FixedBufferReader"];
    read_unit_header [label="读取单元头(unit_header)"];
    check_unit_length [label="检查unit_header.unit_length == 0?"];
    read_version [label="读取版本号(version)"];
    check_version_lt2 [label="version < 2?"];
    handle_addr_seg_size [label="处理地址和段大小(addr_size, seg_size)"];
    read_prologue [label="读取prologue_length和prog_start_offset"];
    read_min_instr_len [label="读取minimum_instruction_length"];
    check_min_instr_zero [label="minimum_instruction_length == 0?"];
    read_max_ops [label="version ≥4时读取max_ops_per_instr"];
    read_defaults [label="读取default_is_stmt, line_base, line_range"];
    check_line_range_zero [label="line_range == 0?"];
    read_opcode_base [label="读取opcode_base和standard_opcode_lengths"];
    handle_directories_files [label="处理目录和文件条目"];
    version_lt5 [label="version < 5?"];
    read_legacy_dirs [label="循环读取旧版目录"];
    read_legacy_files [label="循环读取旧版文件"];
    read_v5_dirs [label="解析DWARFv5目录格式"];
    read_v5_files [label="解析DWARFv5文件格式"];
    init_prog [label="初始化LineNumberProgram和line_table"];
    seek_prog_start [label="定位到prog_start_offset"];
    process_opcodes [label="循环处理操作码"];
    opcode_type [label="操作码类型判断"];
    handle_extended_op [label="处理扩展操作码(LNE)"];
    handle_special_op [label="处理特殊操作码(opcode ≥ opcode_base)"];
    handle_standard_op [label="处理标准操作码(LNS)"];
    sort_line_table [label="对line_table排序"];
    return_result [label="返回结果"];
    error_bad [label="返回bad()", shape=oval, color=red];
    error_missing [label="返回missing()", shape=oval, color=red];

    start -> read_cu_cwd -> read_line_info_offset -> init_fbr -> read_unit_header;
    read_unit_header -> check_unit_length;
    check_unit_length -> error_missing [label="是"];
    check_unit_length -> read_version [label="否"];
    read_version -> check_version_lt2;
    check_version_lt2 -> error_bad [label="是"];
    check_version_lt2 -> handle_addr_seg_size [label="否"];
    handle_addr_seg_size -> read_prologue -> read_min_instr_len -> check_min_instr_zero;
    check_min_instr_zero -> error_bad [label="是"];
    check_min_instr_zero -> read_max_ops [label="否"];
    read_max_ops -> read_defaults -> check_line_range_zero;
    check_line_range_zero -> error_bad [label="是"];
    check_line_range_zero -> read_opcode_base [label="否"];
    read_opcode_base -> handle_directories_files -> version_lt5;
    version_lt5 -> read_legacy_dirs [label="是"];
    version_lt5 -> read_v5_dirs [label="否"];
    read_legacy_dirs -> read_legacy_files;
    read_v5_dirs -> read_v5_files;
    read_legacy_files -> init_prog;
    read_v5_files -> init_prog;
    init_prog -> seek_prog_start -> process_opcodes;
    process_opcodes -> opcode_type;
    opcode_type -> handle_extended_op [label="opcode == LNS.extended_op"];
    opcode_type -> handle_special_op [label="opcode ≥ opcode_base"];
    opcode_type -> handle_standard_op [label="其他情况"];
    handle_extended_op -> process_opcodes;
    handle_special_op -> process_opcodes;
    handle_standard_op -> process_opcodes;
    process_opcodes -> sort_line_table [label="循环结束"];
    sort_line_table -> return_result;
}
