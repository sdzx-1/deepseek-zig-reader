graph TD
    A[开始] --> B[初始化变量]
    B --> C[解析参数对]
    C --> D[进入参数处理循环]
    D --> E{参数是否为索引对象?}
    E -- 是 --> F[检查对象可索引性]
    F --> G{可索引且有长度?}
    G -- 是 --> H[获取对象长度]
    G -- 否 --> I[生成类型错误]
    I --> J[返回错误]
    E -- 否 --> K[处理范围参数]
    K --> L[计算范围长度]
    L --> M[类型强制转换]
    M --> N{是否首次遇到长度?}
    N -- 是 --> O[设置主长度和值]
    N -- 否 --> P{长度是否一致?}
    P -- 否 --> Q[生成长度不匹配错误]
    Q --> J
    P -- 是 --> R[记录运行时长度]
    R --> S[继续循环]
    D --> T[循环结束?]
    T -- 否 --> D
    T -- 是 --> U{是否存在主长度?}
    U -- 否 --> V[生成无限循环错误]
    V --> J
    U -- 是 --> W{需要运行时检查?}
    W -- 是 --> X[添加安全检查指令]
    X --> Y[返回主长度]
    W -- 否 --> Y
    Y --> Z[结束]
