<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="801pt" height="1684pt"
 viewBox="0.00 0.00 800.50 1684.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1680)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1680 796.5,-1680 796.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M199.5,-1676C199.5,-1676 81.5,-1676 81.5,-1676 75.5,-1676 69.5,-1670 69.5,-1664 69.5,-1664 69.5,-1652 69.5,-1652 69.5,-1646 75.5,-1640 81.5,-1640 81.5,-1640 199.5,-1640 199.5,-1640 205.5,-1640 211.5,-1646 211.5,-1652 211.5,-1652 211.5,-1664 211.5,-1664 211.5,-1670 205.5,-1676 199.5,-1676"/>
<text text-anchor="middle" x="140.5" y="-1654.3" font-family="Arial" font-size="14.00">开始 readvAdvanced</text>
</g>
<!-- check_partial_cleartext -->
<g id="node2" class="node">
<title>check_partial_cleartext</title>
<path fill="none" stroke="black" d="M269,-1603C269,-1603 12,-1603 12,-1603 6,-1603 0,-1597 0,-1591 0,-1591 0,-1579 0,-1579 0,-1573 6,-1567 12,-1567 12,-1567 269,-1567 269,-1567 275,-1567 281,-1573 281,-1579 281,-1579 281,-1591 281,-1591 281,-1597 275,-1603 269,-1603"/>
<text text-anchor="middle" x="140.5" y="-1581.3" font-family="Arial" font-size="14.00">检查是否有部分明文数据 (partial_cleartext)</text>
</g>
<!-- start&#45;&gt;check_partial_cleartext -->
<g id="edge1" class="edge">
<title>start&#45;&gt;check_partial_cleartext</title>
<path fill="none" stroke="black" d="M140.5,-1639.81C140.5,-1631.79 140.5,-1622.05 140.5,-1613.07"/>
<polygon fill="black" stroke="black" points="144,-1613.03 140.5,-1603.03 137,-1613.03 144,-1613.03"/>
</g>
<!-- handle_partial_cleartext -->
<g id="node3" class="node">
<title>handle_partial_cleartext</title>
<path fill="none" stroke="black" d="M214.5,-1516C214.5,-1516 66.5,-1516 66.5,-1516 60.5,-1516 54.5,-1510 54.5,-1504 54.5,-1504 54.5,-1490 54.5,-1490 54.5,-1484 60.5,-1478 66.5,-1478 66.5,-1478 214.5,-1478 214.5,-1478 220.5,-1478 226.5,-1484 226.5,-1490 226.5,-1490 226.5,-1504 226.5,-1504 226.5,-1510 220.5,-1516 214.5,-1516"/>
<text text-anchor="middle" x="140.5" y="-1500.8" font-family="Arial" font-size="14.00">将部分明文填充到 iovecs</text>
<text text-anchor="middle" x="140.5" y="-1485.8" font-family="Arial" font-size="14.00">更新索引</text>
</g>
<!-- check_partial_cleartext&#45;&gt;handle_partial_cleartext -->
<g id="edge2" class="edge">
<title>check_partial_cleartext&#45;&gt;handle_partial_cleartext</title>
<path fill="none" stroke="black" d="M140.5,-1566.6C140.5,-1555.06 140.5,-1539.65 140.5,-1526.36"/>
<polygon fill="black" stroke="black" points="144,-1526.27 140.5,-1516.27 137,-1526.27 144,-1526.27"/>
<text text-anchor="middle" x="162" y="-1537.8" font-family="Arial" font-size="14.00">有数据</text>
</g>
<!-- check_buffer_empty -->
<g id="node4" class="node">
<title>check_buffer_empty</title>
<path fill="none" stroke="black" d="M194,-1441C194,-1441 87,-1441 87,-1441 81,-1441 75,-1435 75,-1429 75,-1429 75,-1417 75,-1417 75,-1411 81,-1405 87,-1405 87,-1405 194,-1405 194,-1405 200,-1405 206,-1411 206,-1417 206,-1417 206,-1429 206,-1429 206,-1435 200,-1441 194,-1441"/>
<text text-anchor="middle" x="140.5" y="-1419.3" font-family="Arial" font-size="14.00">缓冲区是否为空？</text>
</g>
<!-- handle_partial_cleartext&#45;&gt;check_buffer_empty -->
<g id="edge3" class="edge">
<title>handle_partial_cleartext&#45;&gt;check_buffer_empty</title>
<path fill="none" stroke="black" d="M140.5,-1477.83C140.5,-1469.89 140.5,-1460.41 140.5,-1451.63"/>
<polygon fill="black" stroke="black" points="144,-1451.42 140.5,-1441.42 137,-1451.42 144,-1451.42"/>
</g>
<!-- reset_buffer -->
<g id="node5" class="node">
<title>reset_buffer</title>
<path fill="none" stroke="black" d="M139.5,-1354C139.5,-1354 47.5,-1354 47.5,-1354 41.5,-1354 35.5,-1348 35.5,-1342 35.5,-1342 35.5,-1330 35.5,-1330 35.5,-1324 41.5,-1318 47.5,-1318 47.5,-1318 139.5,-1318 139.5,-1318 145.5,-1318 151.5,-1324 151.5,-1330 151.5,-1330 151.5,-1342 151.5,-1342 151.5,-1348 145.5,-1354 139.5,-1354"/>
<text text-anchor="middle" x="93.5" y="-1332.3" font-family="Arial" font-size="14.00">重置缓冲区索引</text>
</g>
<!-- check_buffer_empty&#45;&gt;reset_buffer -->
<g id="edge4" class="edge">
<title>check_buffer_empty&#45;&gt;reset_buffer</title>
<path fill="none" stroke="black" d="M130.99,-1404.8C124.36,-1392.82 115.41,-1376.62 107.91,-1363.06"/>
<polygon fill="black" stroke="black" points="110.9,-1361.23 103,-1354.18 104.77,-1364.62 110.9,-1361.23"/>
<text text-anchor="middle" x="128" y="-1375.8" font-family="Arial" font-size="14.00">是</text>
</g>
<!-- check_close_notify -->
<g id="node6" class="node">
<title>check_close_notify</title>
<path fill="none" stroke="black" d="M225,-1281C225,-1281 56,-1281 56,-1281 50,-1281 44,-1275 44,-1269 44,-1269 44,-1257 44,-1257 44,-1251 50,-1245 56,-1245 56,-1245 225,-1245 225,-1245 231,-1245 237,-1251 237,-1257 237,-1257 237,-1269 237,-1269 237,-1275 231,-1281 225,-1281"/>
<text text-anchor="middle" x="140.5" y="-1259.3" font-family="Arial" font-size="14.00">received_close_notify 为真？</text>
</g>
<!-- check_buffer_empty&#45;&gt;check_close_notify -->
<g id="edge6" class="edge">
<title>check_buffer_empty&#45;&gt;check_close_notify</title>
<path fill="none" stroke="black" d="M147.76,-1404.73C155.51,-1384.11 165.98,-1348.59 160.5,-1318 158.85,-1308.81 155.74,-1299.13 152.46,-1290.55"/>
<polygon fill="black" stroke="black" points="155.61,-1289.01 148.6,-1281.07 149.13,-1291.65 155.61,-1289.01"/>
<text text-anchor="middle" x="170" y="-1332.3" font-family="Arial" font-size="14.00">否</text>
</g>
<!-- reset_buffer&#45;&gt;check_close_notify -->
<g id="edge5" class="edge">
<title>reset_buffer&#45;&gt;check_close_notify</title>
<path fill="none" stroke="black" d="M104.88,-1317.81C110.48,-1309.35 117.34,-1298.98 123.55,-1289.61"/>
<polygon fill="black" stroke="black" points="126.63,-1291.3 129.23,-1281.03 120.79,-1287.44 126.63,-1291.3"/>
</g>
<!-- return_amt -->
<g id="node7" class="node">
<title>return_amt</title>
<path fill="none" stroke="black" d="M193,-1193C193,-1193 50,-1193 50,-1193 44,-1193 38,-1187 38,-1181 38,-1181 38,-1169 38,-1169 38,-1163 44,-1157 50,-1157 50,-1157 193,-1157 193,-1157 199,-1157 205,-1163 205,-1169 205,-1169 205,-1181 205,-1181 205,-1187 199,-1193 193,-1193"/>
<text text-anchor="middle" x="121.5" y="-1171.3" font-family="Arial" font-size="14.00">返回已处理数据量 (amt)</text>
</g>
<!-- check_close_notify&#45;&gt;return_amt -->
<g id="edge7" class="edge">
<title>check_close_notify&#45;&gt;return_amt</title>
<path fill="none" stroke="black" d="M136.66,-1244.6C134.01,-1232.63 130.45,-1216.5 127.44,-1202.89"/>
<polygon fill="black" stroke="black" points="130.85,-1202.09 125.27,-1193.08 124.01,-1203.6 130.85,-1202.09"/>
<text text-anchor="middle" x="141" y="-1215.8" font-family="Arial" font-size="14.00">是</text>
</g>
<!-- read_new_data -->
<g id="node8" class="node">
<title>read_new_data</title>
<path fill="none" stroke="black" d="M326.5,-1194C326.5,-1194 234.5,-1194 234.5,-1194 228.5,-1194 222.5,-1188 222.5,-1182 222.5,-1182 222.5,-1168 222.5,-1168 222.5,-1162 228.5,-1156 234.5,-1156 234.5,-1156 326.5,-1156 326.5,-1156 332.5,-1156 338.5,-1162 338.5,-1168 338.5,-1168 338.5,-1182 338.5,-1182 338.5,-1188 332.5,-1194 326.5,-1194"/>
<text text-anchor="middle" x="280.5" y="-1178.8" font-family="Arial" font-size="14.00">准备读取新数据</text>
<text text-anchor="middle" x="280.5" y="-1163.8" font-family="Arial" font-size="14.00">分配栈缓冲区</text>
</g>
<!-- check_close_notify&#45;&gt;read_new_data -->
<g id="edge8" class="edge">
<title>check_close_notify&#45;&gt;read_new_data</title>
<path fill="none" stroke="black" d="M168.49,-1244.8C189.72,-1231.76 219.13,-1213.7 242.48,-1199.35"/>
<polygon fill="black" stroke="black" points="244.42,-1202.27 251.11,-1194.06 240.75,-1196.31 244.42,-1202.27"/>
<text text-anchor="middle" x="226" y="-1215.8" font-family="Arial" font-size="14.00">否</text>
</g>
<!-- adjust_buffer_space -->
<g id="node9" class="node">
<title>adjust_buffer_space</title>
<path fill="none" stroke="black" d="M370,-1119C370,-1119 191,-1119 191,-1119 185,-1119 179,-1113 179,-1107 179,-1107 179,-1095 179,-1095 179,-1089 185,-1083 191,-1083 191,-1083 370,-1083 370,-1083 376,-1083 382,-1089 382,-1095 382,-1095 382,-1107 382,-1107 382,-1113 376,-1119 370,-1119"/>
<text text-anchor="middle" x="280.5" y="-1097.3" font-family="Arial" font-size="14.00">调整 partially_read_buffer 空间</text>
</g>
<!-- read_new_data&#45;&gt;adjust_buffer_space -->
<g id="edge9" class="edge">
<title>read_new_data&#45;&gt;adjust_buffer_space</title>
<path fill="none" stroke="black" d="M280.5,-1155.83C280.5,-1147.89 280.5,-1138.41 280.5,-1129.63"/>
<polygon fill="black" stroke="black" points="284,-1129.42 280.5,-1119.42 277,-1129.42 284,-1129.42"/>
</g>
<!-- construct_iovecs -->
<g id="node10" class="node">
<title>construct_iovecs</title>
<path fill="none" stroke="black" d="M369.5,-1046C369.5,-1046 191.5,-1046 191.5,-1046 185.5,-1046 179.5,-1040 179.5,-1034 179.5,-1034 179.5,-1022 179.5,-1022 179.5,-1016 185.5,-1010 191.5,-1010 191.5,-1010 369.5,-1010 369.5,-1010 375.5,-1010 381.5,-1016 381.5,-1022 381.5,-1022 381.5,-1034 381.5,-1034 381.5,-1040 375.5,-1046 369.5,-1046"/>
<text text-anchor="middle" x="280.5" y="-1024.3" font-family="Arial" font-size="14.00">构造 ask_iovecs_buf 请求结构</text>
</g>
<!-- adjust_buffer_space&#45;&gt;construct_iovecs -->
<g id="edge10" class="edge">
<title>adjust_buffer_space&#45;&gt;construct_iovecs</title>
<path fill="none" stroke="black" d="M280.5,-1082.81C280.5,-1074.79 280.5,-1065.05 280.5,-1056.07"/>
<polygon fill="black" stroke="black" points="284,-1056.03 280.5,-1046.03 277,-1056.03 284,-1056.03"/>
</g>
<!-- calculate_read_length -->
<g id="node11" class="node">
<title>calculate_read_length</title>
<path fill="none" stroke="black" d="M370.5,-973C370.5,-973 190.5,-973 190.5,-973 184.5,-973 178.5,-967 178.5,-961 178.5,-961 178.5,-949 178.5,-949 178.5,-943 184.5,-937 190.5,-937 190.5,-937 370.5,-937 370.5,-937 376.5,-937 382.5,-943 382.5,-949 382.5,-949 382.5,-961 382.5,-961 382.5,-967 376.5,-973 370.5,-973"/>
<text text-anchor="middle" x="280.5" y="-951.3" font-family="Arial" font-size="14.00">计算需要读取的长度 (ask_len)</text>
</g>
<!-- construct_iovecs&#45;&gt;calculate_read_length -->
<g id="edge11" class="edge">
<title>construct_iovecs&#45;&gt;calculate_read_length</title>
<path fill="none" stroke="black" d="M280.5,-1009.81C280.5,-1001.79 280.5,-992.05 280.5,-983.07"/>
<polygon fill="black" stroke="black" points="284,-983.03 280.5,-973.03 277,-983.03 284,-983.03"/>
</g>
<!-- stream_readv -->
<g id="node12" class="node">
<title>stream_readv</title>
<path fill="none" stroke="black" d="M362.5,-900C362.5,-900 198.5,-900 198.5,-900 192.5,-900 186.5,-894 186.5,-888 186.5,-888 186.5,-876 186.5,-876 186.5,-870 192.5,-864 198.5,-864 198.5,-864 362.5,-864 362.5,-864 368.5,-864 374.5,-870 374.5,-876 374.5,-876 374.5,-888 374.5,-888 374.5,-894 368.5,-900 362.5,-900"/>
<text text-anchor="middle" x="280.5" y="-878.3" font-family="Arial" font-size="14.00">调用 stream.readv 读取数据</text>
</g>
<!-- calculate_read_length&#45;&gt;stream_readv -->
<g id="edge12" class="edge">
<title>calculate_read_length&#45;&gt;stream_readv</title>
<path fill="none" stroke="black" d="M280.5,-936.81C280.5,-928.79 280.5,-919.05 280.5,-910.07"/>
<polygon fill="black" stroke="black" points="284,-910.03 280.5,-900.03 277,-910.03 284,-910.03"/>
</g>
<!-- check_read_zero -->
<g id="node13" class="node">
<title>check_read_zero</title>
<path fill="none" stroke="black" d="M352,-827C352,-827 209,-827 209,-827 203,-827 197,-821 197,-815 197,-815 197,-803 197,-803 197,-797 203,-791 209,-791 209,-791 352,-791 352,-791 358,-791 364,-797 364,-803 364,-803 364,-815 364,-815 364,-821 358,-827 352,-827"/>
<text text-anchor="middle" x="280.5" y="-805.3" font-family="Arial" font-size="14.00">实际读取长度是否为0？</text>
</g>
<!-- stream_readv&#45;&gt;check_read_zero -->
<g id="edge13" class="edge">
<title>stream_readv&#45;&gt;check_read_zero</title>
<path fill="none" stroke="black" d="M280.5,-863.81C280.5,-855.79 280.5,-846.05 280.5,-837.07"/>
<polygon fill="black" stroke="black" points="284,-837.03 280.5,-827.03 277,-837.03 284,-837.03"/>
</g>
<!-- handle_truncation -->
<g id="node14" class="node">
<title>handle_truncation</title>
<path fill="none" stroke="black" d="M366,-686C366,-686 137,-686 137,-686 131,-686 125,-680 125,-674 125,-674 125,-660 125,-660 125,-654 131,-648 137,-648 137,-648 366,-648 366,-648 372,-648 378,-654 378,-660 378,-660 378,-674 378,-674 378,-680 372,-686 366,-686"/>
<text text-anchor="middle" x="251.5" y="-670.8" font-family="Arial" font-size="14.00">处理截断情况</text>
<text text-anchor="middle" x="251.5" y="-655.8" font-family="Arial" font-size="14.00">设置 received_close_notify 或返回错误</text>
</g>
<!-- check_read_zero&#45;&gt;handle_truncation -->
<g id="edge14" class="edge">
<title>check_read_zero&#45;&gt;handle_truncation</title>
<path fill="none" stroke="black" d="M276.94,-790.83C272.06,-767.27 263.22,-724.6 257.36,-696.28"/>
<polygon fill="black" stroke="black" points="260.72,-695.28 255.27,-686.19 253.87,-696.7 260.72,-695.28"/>
<text text-anchor="middle" x="280" y="-761.8" font-family="Arial" font-size="14.00">是</text>
</g>
<!-- process_fragments -->
<g id="node15" class="node">
<title>process_fragments</title>
<path fill="none" stroke="black" d="M470.5,-740C470.5,-740 306.5,-740 306.5,-740 300.5,-740 294.5,-734 294.5,-728 294.5,-728 294.5,-716 294.5,-716 294.5,-710 300.5,-704 306.5,-704 306.5,-704 470.5,-704 470.5,-704 476.5,-704 482.5,-710 482.5,-716 482.5,-716 482.5,-728 482.5,-728 482.5,-734 476.5,-740 470.5,-740"/>
<text text-anchor="middle" x="388.5" y="-718.3" font-family="Arial" font-size="14.00">处理密文片段 frag0 和 frag1</text>
</g>
<!-- check_read_zero&#45;&gt;process_fragments -->
<g id="edge15" class="edge">
<title>check_read_zero&#45;&gt;process_fragments</title>
<path fill="none" stroke="black" d="M302.36,-790.8C318.46,-778.13 340.56,-760.73 358.34,-746.74"/>
<polygon fill="black" stroke="black" points="360.98,-749.11 366.68,-740.18 356.65,-743.61 360.98,-749.11"/>
<text text-anchor="middle" x="348" y="-761.8" font-family="Arial" font-size="14.00">否</text>
</g>
<!-- finish_return -->
<g id="node25" class="node">
<title>finish_return</title>
<path fill="none" stroke="black" d="M381.5,-36C381.5,-36 247.5,-36 247.5,-36 241.5,-36 235.5,-30 235.5,-24 235.5,-24 235.5,-12 235.5,-12 235.5,-6 241.5,0 247.5,0 247.5,0 381.5,0 381.5,0 387.5,0 393.5,-6 393.5,-12 393.5,-12 393.5,-24 393.5,-24 393.5,-30 387.5,-36 381.5,-36"/>
<text text-anchor="middle" x="314.5" y="-14.3" font-family="Arial" font-size="14.00">返回总处理量 (vp.total)</text>
</g>
<!-- handle_truncation&#45;&gt;finish_return -->
<g id="edge29" class="edge">
<title>handle_truncation&#45;&gt;finish_return</title>
<path fill="none" stroke="black" d="M237.96,-647.74C226.35,-630.26 211.5,-602.67 211.5,-576 211.5,-576 211.5,-576 211.5,-104 211.5,-75.5 235.24,-54.78 259.93,-40.93"/>
<polygon fill="black" stroke="black" points="261.81,-43.89 269.02,-36.14 258.54,-37.7 261.81,-43.89"/>
<text text-anchor="middle" x="276" y="-372.3" font-family="Arial" font-size="14.00">设置标志或返回错误</text>
</g>
<!-- decrypt_loop -->
<g id="node16" class="node">
<title>decrypt_loop</title>
<path fill="none" stroke="black" d="M487,-630C487,-630 380,-630 380,-630 374,-630 368,-624 368,-618 368,-618 368,-606 368,-606 368,-600 374,-594 380,-594 380,-594 487,-594 487,-594 493,-594 499,-600 499,-606 499,-606 499,-618 499,-618 499,-624 493,-630 487,-630"/>
<text text-anchor="middle" x="433.5" y="-608.3" font-family="Arial" font-size="14.00">循环处理每个记录</text>
</g>
<!-- process_fragments&#45;&gt;decrypt_loop -->
<g id="edge16" class="edge">
<title>process_fragments&#45;&gt;decrypt_loop</title>
<path fill="none" stroke="black" d="M395.73,-703.65C402.91,-686.41 414.03,-659.73 422.35,-639.77"/>
<polygon fill="black" stroke="black" points="425.67,-640.89 426.29,-630.31 419.21,-638.19 425.67,-640.89"/>
</g>
<!-- parse_record_header -->
<g id="node17" class="node">
<title>parse_record_header</title>
<path fill="none" stroke="black" d="M508.5,-557C508.5,-557 358.5,-557 358.5,-557 352.5,-557 346.5,-551 346.5,-545 346.5,-545 346.5,-531 346.5,-531 346.5,-525 352.5,-519 358.5,-519 358.5,-519 508.5,-519 508.5,-519 514.5,-519 520.5,-525 520.5,-531 520.5,-531 520.5,-545 520.5,-545 520.5,-551 514.5,-557 508.5,-557"/>
<text text-anchor="middle" x="433.5" y="-541.8" font-family="Arial" font-size="14.00">解析记录头</text>
<text text-anchor="middle" x="433.5" y="-526.8" font-family="Arial" font-size="14.00">(ContentType, 版本, 长度)</text>
</g>
<!-- decrypt_loop&#45;&gt;parse_record_header -->
<g id="edge17" class="edge">
<title>decrypt_loop&#45;&gt;parse_record_header</title>
<path fill="none" stroke="black" d="M433.5,-593.94C433.5,-585.99 433.5,-576.31 433.5,-567.31"/>
<polygon fill="black" stroke="black" points="437,-567.2 433.5,-557.2 430,-567.2 437,-567.2"/>
</g>
<!-- check_record_length -->
<g id="node18" class="node">
<title>check_record_length</title>
<path fill="none" stroke="black" d="M494,-482C494,-482 373,-482 373,-482 367,-482 361,-476 361,-470 361,-470 361,-458 361,-458 361,-452 367,-446 373,-446 373,-446 494,-446 494,-446 500,-446 506,-452 506,-458 506,-458 506,-470 506,-470 506,-476 500,-482 494,-482"/>
<text text-anchor="middle" x="433.5" y="-460.3" font-family="Arial" font-size="14.00">记录长度是否合法？</text>
</g>
<!-- parse_record_header&#45;&gt;check_record_length -->
<g id="edge18" class="edge">
<title>parse_record_header&#45;&gt;check_record_length</title>
<path fill="none" stroke="black" d="M433.5,-518.83C433.5,-510.89 433.5,-501.41 433.5,-492.63"/>
<polygon fill="black" stroke="black" points="437,-492.42 433.5,-482.42 430,-492.42 437,-492.42"/>
</g>
<!-- decrypt_data -->
<g id="node19" class="node">
<title>decrypt_data</title>
<path fill="none" stroke="black" d="M496.5,-395C496.5,-395 370.5,-395 370.5,-395 364.5,-395 358.5,-389 358.5,-383 358.5,-383 358.5,-369 358.5,-369 358.5,-363 364.5,-357 370.5,-357 370.5,-357 496.5,-357 496.5,-357 502.5,-357 508.5,-363 508.5,-369 508.5,-369 508.5,-383 508.5,-383 508.5,-389 502.5,-395 496.5,-395"/>
<text text-anchor="middle" x="433.5" y="-379.8" font-family="Arial" font-size="14.00">解密数据</text>
<text text-anchor="middle" x="433.5" y="-364.8" font-family="Arial" font-size="14.00">处理 TLS 1.3/1.2 差异</text>
</g>
<!-- check_record_length&#45;&gt;decrypt_data -->
<g id="edge19" class="edge">
<title>check_record_length&#45;&gt;decrypt_data</title>
<path fill="none" stroke="black" d="M433.5,-445.6C433.5,-434.06 433.5,-418.65 433.5,-405.36"/>
<polygon fill="black" stroke="black" points="437,-405.27 433.5,-395.27 430,-405.27 437,-405.27"/>
<text text-anchor="middle" x="448" y="-416.8" font-family="Arial" font-size="14.00">合法</text>
</g>
<!-- handle_content_type -->
<g id="node20" class="node">
<title>handle_content_type</title>
<path fill="none" stroke="black" d="M445,-320C445,-320 338,-320 338,-320 332,-320 326,-314 326,-308 326,-308 326,-296 326,-296 326,-290 332,-284 338,-284 338,-284 445,-284 445,-284 451,-284 457,-290 457,-296 457,-296 457,-308 457,-308 457,-314 451,-320 445,-320"/>
<text text-anchor="middle" x="391.5" y="-298.3" font-family="Arial" font-size="14.00">根据内容类型处理</text>
</g>
<!-- decrypt_data&#45;&gt;handle_content_type -->
<g id="edge20" class="edge">
<title>decrypt_data&#45;&gt;handle_content_type</title>
<path fill="none" stroke="black" d="M422.9,-356.83C418.02,-348.46 412.13,-338.36 406.78,-329.19"/>
<polygon fill="black" stroke="black" points="409.72,-327.29 401.66,-320.42 403.68,-330.82 409.72,-327.29"/>
</g>
<!-- handle_alert -->
<g id="node21" class="node">
<title>handle_alert</title>
<path fill="none" stroke="black" d="M391,-177C391,-177 238,-177 238,-177 232,-177 226,-171 226,-165 226,-165 226,-153 226,-153 226,-147 232,-141 238,-141 238,-141 391,-141 391,-141 397,-141 403,-147 403,-153 403,-153 403,-165 403,-165 403,-171 397,-177 391,-177"/>
<text text-anchor="middle" x="314.5" y="-155.3" font-family="Arial" font-size="14.00">处理 Alert (如 close_notify)</text>
</g>
<!-- handle_content_type&#45;&gt;handle_alert -->
<g id="edge21" class="edge">
<title>handle_content_type&#45;&gt;handle_alert</title>
<path fill="none" stroke="black" d="M338.96,-283.99C315.13,-273.35 289.25,-257 275.5,-233 267.1,-218.35 268.62,-210.42 275.5,-195 277.16,-191.27 279.44,-187.78 282.06,-184.55"/>
<polygon fill="black" stroke="black" points="284.8,-186.75 289.15,-177.09 279.73,-181.93 284.8,-186.75"/>
<text text-anchor="middle" x="318.5" y="-254.8" font-family="Arial" font-size="14.00">Alert</text>
</g>
<!-- handle_handshake -->
<g id="node22" class="node">
<title>handle_handshake</title>
<path fill="none" stroke="black" d="M472.5,-232C472.5,-232 296.5,-232 296.5,-232 290.5,-232 284.5,-226 284.5,-220 284.5,-220 284.5,-208 284.5,-208 284.5,-202 290.5,-196 296.5,-196 296.5,-196 472.5,-196 472.5,-196 478.5,-196 484.5,-202 484.5,-208 484.5,-208 484.5,-220 484.5,-220 484.5,-226 478.5,-232 472.5,-232"/>
<text text-anchor="middle" x="384.5" y="-210.3" font-family="Arial" font-size="14.00">处理 Handshake (如密钥更新)</text>
</g>
<!-- handle_content_type&#45;&gt;handle_handshake -->
<g id="edge22" class="edge">
<title>handle_content_type&#45;&gt;handle_handshake</title>
<path fill="none" stroke="black" d="M390.08,-283.6C389.12,-271.75 387.82,-255.82 386.72,-242.29"/>
<polygon fill="black" stroke="black" points="390.19,-241.77 385.89,-232.08 383.21,-242.34 390.19,-241.77"/>
<text text-anchor="middle" x="423" y="-254.8" font-family="Arial" font-size="14.00">Handshake</text>
</g>
<!-- handle_application_data -->
<g id="node23" class="node">
<title>handle_application_data</title>
<path fill="none" stroke="black" d="M680.5,-233C680.5,-233 514.5,-233 514.5,-233 508.5,-233 502.5,-227 502.5,-221 502.5,-221 502.5,-207 502.5,-207 502.5,-201 508.5,-195 514.5,-195 514.5,-195 680.5,-195 680.5,-195 686.5,-195 692.5,-201 692.5,-207 692.5,-207 692.5,-221 692.5,-221 692.5,-227 686.5,-233 680.5,-233"/>
<text text-anchor="middle" x="597.5" y="-217.8" font-family="Arial" font-size="14.00">处理应用数据</text>
<text text-anchor="middle" x="597.5" y="-202.8" font-family="Arial" font-size="14.00">填充到 iovecs 或临时缓冲区</text>
</g>
<!-- handle_content_type&#45;&gt;handle_application_data -->
<g id="edge23" class="edge">
<title>handle_content_type&#45;&gt;handle_application_data</title>
<path fill="none" stroke="black" d="M432.69,-283.8C464.89,-270.36 509.87,-251.58 544.71,-237.04"/>
<polygon fill="black" stroke="black" points="546.37,-240.14 554.25,-233.06 543.67,-233.68 546.37,-240.14"/>
<text text-anchor="middle" x="556" y="-254.8" font-family="Arial" font-size="14.00">Application Data</text>
</g>
<!-- handle_alert&#45;&gt;finish_return -->
<g id="edge24" class="edge">
<title>handle_alert&#45;&gt;finish_return</title>
<path fill="none" stroke="black" d="M314.5,-140.96C314.5,-117.4 314.5,-74.64 314.5,-46.53"/>
<polygon fill="black" stroke="black" points="318,-46.18 314.5,-36.18 311,-46.18 318,-46.18"/>
<text text-anchor="middle" x="350.5" y="-101.3" font-family="Arial" font-size="14.00">close_notify</text>
</g>
<!-- check_more_records -->
<g id="node24" class="node">
<title>check_more_records</title>
<path fill="none" stroke="black" d="M568,-123C568,-123 447,-123 447,-123 441,-123 435,-117 435,-111 435,-111 435,-99 435,-99 435,-93 441,-87 447,-87 447,-87 568,-87 568,-87 574,-87 580,-93 580,-99 580,-99 580,-111 580,-111 580,-117 574,-123 568,-123"/>
<text text-anchor="middle" x="507.5" y="-101.3" font-family="Arial" font-size="14.00">是否还有更多记录？</text>
</g>
<!-- handle_handshake&#45;&gt;check_more_records -->
<g id="edge25" class="edge">
<title>handle_handshake&#45;&gt;check_more_records</title>
<path fill="none" stroke="black" d="M404.26,-195.81C424.79,-177.95 457.08,-149.86 480.07,-129.86"/>
<polygon fill="black" stroke="black" points="482.54,-132.35 487.79,-123.15 477.95,-127.07 482.54,-132.35"/>
</g>
<!-- handle_application_data&#45;&gt;check_more_records -->
<g id="edge26" class="edge">
<title>handle_application_data&#45;&gt;check_more_records</title>
<path fill="none" stroke="black" d="M582.23,-194.85C567.49,-177.32 545.04,-150.63 528.59,-131.07"/>
<polygon fill="black" stroke="black" points="531.06,-128.58 521.95,-123.18 525.71,-133.08 531.06,-128.58"/>
</g>
<!-- check_more_records&#45;&gt;decrypt_loop -->
<g id="edge27" class="edge">
<title>check_more_records&#45;&gt;decrypt_loop</title>
<path fill="none" stroke="black" d="M580.21,-112.77C641.91,-123 720.5,-148.65 720.5,-213 720.5,-539 720.5,-539 720.5,-539 720.5,-582.56 594.53,-600.01 509.5,-606.82"/>
<polygon fill="black" stroke="black" points="509.05,-603.34 499.34,-607.6 509.58,-610.32 509.05,-603.34"/>
<text text-anchor="middle" x="756.5" y="-372.3" font-family="Arial" font-size="14.00">有更多记录</text>
</g>
<!-- check_more_records&#45;&gt;finish_return -->
<g id="edge28" class="edge">
<title>check_more_records&#45;&gt;finish_return</title>
<path fill="none" stroke="black" d="M468.44,-86.8C437.87,-73.33 395.19,-54.54 362.53,-40.15"/>
<polygon fill="black" stroke="black" points="363.73,-36.86 353.17,-36.03 360.91,-43.26 363.73,-36.86"/>
<text text-anchor="middle" x="458.5" y="-57.8" font-family="Arial" font-size="14.00">无更多记录</text>
</g>
</g>
</svg>
