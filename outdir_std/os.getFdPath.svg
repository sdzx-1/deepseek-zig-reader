<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: flowchart Pages: 1 -->
<svg width="1248pt" height="448pt"
 viewBox="0.00 0.00 1248.00 448.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 444)">
<title>flowchart</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-444 1244,-444 1244,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<polygon fill="none" stroke="black" points="572.5,-440 405.5,-440 405.5,-404 572.5,-404 572.5,-440"/>
<text text-anchor="middle" x="489" y="-419.5" font-family="Courier,monospace" font-size="10.00">getFdPath(fd, out_buffer)</text>
</g>
<!-- check_target -->
<g id="node2" class="node">
<title>check_target</title>
<polygon fill="none" stroke="black" points="489,-367 409.83,-349 489,-331 568.17,-349 489,-367"/>
<text text-anchor="middle" x="489" y="-346.5" font-family="Courier,monospace" font-size="10.00">检查编译目标支持</text>
</g>
<!-- start&#45;&gt;check_target -->
<g id="edge1" class="edge">
<title>start&#45;&gt;check_target</title>
<path fill="none" stroke="black" d="M489,-403.81C489,-395.79 489,-386.05 489,-377.07"/>
<polygon fill="black" stroke="black" points="492.5,-377.03 489,-367.03 485.5,-377.03 492.5,-377.03"/>
</g>
<!-- compile_error -->
<g id="node3" class="node">
<title>compile_error</title>
<polygon fill="none" stroke="black" points="525.5,-284 400.5,-284 400.5,-248 525.5,-248 525.5,-284"/>
<text text-anchor="middle" x="463" y="-263.5" font-family="Courier,monospace" font-size="10.00">@compileError(...)</text>
</g>
<!-- check_target&#45;&gt;compile_error -->
<g id="edge2" class="edge">
<title>check_target&#45;&gt;compile_error</title>
<path fill="none" stroke="black" d="M483.86,-332C480.36,-321.08 475.64,-306.37 471.57,-293.7"/>
<polygon fill="black" stroke="black" points="474.87,-292.54 468.49,-284.09 468.21,-294.68 474.87,-292.54"/>
<text text-anchor="middle" x="493" y="-305" font-family="Courier,monospace" font-size="10.00">不支持</text>
</g>
<!-- switch_os -->
<g id="node4" class="node">
<title>switch_os</title>
<polygon fill="none" stroke="black" points="648,-284 543.88,-266 648,-248 752.12,-266 648,-284"/>
<text text-anchor="middle" x="648" y="-263.5" font-family="Courier,monospace" font-size="10.00">switch (native_os)</text>
</g>
<!-- check_target&#45;&gt;switch_os -->
<g id="edge3" class="edge">
<title>check_target&#45;&gt;switch_os</title>
<path fill="none" stroke="black" d="M512.12,-336.22C538.89,-322.58 583.24,-299.99 613.96,-284.34"/>
<polygon fill="black" stroke="black" points="615.69,-287.39 623.02,-279.73 612.52,-281.15 615.69,-287.39"/>
<text text-anchor="middle" x="588" y="-305" font-family="Courier,monospace" font-size="10.00">支持</text>
</g>
<!-- win_block -->
<g id="node5" class="node">
<title>win_block</title>
<polygon fill="none" stroke="black" points="198,-173.5 0,-173.5 0,-110.5 198,-110.5 198,-173.5"/>
<text text-anchor="middle" x="99" y="-161.5" font-family="Courier,monospace" font-size="10.00">Windows分支:</text>
<text text-anchor="middle" x="99" y="-150.5" font-family="Courier,monospace" font-size="10.00">1. 分配宽字符缓冲区</text>
<text text-anchor="middle" x="99" y="-139.5" font-family="Courier,monospace" font-size="10.00">2. 调用GetFinalPathNameByHandle</text>
<text text-anchor="middle" x="99" y="-128.5" font-family="Courier,monospace" font-size="10.00">3. 转换UTF16到UTF8</text>
<text text-anchor="middle" x="99" y="-117.5" font-family="Courier,monospace" font-size="10.00">4. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;win_block -->
<g id="edge4" class="edge">
<title>switch_os&#45;&gt;win_block</title>
<path fill="none" stroke="black" d="M596.42,-256.88C576.89,-253.91 554.44,-250.64 534,-248 388.39,-229.16 345.69,-249.2 207,-201 190.19,-195.16 172.85,-186.95 157.11,-178.54"/>
<polygon fill="black" stroke="black" points="158.49,-175.31 148.04,-173.58 155.13,-181.45 158.49,-175.31"/>
<text text-anchor="middle" x="342.5" y="-222" font-family="Courier,monospace" font-size="10.00">.windows</text>
</g>
<!-- mac_block -->
<g id="node6" class="node">
<title>mac_block</title>
<polygon fill="none" stroke="black" points="377.5,-190 216.5,-190 216.5,-94 377.5,-94 377.5,-190"/>
<text text-anchor="middle" x="297" y="-178" font-family="Courier,monospace" font-size="10.00">macOS/iOS分支:</text>
<text text-anchor="middle" x="297" y="-167" font-family="Courier,monospace" font-size="10.00">1. 用memset清零缓冲区</text>
<text text-anchor="middle" x="297" y="-156" font-family="Courier,monospace" font-size="10.00">2. 调用fcntl(F.GETPATH)</text>
<text text-anchor="middle" x="297" y="-145" font-family="Courier,monospace" font-size="10.00">3. 错误处理:</text>
<text text-anchor="middle" x="297" y="-134" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;&#45; BADF → FileNotFound</text>
<text text-anchor="middle" x="297" y="-123" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;&#45; NOSPC → NameTooLong</text>
<text text-anchor="middle" x="297" y="-112" font-family="Courier,monospace" font-size="10.00">4. 查找null终止符</text>
<text text-anchor="middle" x="297" y="-101" font-family="Courier,monospace" font-size="10.00">5. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;mac_block -->
<g id="edge5" class="edge">
<title>switch_os&#45;&gt;mac_block</title>
<path fill="none" stroke="black" d="M595.86,-256.98C547.71,-249.32 479.88,-237.82 454,-230 422.94,-220.61 415.62,-216.28 387,-201 383.5,-199.13 379.96,-197.17 376.41,-195.15"/>
<polygon fill="black" stroke="black" points="377.99,-192.02 367.59,-190.01 374.47,-198.07 377.99,-192.02"/>
<text text-anchor="middle" x="492" y="-222" font-family="Courier,monospace" font-size="10.00">.macos/.ios等</text>
</g>
<!-- linux_block -->
<g id="node7" class="node">
<title>linux_block</title>
<polygon fill="none" stroke="black" points="548,-173.5 396,-173.5 396,-110.5 548,-110.5 548,-173.5"/>
<text text-anchor="middle" x="472" y="-161.5" font-family="Courier,monospace" font-size="10.00">Linux/Serenity分支:</text>
<text text-anchor="middle" x="472" y="-150.5" font-family="Courier,monospace" font-size="10.00">1. 构造/proc/self/fd路径</text>
<text text-anchor="middle" x="472" y="-139.5" font-family="Courier,monospace" font-size="10.00">2. 调用readlink</text>
<text text-anchor="middle" x="472" y="-128.5" font-family="Courier,monospace" font-size="10.00">3. 错误处理</text>
<text text-anchor="middle" x="472" y="-117.5" font-family="Courier,monospace" font-size="10.00">4. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;linux_block -->
<g id="edge6" class="edge">
<title>switch_os&#45;&gt;linux_block</title>
<path fill="none" stroke="black" d="M604.4,-255.32C585.68,-249.83 564.2,-241.68 547,-230 528.14,-217.2 511.17,-198.48 498.17,-181.69"/>
<polygon fill="black" stroke="black" points="500.92,-179.52 492.11,-173.63 495.32,-183.73 500.92,-179.52"/>
<text text-anchor="middle" x="595.5" y="-222" font-family="Courier,monospace" font-size="10.00">.linux/.serenity</text>
</g>
<!-- solaris_block -->
<g id="node8" class="node">
<title>solaris_block</title>
<polygon fill="none" stroke="black" points="730,-173.5 566,-173.5 566,-110.5 730,-110.5 730,-173.5"/>
<text text-anchor="middle" x="648" y="-161.5" font-family="Courier,monospace" font-size="10.00">Solaris分支:</text>
<text text-anchor="middle" x="648" y="-150.5" font-family="Courier,monospace" font-size="10.00">1. 构造/proc/self/path路径</text>
<text text-anchor="middle" x="648" y="-139.5" font-family="Courier,monospace" font-size="10.00">2. 调用readlink</text>
<text text-anchor="middle" x="648" y="-128.5" font-family="Courier,monospace" font-size="10.00">3. 错误处理</text>
<text text-anchor="middle" x="648" y="-117.5" font-family="Courier,monospace" font-size="10.00">4. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;solaris_block -->
<g id="edge7" class="edge">
<title>switch_os&#45;&gt;solaris_block</title>
<path fill="none" stroke="black" d="M648,-247.78C648,-231.22 648,-205.57 648,-183.79"/>
<polygon fill="black" stroke="black" points="651.5,-183.79 648,-173.79 644.5,-183.79 651.5,-183.79"/>
<text text-anchor="middle" x="699.5" y="-222" font-family="Courier,monospace" font-size="10.00">.solaris/.illumos</text>
</g>
<!-- freebsd_block -->
<g id="node9" class="node">
<title>freebsd_block</title>
<polygon fill="none" stroke="black" points="904,-201 748,-201 748,-83 904,-83 904,-201"/>
<text text-anchor="middle" x="826" y="-189" font-family="Courier,monospace" font-size="10.00">FreeBSD分支:</text>
<text text-anchor="middle" x="826" y="-178" font-family="Courier,monospace" font-size="10.00">1. 版本检查 (≥13.0)</text>
<text text-anchor="middle" x="826" y="-167" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;a. 使用kinfo_file结构</text>
<text text-anchor="middle" x="826" y="-156" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;b. 调用fcntl(F.KINFO)</text>
<text text-anchor="middle" x="826" y="-145" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;c. 拷贝路径</text>
<text text-anchor="middle" x="826" y="-134" font-family="Courier,monospace" font-size="10.00">2. 旧版本:</text>
<text text-anchor="middle" x="826" y="-123" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;a. 调用sysctl获取信息</text>
<text text-anchor="middle" x="826" y="-112" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;b. 遍历查找匹配fd</text>
<text text-anchor="middle" x="826" y="-101" font-family="Courier,monospace" font-size="10.00"> &#160;&#160;c. 拷贝路径</text>
<text text-anchor="middle" x="826" y="-90" font-family="Courier,monospace" font-size="10.00">3. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;freebsd_block -->
<g id="edge8" class="edge">
<title>switch_os&#45;&gt;freebsd_block</title>
<path fill="none" stroke="black" d="M694.34,-255.99C714.21,-250.63 736.95,-242.38 755,-230 763.56,-224.13 771.63,-216.93 779.05,-209.22"/>
<polygon fill="black" stroke="black" points="782.07,-211.11 786.24,-201.37 776.9,-206.38 782.07,-211.11"/>
<text text-anchor="middle" x="790.5" y="-222" font-family="Courier,monospace" font-size="10.00">.freebsd</text>
</g>
<!-- dragonfly_block -->
<g id="node10" class="node">
<title>dragonfly_block</title>
<polygon fill="none" stroke="black" points="1072,-168 922,-168 922,-116 1072,-116 1072,-168"/>
<text text-anchor="middle" x="997" y="-156" font-family="Courier,monospace" font-size="10.00">DragonFly分支:</text>
<text text-anchor="middle" x="997" y="-145" font-family="Courier,monospace" font-size="10.00">1. 调用fcntl(F.GETPATH)</text>
<text text-anchor="middle" x="997" y="-134" font-family="Courier,monospace" font-size="10.00">2. 错误处理</text>
<text text-anchor="middle" x="997" y="-123" font-family="Courier,monospace" font-size="10.00">3. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;dragonfly_block -->
<g id="edge9" class="edge">
<title>switch_os&#45;&gt;dragonfly_block</title>
<path fill="none" stroke="black" d="M707.04,-258.13C762.43,-250 846.47,-233.29 913,-201 928.32,-193.57 943.97,-183.55 957.54,-173.93"/>
<polygon fill="black" stroke="black" points="959.66,-176.71 965.71,-168.01 955.55,-171.04 959.66,-176.71"/>
<text text-anchor="middle" x="895.5" y="-222" font-family="Courier,monospace" font-size="10.00">.dragonfly</text>
</g>
<!-- netbsd_block -->
<g id="node11" class="node">
<title>netbsd_block</title>
<polygon fill="none" stroke="black" points="1240,-168 1090,-168 1090,-116 1240,-116 1240,-168"/>
<text text-anchor="middle" x="1165" y="-156" font-family="Courier,monospace" font-size="10.00">NetBSD分支:</text>
<text text-anchor="middle" x="1165" y="-145" font-family="Courier,monospace" font-size="10.00">1. 调用fcntl(F.GETPATH)</text>
<text text-anchor="middle" x="1165" y="-134" font-family="Courier,monospace" font-size="10.00">2. 详细错误处理</text>
<text text-anchor="middle" x="1165" y="-123" font-family="Courier,monospace" font-size="10.00">3. 返回结果</text>
</g>
<!-- switch_os&#45;&gt;netbsd_block -->
<g id="edge10" class="edge">
<title>switch_os&#45;&gt;netbsd_block</title>
<path fill="none" stroke="black" d="M742.82,-264.39C833.05,-260.75 970.98,-247.13 1081,-201 1097.11,-194.25 1113.26,-184.1 1127.04,-174.17"/>
<polygon fill="black" stroke="black" points="1129.34,-176.82 1135.29,-168.05 1125.17,-171.2 1129.34,-176.82"/>
<text text-anchor="middle" x="1046.5" y="-222" font-family="Courier,monospace" font-size="10.00">.netbsd</text>
</g>
<!-- end -->
<g id="node12" class="node">
<title>end</title>
<polygon fill="none" stroke="black" points="723.5,-36 638.5,-36 638.5,0 723.5,0 723.5,-36"/>
<text text-anchor="middle" x="681" y="-15.5" font-family="Courier,monospace" font-size="10.00">返回路径或错误</text>
</g>
<!-- win_block&#45;&gt;end -->
<g id="edge11" class="edge">
<title>win_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M148.38,-110.46C166.3,-100.47 187.06,-90.13 207,-83 353.3,-30.73 538.93,-20.68 628.26,-19.05"/>
<polygon fill="black" stroke="black" points="628.46,-22.55 638.41,-18.9 628.36,-15.55 628.46,-22.55"/>
</g>
<!-- mac_block&#45;&gt;end -->
<g id="edge12" class="edge">
<title>mac_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M328,-93.83C340.45,-78.62 356.11,-63.31 374,-54 417,-31.62 552.32,-23.39 628.16,-20.49"/>
<polygon fill="black" stroke="black" points="628.59,-23.98 638.45,-20.12 628.33,-16.98 628.59,-23.98"/>
</g>
<!-- mac_block&#45;&gt;end -->
<g id="edge18" class="edge">
<title>mac_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M366.56,-93.89C373.35,-89.99 380.23,-86.29 387,-83 465.72,-44.74 567.34,-29.14 628.16,-22.94"/>
<polygon fill="black" stroke="black" points="628.68,-26.4 638.29,-21.95 628,-19.44 628.68,-26.4"/>
<text text-anchor="middle" x="476" y="-57" font-family="Courier,monospace" font-size="10.00">错误路径</text>
</g>
<!-- linux_block&#45;&gt;end -->
<g id="edge13" class="edge">
<title>linux_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M484.04,-110.4C493.08,-91.36 507.3,-67.92 527,-54 556.5,-33.15 596.42,-24.49 628.22,-21"/>
<polygon fill="black" stroke="black" points="628.62,-24.48 638.24,-20.04 627.95,-17.51 628.62,-24.48"/>
</g>
<!-- linux_block&#45;&gt;end -->
<g id="edge19" class="edge">
<title>linux_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M514.58,-110.45C527.93,-101.27 542.88,-91.42 557,-83 582.53,-67.78 612.08,-52.44 635.93,-40.6"/>
<polygon fill="black" stroke="black" points="637.68,-43.64 645.1,-36.08 634.58,-37.36 637.68,-43.64"/>
<text text-anchor="middle" x="627" y="-57" font-family="Courier,monospace" font-size="10.00">错误路径</text>
</g>
<!-- solaris_block&#45;&gt;end -->
<g id="edge14" class="edge">
<title>solaris_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M650.4,-110.19C652.35,-93.27 655.83,-72.1 662,-54 662.99,-51.08 664.22,-48.12 665.56,-45.22"/>
<polygon fill="black" stroke="black" points="668.7,-46.77 670.12,-36.28 662.46,-43.59 668.7,-46.77"/>
</g>
<!-- solaris_block&#45;&gt;end -->
<g id="edge20" class="edge">
<title>solaris_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M656.33,-110.21C661.68,-90.44 668.56,-65 673.69,-46.01"/>
<polygon fill="black" stroke="black" points="677.11,-46.77 676.35,-36.2 670.36,-44.94 677.11,-46.77"/>
<text text-anchor="middle" x="691" y="-57" font-family="Courier,monospace" font-size="10.00">错误路径</text>
</g>
<!-- freebsd_block&#45;&gt;end -->
<g id="edge15" class="edge">
<title>freebsd_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M756.9,-82.86C739.95,-68.6 722.75,-54.13 709.02,-42.57"/>
<polygon fill="black" stroke="black" points="711.27,-39.89 701.36,-36.13 706.76,-45.25 711.27,-39.89"/>
</g>
<!-- freebsd_block&#45;&gt;end -->
<g id="edge21" class="edge">
<title>freebsd_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M773.66,-82.99C763.29,-72.81 752.15,-62.7 741,-54 735.25,-49.51 728.86,-45.19 722.47,-41.21"/>
<polygon fill="black" stroke="black" points="724.17,-38.15 713.79,-36 720.57,-44.15 724.17,-38.15"/>
<text text-anchor="middle" x="773" y="-57" font-family="Courier,monospace" font-size="10.00">错误路径</text>
</g>
<!-- dragonfly_block&#45;&gt;end -->
<g id="edge16" class="edge">
<title>dragonfly_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M965.82,-115.74C950.62,-104.42 931.63,-91.7 913,-83 854.33,-55.61 781.67,-37.93 733.46,-28.24"/>
<polygon fill="black" stroke="black" points="734.05,-24.79 723.56,-26.29 732.69,-31.65 734.05,-24.79"/>
</g>
<!-- dragonfly_block&#45;&gt;end -->
<g id="edge22" class="edge">
<title>dragonfly_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M961.76,-115.96C946.86,-105.56 929.22,-93.49 913,-83 892.07,-69.47 888.28,-62.91 865,-54 822.53,-37.74 771.55,-28.8 734.03,-24.03"/>
<polygon fill="black" stroke="black" points="734.17,-20.52 723.83,-22.8 733.33,-27.47 734.17,-20.52"/>
<text text-anchor="middle" x="906" y="-57" font-family="Courier,monospace" font-size="10.00">错误路径</text>
</g>
<!-- netbsd_block&#45;&gt;end -->
<g id="edge17" class="edge">
<title>netbsd_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M1135.29,-115.95C1119.97,-104.26 1100.45,-91.15 1081,-83 963.69,-33.81 812.46,-22.18 733.81,-19.59"/>
<polygon fill="black" stroke="black" points="733.76,-16.09 723.67,-19.3 733.56,-23.09 733.76,-16.09"/>
</g>
<!-- netbsd_block&#45;&gt;end -->
<g id="edge23" class="edge">
<title>netbsd_block&#45;&gt;end</title>
<path fill="none" stroke="black" d="M1135.56,-115.83C1109.1,-94.9 1068.17,-66.59 1027,-54 926.5,-23.26 802.71,-18.14 733.76,-18.01"/>
<polygon fill="black" stroke="black" points="733.58,-14.51 723.58,-18.03 733.59,-21.51 733.58,-14.51"/>
<text text-anchor="middle" x="1071" y="-57" font-family="Courier,monospace" font-size="10.00">错误路径</text>
</g>
</g>
</svg>
