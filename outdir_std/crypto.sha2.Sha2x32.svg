<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Sha2x32 Pages: 1 -->
<svg width="664pt" height="1187pt"
 viewBox="0.00 0.00 664.00 1187.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1183)">
<title>Sha2x32</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1183 660,-1183 660,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M441.5,-1179C441.5,-1179 292.5,-1179 292.5,-1179 286.5,-1179 280.5,-1173 280.5,-1167 280.5,-1167 280.5,-1155 280.5,-1155 280.5,-1149 286.5,-1143 292.5,-1143 292.5,-1143 441.5,-1143 441.5,-1143 447.5,-1143 453.5,-1149 453.5,-1155 453.5,-1155 453.5,-1167 453.5,-1167 453.5,-1173 447.5,-1179 441.5,-1179"/>
<text text-anchor="middle" x="367" y="-1157.3" font-family="Times,serif" font-size="14.00">开始调用 Sha2x32 函数</text>
</g>
<!-- init -->
<g id="node2" class="node">
<title>init</title>
<path fill="none" stroke="black" d="M406,-1106C406,-1106 328,-1106 328,-1106 322,-1106 316,-1100 316,-1094 316,-1094 316,-1080 316,-1080 316,-1074 322,-1068 328,-1068 328,-1068 406,-1068 406,-1068 412,-1068 418,-1074 418,-1080 418,-1080 418,-1094 418,-1094 418,-1100 412,-1106 406,-1106"/>
<text text-anchor="middle" x="367" y="-1090.8" font-family="Times,serif" font-size="14.00">初始化结构体</text>
<text text-anchor="middle" x="367" y="-1075.8" font-family="Times,serif" font-size="14.00">(Self.init)</text>
</g>
<!-- start&#45;&gt;init -->
<g id="edge1" class="edge">
<title>start&#45;&gt;init</title>
<path fill="none" stroke="black" d="M367,-1142.94C367,-1134.99 367,-1125.31 367,-1116.31"/>
<polygon fill="black" stroke="black" points="370.5,-1116.2 367,-1106.2 363.5,-1116.2 370.5,-1116.2"/>
</g>
<!-- update -->
<g id="node3" class="node">
<title>update</title>
<path fill="none" stroke="black" d="M406,-1031C406,-1031 328,-1031 328,-1031 322,-1031 316,-1025 316,-1019 316,-1019 316,-1005 316,-1005 316,-999 322,-993 328,-993 328,-993 406,-993 406,-993 412,-993 418,-999 418,-1005 418,-1005 418,-1019 418,-1019 418,-1025 412,-1031 406,-1031"/>
<text text-anchor="middle" x="367" y="-1015.8" font-family="Times,serif" font-size="14.00">处理输入数据</text>
<text text-anchor="middle" x="367" y="-1000.8" font-family="Times,serif" font-size="14.00">(update)</text>
</g>
<!-- init&#45;&gt;update -->
<g id="edge2" class="edge">
<title>init&#45;&gt;update</title>
<path fill="none" stroke="black" d="M367,-1067.96C367,-1059.88 367,-1050.18 367,-1041.18"/>
<polygon fill="black" stroke="black" points="370.5,-1041.09 367,-1031.09 363.5,-1041.09 370.5,-1041.09"/>
</g>
<!-- check_buf -->
<g id="node4" class="node">
<title>check_buf</title>
<path fill="none" stroke="black" d="M449,-956C449,-956 285,-956 285,-956 279,-956 273,-950 273,-944 273,-944 273,-932 273,-932 273,-926 279,-920 285,-920 285,-920 449,-920 449,-920 455,-920 461,-926 461,-932 461,-932 461,-944 461,-944 461,-950 455,-956 449,-956"/>
<text text-anchor="middle" x="367" y="-934.3" font-family="Times,serif" font-size="14.00">检查是否有部分缓冲区数据</text>
</g>
<!-- update&#45;&gt;check_buf -->
<g id="edge3" class="edge">
<title>update&#45;&gt;check_buf</title>
<path fill="none" stroke="black" d="M367,-992.83C367,-984.89 367,-975.41 367,-966.63"/>
<polygon fill="black" stroke="black" points="370.5,-966.42 367,-956.42 363.5,-966.42 370.5,-966.42"/>
</g>
<!-- process_partial -->
<g id="node5" class="node">
<title>process_partial</title>
<path fill="none" stroke="black" d="M449,-869C449,-869 285,-869 285,-869 279,-869 273,-863 273,-857 273,-857 273,-845 273,-845 273,-839 279,-833 285,-833 285,-833 449,-833 449,-833 455,-833 461,-839 461,-845 461,-845 461,-857 461,-857 461,-863 455,-869 449,-869"/>
<text text-anchor="middle" x="367" y="-847.3" font-family="Times,serif" font-size="14.00">复制到缓冲区并处理完整块</text>
</g>
<!-- check_buf&#45;&gt;process_partial -->
<g id="edge4" class="edge">
<title>check_buf&#45;&gt;process_partial</title>
<path fill="none" stroke="black" d="M367,-919.8C367,-908.16 367,-892.55 367,-879.24"/>
<polygon fill="black" stroke="black" points="370.5,-879.18 367,-869.18 363.5,-879.18 370.5,-879.18"/>
<text text-anchor="middle" x="441" y="-890.8" font-family="Times,serif" font-size="14.00">buf_len + b.len ≥ 64</text>
</g>
<!-- process_full_blocks -->
<g id="node6" class="node">
<title>process_full_blocks</title>
<path fill="none" stroke="black" d="M370,-796C370,-796 278,-796 278,-796 272,-796 266,-790 266,-784 266,-784 266,-772 266,-772 266,-766 272,-760 278,-760 278,-760 370,-760 370,-760 376,-760 382,-766 382,-772 382,-772 382,-784 382,-784 382,-790 376,-796 370,-796"/>
<text text-anchor="middle" x="324" y="-774.3" font-family="Times,serif" font-size="14.00">处理完整中间块</text>
</g>
<!-- process_partial&#45;&gt;process_full_blocks -->
<g id="edge5" class="edge">
<title>process_partial&#45;&gt;process_full_blocks</title>
<path fill="none" stroke="black" d="M356.59,-832.81C351.47,-824.35 345.19,-813.98 339.51,-804.61"/>
<polygon fill="black" stroke="black" points="342.49,-802.77 334.31,-796.03 336.5,-806.4 342.49,-802.77"/>
</g>
<!-- round -->
<g id="node16" class="node">
<title>round</title>
<path fill="none" stroke="black" d="M470.5,-723C470.5,-723 349.5,-723 349.5,-723 343.5,-723 337.5,-717 337.5,-711 337.5,-711 337.5,-699 337.5,-699 337.5,-693 343.5,-687 349.5,-687 349.5,-687 470.5,-687 470.5,-687 476.5,-687 482.5,-693 482.5,-699 482.5,-699 482.5,-711 482.5,-711 482.5,-717 476.5,-723 470.5,-723"/>
<text text-anchor="middle" x="410" y="-701.3" font-family="Times,serif" font-size="14.00">处理数据块 (round)</text>
</g>
<!-- process_partial&#45;&gt;round -->
<g id="edge16" class="edge">
<title>process_partial&#45;&gt;round</title>
<path fill="none" stroke="black" d="M375.73,-832.85C380.77,-822.42 386.89,-808.69 391,-796 397.7,-775.3 402.65,-751.14 405.82,-733.06"/>
<polygon fill="black" stroke="black" points="409.27,-733.64 407.47,-723.2 402.37,-732.48 409.27,-733.64"/>
</g>
<!-- handle_remainder -->
<g id="node7" class="node">
<title>handle_remainder</title>
<path fill="none" stroke="black" d="M302.5,-723C302.5,-723 167.5,-723 167.5,-723 161.5,-723 155.5,-717 155.5,-711 155.5,-711 155.5,-699 155.5,-699 155.5,-693 161.5,-687 167.5,-687 167.5,-687 302.5,-687 302.5,-687 308.5,-687 314.5,-693 314.5,-699 314.5,-699 314.5,-711 314.5,-711 314.5,-717 308.5,-723 302.5,-723"/>
<text text-anchor="middle" x="235" y="-701.3" font-family="Times,serif" font-size="14.00">复制剩余数据到缓冲区</text>
</g>
<!-- process_full_blocks&#45;&gt;handle_remainder -->
<g id="edge6" class="edge">
<title>process_full_blocks&#45;&gt;handle_remainder</title>
<path fill="none" stroke="black" d="M302.46,-759.81C290.98,-750.66 276.69,-739.26 264.23,-729.32"/>
<polygon fill="black" stroke="black" points="266.35,-726.53 256.35,-723.03 261.98,-732 266.35,-726.53"/>
</g>
<!-- process_full_blocks&#45;&gt;round -->
<g id="edge17" class="edge">
<title>process_full_blocks&#45;&gt;round</title>
<path fill="none" stroke="black" d="M344.82,-759.81C355.8,-750.74 369.45,-739.48 381.41,-729.6"/>
<polygon fill="black" stroke="black" points="383.89,-732.09 389.37,-723.03 379.43,-726.7 383.89,-732.09"/>
</g>
<!-- update_end -->
<g id="node8" class="node">
<title>update_end</title>
<path fill="none" stroke="black" d="M245,-650C245,-650 159,-650 159,-650 153,-650 147,-644 147,-638 147,-638 147,-626 147,-626 147,-620 153,-614 159,-614 159,-614 245,-614 245,-614 251,-614 257,-620 257,-626 257,-626 257,-638 257,-638 257,-644 251,-650 245,-650"/>
<text text-anchor="middle" x="202" y="-628.3" font-family="Times,serif" font-size="14.00">更新 total_len</text>
</g>
<!-- handle_remainder&#45;&gt;update_end -->
<g id="edge7" class="edge">
<title>handle_remainder&#45;&gt;update_end</title>
<path fill="none" stroke="black" d="M227.01,-686.81C223.16,-678.53 218.46,-668.41 214.17,-659.19"/>
<polygon fill="black" stroke="black" points="217.3,-657.62 209.91,-650.03 210.96,-660.57 217.3,-657.62"/>
</g>
<!-- final -->
<g id="node9" class="node">
<title>final</title>
<path fill="none" stroke="black" d="M144,-563C144,-563 66,-563 66,-563 60,-563 54,-557 54,-551 54,-551 54,-537 54,-537 54,-531 60,-525 66,-525 66,-525 144,-525 144,-525 150,-525 156,-531 156,-537 156,-537 156,-551 156,-551 156,-557 150,-563 144,-563"/>
<text text-anchor="middle" x="105" y="-547.8" font-family="Times,serif" font-size="14.00">生成最终摘要</text>
<text text-anchor="middle" x="105" y="-532.8" font-family="Times,serif" font-size="14.00">(final)</text>
</g>
<!-- update_end&#45;&gt;final -->
<g id="edge8" class="edge">
<title>update_end&#45;&gt;final</title>
<path fill="none" stroke="black" d="M182.37,-613.6C168.32,-601.14 149.19,-584.18 133.47,-570.24"/>
<polygon fill="black" stroke="black" points="135.41,-567.28 125.6,-563.27 130.77,-572.52 135.41,-567.28"/>
</g>
<!-- add_padding -->
<g id="node10" class="node">
<title>add_padding</title>
<path fill="none" stroke="black" d="M162,-488C162,-488 48,-488 48,-488 42,-488 36,-482 36,-476 36,-476 36,-464 36,-464 36,-458 42,-452 48,-452 48,-452 162,-452 162,-452 168,-452 174,-458 174,-464 174,-464 174,-476 174,-476 174,-482 168,-488 162,-488"/>
<text text-anchor="middle" x="105" y="-466.3" font-family="Times,serif" font-size="14.00">添加填充位 (0x80)</text>
</g>
<!-- final&#45;&gt;add_padding -->
<g id="edge9" class="edge">
<title>final&#45;&gt;add_padding</title>
<path fill="none" stroke="black" d="M105,-524.83C105,-516.89 105,-507.41 105,-498.63"/>
<polygon fill="black" stroke="black" points="108.5,-498.42 105,-488.42 101.5,-498.42 108.5,-498.42"/>
</g>
<!-- check_padding_space -->
<g id="node11" class="node">
<title>check_padding_space</title>
<path fill="none" stroke="black" d="M172.5,-415C172.5,-415 37.5,-415 37.5,-415 31.5,-415 25.5,-409 25.5,-403 25.5,-403 25.5,-391 25.5,-391 25.5,-385 31.5,-379 37.5,-379 37.5,-379 172.5,-379 172.5,-379 178.5,-379 184.5,-385 184.5,-391 184.5,-391 184.5,-403 184.5,-403 184.5,-409 178.5,-415 172.5,-415"/>
<text text-anchor="middle" x="105" y="-393.3" font-family="Times,serif" font-size="14.00">检查剩余空间是否足够</text>
</g>
<!-- add_padding&#45;&gt;check_padding_space -->
<g id="edge10" class="edge">
<title>add_padding&#45;&gt;check_padding_space</title>
<path fill="none" stroke="black" d="M105,-451.81C105,-443.79 105,-434.05 105,-425.07"/>
<polygon fill="black" stroke="black" points="108.5,-425.03 105,-415.03 101.5,-425.03 108.5,-425.03"/>
</g>
<!-- extra_round -->
<g id="node12" class="node">
<title>extra_round</title>
<path fill="none" stroke="black" d="M104,-328C104,-328 12,-328 12,-328 6,-328 0,-322 0,-316 0,-316 0,-304 0,-304 0,-298 6,-292 12,-292 12,-292 104,-292 104,-292 110,-292 116,-298 116,-304 116,-304 116,-316 116,-316 116,-322 110,-328 104,-328"/>
<text text-anchor="middle" x="58" y="-306.3" font-family="Times,serif" font-size="14.00">执行额外块处理</text>
</g>
<!-- check_padding_space&#45;&gt;extra_round -->
<g id="edge11" class="edge">
<title>check_padding_space&#45;&gt;extra_round</title>
<path fill="none" stroke="black" d="M91.55,-378.66C87.58,-373.17 83.4,-366.97 80,-361 75.78,-353.58 71.81,-345.2 68.43,-337.45"/>
<polygon fill="black" stroke="black" points="71.6,-335.95 64.5,-328.09 65.14,-338.66 71.6,-335.95"/>
<text text-anchor="middle" x="109" y="-349.8" font-family="Times,serif" font-size="14.00">空间不足</text>
</g>
<!-- add_length -->
<g id="node13" class="node">
<title>add_length</title>
<path fill="none" stroke="black" d="M144,-255C144,-255 66,-255 66,-255 60,-255 54,-249 54,-243 54,-243 54,-231 54,-231 54,-225 60,-219 66,-219 66,-219 144,-219 144,-219 150,-219 156,-225 156,-231 156,-231 156,-243 156,-243 156,-249 150,-255 144,-255"/>
<text text-anchor="middle" x="105" y="-233.3" font-family="Times,serif" font-size="14.00">添加消息长度</text>
</g>
<!-- check_padding_space&#45;&gt;add_length -->
<g id="edge13" class="edge">
<title>check_padding_space&#45;&gt;add_length</title>
<path fill="none" stroke="black" d="M126.17,-378.66C130.97,-373.53 135.41,-367.52 138,-361 150.88,-328.57 135.33,-289.37 121.52,-264.08"/>
<polygon fill="black" stroke="black" points="124.38,-262.04 116.37,-255.11 118.31,-265.53 124.38,-262.04"/>
<text text-anchor="middle" x="172" y="-306.3" font-family="Times,serif" font-size="14.00">空间足够</text>
</g>
<!-- extra_round&#45;&gt;add_length -->
<g id="edge12" class="edge">
<title>extra_round&#45;&gt;add_length</title>
<path fill="none" stroke="black" d="M69.38,-291.81C74.98,-283.35 81.84,-272.98 88.05,-263.61"/>
<polygon fill="black" stroke="black" points="91.13,-265.3 93.73,-255.03 85.29,-261.44 91.13,-265.3"/>
</g>
<!-- final_round -->
<g id="node14" class="node">
<title>final_round</title>
<path fill="none" stroke="black" d="M137,-182C137,-182 73,-182 73,-182 67,-182 61,-176 61,-170 61,-170 61,-158 61,-158 61,-152 67,-146 73,-146 73,-146 137,-146 137,-146 143,-146 149,-152 149,-158 149,-158 149,-170 149,-170 149,-176 143,-182 137,-182"/>
<text text-anchor="middle" x="105" y="-160.3" font-family="Times,serif" font-size="14.00">处理最终块</text>
</g>
<!-- add_length&#45;&gt;final_round -->
<g id="edge14" class="edge">
<title>add_length&#45;&gt;final_round</title>
<path fill="none" stroke="black" d="M105,-218.81C105,-210.79 105,-201.05 105,-192.07"/>
<polygon fill="black" stroke="black" points="108.5,-192.03 105,-182.03 101.5,-192.03 108.5,-192.03"/>
</g>
<!-- output_result -->
<g id="node15" class="node">
<title>output_result</title>
<path fill="none" stroke="black" d="M144,-109C144,-109 66,-109 66,-109 60,-109 54,-103 54,-97 54,-97 54,-85 54,-85 54,-79 60,-73 66,-73 66,-73 144,-73 144,-73 150,-73 156,-79 156,-85 156,-85 156,-97 156,-97 156,-103 150,-109 144,-109"/>
<text text-anchor="middle" x="105" y="-87.3" font-family="Times,serif" font-size="14.00">输出摘要结果</text>
</g>
<!-- final_round&#45;&gt;output_result -->
<g id="edge15" class="edge">
<title>final_round&#45;&gt;output_result</title>
<path fill="none" stroke="black" d="M105,-145.81C105,-137.79 105,-128.05 105,-119.07"/>
<polygon fill="black" stroke="black" points="108.5,-119.03 105,-109.03 101.5,-119.03 108.5,-119.03"/>
</g>
<!-- end -->
<g id="node21" class="node">
<title>end</title>
<ellipse fill="none" stroke="black" cx="105" cy="-18" rx="66.09" ry="18"/>
<text text-anchor="middle" x="105" y="-14.3" font-family="Times,serif" font-size="14.00">返回最终摘要</text>
</g>
<!-- output_result&#45;&gt;end -->
<g id="edge22" class="edge">
<title>output_result&#45;&gt;end</title>
<path fill="none" stroke="black" d="M105,-72.81C105,-64.79 105,-55.05 105,-46.07"/>
<polygon fill="black" stroke="black" points="108.5,-46.03 105,-36.03 101.5,-46.03 108.5,-46.03"/>
</g>
<!-- check_arch -->
<g id="node17" class="node">
<title>check_arch</title>
<path fill="none" stroke="black" d="M502,-650C502,-650 392,-650 392,-650 386,-650 380,-644 380,-638 380,-638 380,-626 380,-626 380,-620 386,-614 392,-614 392,-614 502,-614 502,-614 508,-614 514,-620 514,-626 514,-626 514,-638 514,-638 514,-644 508,-650 502,-650"/>
<text text-anchor="middle" x="447" y="-628.3" font-family="Times,serif" font-size="14.00">检查CPU架构优化</text>
</g>
<!-- round&#45;&gt;check_arch -->
<g id="edge18" class="edge">
<title>round&#45;&gt;check_arch</title>
<path fill="none" stroke="black" d="M418.96,-686.81C423.32,-678.44 428.66,-668.2 433.5,-658.9"/>
<polygon fill="black" stroke="black" points="436.61,-660.51 438.13,-650.03 430.4,-657.28 436.61,-660.51"/>
</g>
<!-- aarch64_path -->
<g id="node18" class="node">
<title>aarch64_path</title>
<path fill="none" stroke="black" d="M341.5,-562C341.5,-562 186.5,-562 186.5,-562 180.5,-562 174.5,-556 174.5,-550 174.5,-550 174.5,-538 174.5,-538 174.5,-532 180.5,-526 186.5,-526 186.5,-526 341.5,-526 341.5,-526 347.5,-526 353.5,-532 353.5,-538 353.5,-538 353.5,-550 353.5,-550 353.5,-556 347.5,-562 341.5,-562"/>
<text text-anchor="middle" x="264" y="-540.3" font-family="Times,serif" font-size="14.00">AArch64 SHA2指令优化</text>
</g>
<!-- check_arch&#45;&gt;aarch64_path -->
<g id="edge19" class="edge">
<title>check_arch&#45;&gt;aarch64_path</title>
<path fill="none" stroke="black" d="M385.03,-613.93C369.97,-608.91 354.14,-602.89 340,-596 324.18,-588.29 307.83,-577.71 294.36,-568.18"/>
<polygon fill="black" stroke="black" points="296.12,-565.13 285.96,-562.11 292.02,-570.8 296.12,-565.13"/>
<text text-anchor="middle" x="392" y="-584.8" font-family="Times,serif" font-size="14.00">aarch64+sha2</text>
</g>
<!-- x86_path -->
<g id="node19" class="node">
<title>x86_path</title>
<path fill="none" stroke="black" d="M520.5,-562C520.5,-562 383.5,-562 383.5,-562 377.5,-562 371.5,-556 371.5,-550 371.5,-550 371.5,-538 371.5,-538 371.5,-532 377.5,-526 383.5,-526 383.5,-526 520.5,-526 520.5,-526 526.5,-526 532.5,-532 532.5,-538 532.5,-538 532.5,-550 532.5,-550 532.5,-556 526.5,-562 520.5,-562"/>
<text text-anchor="middle" x="452" y="-540.3" font-family="Times,serif" font-size="14.00">x86_64 SHA指令优化</text>
</g>
<!-- check_arch&#45;&gt;x86_path -->
<g id="edge20" class="edge">
<title>check_arch&#45;&gt;x86_path</title>
<path fill="none" stroke="black" d="M447.5,-613.87C447.83,-604.21 448.33,-591.93 449,-581 449.17,-578.22 449.37,-575.32 449.59,-572.43"/>
<polygon fill="black" stroke="black" points="453.1,-572.45 450.41,-562.2 446.12,-571.89 453.1,-572.45"/>
<text text-anchor="middle" x="516" y="-584.8" font-family="Times,serif" font-size="14.00">x86_64+sha+avx2</text>
</g>
<!-- generic_path -->
<g id="node20" class="node">
<title>generic_path</title>
<path fill="none" stroke="black" d="M644,-562C644,-562 566,-562 566,-562 560,-562 554,-556 554,-550 554,-550 554,-538 554,-538 554,-532 560,-526 566,-526 566,-526 644,-526 644,-526 650,-526 656,-532 656,-538 656,-538 656,-550 656,-550 656,-556 650,-562 644,-562"/>
<text text-anchor="middle" x="605" y="-540.3" font-family="Times,serif" font-size="14.00">通用软件实现</text>
</g>
<!-- check_arch&#45;&gt;generic_path -->
<g id="edge21" class="edge">
<title>check_arch&#45;&gt;generic_path</title>
<path fill="none" stroke="black" d="M514.22,-625.93C538.18,-621.18 563.92,-612.33 583,-596 590.35,-589.71 595.31,-580.53 598.64,-571.68"/>
<polygon fill="black" stroke="black" points="602.02,-572.59 601.73,-562 595.35,-570.46 602.02,-572.59"/>
<text text-anchor="middle" x="622" y="-584.8" font-family="Times,serif" font-size="14.00">其他情况</text>
</g>
</g>
</svg>
