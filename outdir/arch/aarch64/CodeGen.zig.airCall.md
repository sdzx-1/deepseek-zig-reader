flowchart TD
    A[开始] --> B{modifier == .always_tail?}
    B -->|是| C[返回错误: 未实现尾部调用]
    B -->|否| D[解析callee和args]
    D --> E[解析函数类型和调用约定]
    E --> F[保存比较标志]
    F --> G{返回值在栈上?}
    G -->|是| H[分配栈内存并设置返回指针]
    G -->|否| I[继续]
    H --> I
    I --> J[为栈参数分配空间]
    J --> K[遍历参数]
    K --> L{参数类型?}
    L -->|寄存器| M[获取寄存器并设置值]
    L -->|栈参数偏移| N[设置栈参数]
    K --> O[处理下一个参数]
    O --> K
    K -->|所有参数处理完毕| P[生成调用指令]
    P --> Q{callee是已知值?}
    Q -->|是| R[处理不同二进制格式]
    R -->|ELF| S[报错: 未实现ELF调用]
    R -->|Mach-O| T[报错: 未实现Mach-O调用]
    R -->|COFF| U[生成符号加载和blr指令]
    R -->|Plan9| V[设置寄存器并blr]
    Q -->|否| W[设置寄存器并blr]
    P --> X[处理返回值]
    X --> Y{返回值需保存?}
    Y -->|是| Z[复制到新寄存器]
    Y -->|否| AA[直接使用返回值]
    AA --> AB[完成Air指令]
    Z --> AB
    AB --> AC[结束]
