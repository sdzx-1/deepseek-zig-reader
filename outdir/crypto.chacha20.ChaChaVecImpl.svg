<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ChaChaVecImpl Pages: 1 -->
<svg width="1160pt" height="338pt"
 viewBox="0.00 0.00 1159.50 338.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 334)">
<title>ChaChaVecImpl</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-334 1155.5,-334 1155.5,4 -4,4"/>
<!-- ChaChaVecImpl -->
<g id="node1" class="node">
<title>ChaChaVecImpl</title>
<polygon fill="lightblue" stroke="black" points="677.5,-330 405.5,-330 405.5,-294 677.5,-294 677.5,-330"/>
<text text-anchor="middle" x="541.5" y="-308.3" font-family="Times,serif" font-size="14.00">ChaChaVecImpl(rounds_nb, degree)</text>
</g>
<!-- initContext -->
<g id="node2" class="node">
<title>initContext</title>
<polygon fill="lightblue" stroke="black" points="541.5,-170 393.5,-170 393.5,-134 541.5,-134 541.5,-170"/>
<text text-anchor="middle" x="467.5" y="-148.3" font-family="Times,serif" font-size="14.00">initContext(key, d)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;initContext -->
<g id="edge1" class="edge">
<title>ChaChaVecImpl&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M405.12,-307.79C318.76,-302.55 218.3,-289.4 190.5,-257 180.08,-244.86 180.82,-233.74 190.5,-221 196.52,-213.09 304.04,-188.33 383.32,-170.99"/>
<polygon fill="black" stroke="black" points="384.3,-174.35 393.33,-168.8 382.81,-167.51 384.3,-174.35"/>
</g>
<!-- chacha20Core -->
<g id="node3" class="node">
<title>chacha20Core</title>
<polygon fill="lightblue" stroke="black" points="743,-170 560,-170 560,-134 743,-134 743,-170"/>
<text text-anchor="middle" x="651.5" y="-148.3" font-family="Times,serif" font-size="14.00">chacha20Core(x, input)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;chacha20Core -->
<g id="edge2" class="edge">
<title>ChaChaVecImpl&#45;&gt;chacha20Core</title>
<path fill="none" stroke="black" d="M542.53,-293.78C544.28,-274.92 548.97,-244.25 561.5,-221 571.71,-202.06 589.73,-186.86 606.97,-175.67"/>
<polygon fill="black" stroke="black" points="609.2,-178.41 615.88,-170.18 605.53,-172.45 609.2,-178.41"/>
</g>
<!-- hashToBytes -->
<g id="node4" class="node">
<title>hashToBytes</title>
<polygon fill="lightblue" stroke="black" points="951.5,-170 761.5,-170 761.5,-134 951.5,-134 951.5,-170"/>
<text text-anchor="middle" x="856.5" y="-148.3" font-family="Times,serif" font-size="14.00">hashToBytes(dm, out, x)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;hashToBytes -->
<g id="edge3" class="edge">
<title>ChaChaVecImpl&#45;&gt;hashToBytes</title>
<path fill="none" stroke="black" d="M677.81,-304.85C830.12,-296.86 1059.76,-281.02 1092.5,-257 1118.56,-237.88 1137,-212.14 1115.5,-188 1094.1,-163.98 1008.56,-173.17 961.85,-169.78"/>
<polygon fill="black" stroke="black" points="961.99,-166.28 951.69,-168.74 961.28,-173.24 961.99,-166.28"/>
</g>
<!-- contextFeedback -->
<g id="node5" class="node">
<title>contextFeedback</title>
<polygon fill="lightblue" stroke="black" points="187,-170 0,-170 0,-134 187,-134 187,-170"/>
<text text-anchor="middle" x="93.5" y="-148.3" font-family="Times,serif" font-size="14.00">contextFeedback(x, ctx)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;contextFeedback -->
<g id="edge4" class="edge">
<title>ChaChaVecImpl&#45;&gt;contextFeedback</title>
<path fill="none" stroke="black" d="M405.46,-308.29C345.77,-304.1 275.55,-295.02 214.5,-276 165.3,-260.67 127.59,-210.41 108.14,-179.08"/>
<polygon fill="black" stroke="black" points="111.07,-177.17 102.92,-170.41 105.08,-180.78 111.07,-177.17"/>
</g>
<!-- chacha20Xor -->
<g id="node6" class="node">
<title>chacha20Xor</title>
<polygon fill="lightblue" stroke="black" points="513.5,-257 199.5,-257 199.5,-221 513.5,-221 513.5,-257"/>
<text text-anchor="middle" x="356.5" y="-235.3" font-family="Times,serif" font-size="14.00">chacha20Xor(out, in, key, nonce, count64)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;chacha20Xor -->
<g id="edge5" class="edge">
<title>ChaChaVecImpl&#45;&gt;chacha20Xor</title>
<path fill="none" stroke="black" d="M497.19,-293.99C471.18,-284.01 438.12,-271.32 410.58,-260.76"/>
<polygon fill="black" stroke="black" points="411.68,-257.43 401.09,-257.11 409.17,-263.96 411.68,-257.43"/>
</g>
<!-- chacha20Stream -->
<g id="node7" class="node">
<title>chacha20Stream</title>
<polygon fill="lightblue" stroke="black" points="1083.5,-257 763.5,-257 763.5,-221 1083.5,-221 1083.5,-257"/>
<text text-anchor="middle" x="923.5" y="-235.3" font-family="Times,serif" font-size="14.00">chacha20Stream(out, key, nonce, count64)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;chacha20Stream -->
<g id="edge6" class="edge">
<title>ChaChaVecImpl&#45;&gt;chacha20Stream</title>
<path fill="none" stroke="black" d="M633,-293.99C689.86,-283.43 763.04,-269.82 821.72,-258.92"/>
<polygon fill="black" stroke="black" points="822.56,-262.32 831.76,-257.05 821.28,-255.44 822.56,-262.32"/>
</g>
<!-- hchacha20 -->
<g id="node8" class="node">
<title>hchacha20</title>
<polygon fill="lightblue" stroke="black" points="745,-257 570,-257 570,-221 745,-221 745,-257"/>
<text text-anchor="middle" x="657.5" y="-235.3" font-family="Times,serif" font-size="14.00">hchacha20(input, key)</text>
</g>
<!-- ChaChaVecImpl&#45;&gt;hchacha20 -->
<g id="edge7" class="edge">
<title>ChaChaVecImpl&#45;&gt;hchacha20</title>
<path fill="none" stroke="black" d="M569.28,-293.99C584.67,-284.58 603.98,-272.76 620.62,-262.57"/>
<polygon fill="black" stroke="black" points="622.84,-265.32 629.54,-257.11 619.18,-259.35 622.84,-265.32"/>
</g>
<!-- switch_degree -->
<g id="node9" class="node">
<title>switch_degree</title>
<polygon fill="lightblue" stroke="black" points="390.5,-59.5 229.79,-41.5 390.5,-23.5 551.21,-41.5 390.5,-59.5"/>
<text text-anchor="middle" x="390.5" y="-37.8" font-family="Times,serif" font-size="14.00">分支处理 degree=1/2/4</text>
</g>
<!-- initContext&#45;&gt;switch_degree -->
<g id="edge8" class="edge">
<title>initContext&#45;&gt;switch_degree</title>
<path fill="none" stroke="black" d="M455.13,-133.57C442.32,-115.51 422.19,-87.16 407.8,-66.88"/>
<polygon fill="black" stroke="black" points="410.48,-64.6 401.84,-58.47 404.77,-68.66 410.48,-64.6"/>
<text text-anchor="middle" x="496" y="-104.8" font-family="Times,serif" font-size="14.00">switch(degree)</text>
</g>
<!-- rotl -->
<g id="node10" class="node">
<title>rotl</title>
<polygon fill="lightblue" stroke="black" points="889.5,-59.5 835.5,-59.5 835.5,-23.5 889.5,-23.5 889.5,-59.5"/>
<text text-anchor="middle" x="862.5" y="-37.8" font-family="Times,serif" font-size="14.00">rotl</text>
</g>
<!-- chacha20Core&#45;&gt;rotl -->
<g id="edge9" class="edge">
<title>chacha20Core&#45;&gt;rotl</title>
<path fill="none" stroke="black" d="M743.15,-134.82C784.8,-127.14 825.72,-119 829.5,-116 843.96,-104.51 852.29,-85.31 856.96,-69.42"/>
<polygon fill="black" stroke="black" points="860.39,-70.12 859.52,-59.56 853.61,-68.36 860.39,-70.12"/>
<text text-anchor="middle" x="871.5" y="-104.8" font-family="Times,serif" font-size="14.00">向量旋转</text>
</g>
<!-- shuffle -->
<g id="node11" class="node">
<title>shuffle</title>
<polygon fill="lightblue" stroke="black" points="634,-59.5 569,-59.5 569,-23.5 634,-23.5 634,-59.5"/>
<text text-anchor="middle" x="601.5" y="-37.8" font-family="Times,serif" font-size="14.00">shuffle</text>
</g>
<!-- chacha20Core&#45;&gt;shuffle -->
<g id="edge10" class="edge">
<title>chacha20Core&#45;&gt;shuffle</title>
<path fill="none" stroke="black" d="M633.31,-133.71C628.57,-128.41 623.85,-122.31 620.5,-116 612.9,-101.72 608.22,-84.24 605.41,-69.91"/>
<polygon fill="black" stroke="black" points="608.79,-68.91 603.61,-59.67 601.89,-70.13 608.79,-68.91"/>
<text text-anchor="middle" x="649.5" y="-104.8" font-family="Times,serif" font-size="14.00">向量重排</text>
</g>
<!-- rounds_loop -->
<g id="node12" class="node">
<title>rounds_loop</title>
<polygon fill="lightblue" stroke="black" points="787,-83 652,-83 652,0 787,0 787,-83"/>
<text text-anchor="middle" x="719.5" y="-67.8" font-family="Times,serif" font-size="14.00">每轮执行四步操作:</text>
<text text-anchor="middle" x="719.5" y="-52.8" font-family="Times,serif" font-size="14.00">1. 加法/XOR</text>
<text text-anchor="middle" x="719.5" y="-37.8" font-family="Times,serif" font-size="14.00">2. 旋转</text>
<text text-anchor="middle" x="719.5" y="-22.8" font-family="Times,serif" font-size="14.00">3. 重排</text>
<text text-anchor="middle" x="719.5" y="-7.8" font-family="Times,serif" font-size="14.00">4. 反馈</text>
</g>
<!-- chacha20Core&#45;&gt;rounds_loop -->
<g id="edge11" class="edge">
<title>chacha20Core&#45;&gt;rounds_loop</title>
<path fill="none" stroke="black" d="M665.48,-133.93C669.83,-128.34 674.53,-122.02 678.5,-116 683.52,-108.39 688.53,-100.11 693.24,-91.96"/>
<polygon fill="black" stroke="black" points="696.32,-93.62 698.21,-83.19 690.23,-90.16 696.32,-93.62"/>
<text text-anchor="middle" x="756" y="-104.8" font-family="Times,serif" font-size="14.00">循环 rounds_nb/2 次</text>
</g>
<!-- chacha20Xor&#45;&gt;initContext -->
<g id="edge12" class="edge">
<title>chacha20Xor&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M383.92,-220.85C392.29,-215.36 401.41,-209.12 409.5,-203 420.19,-194.92 431.45,-185.45 441.17,-176.94"/>
<polygon fill="black" stroke="black" points="443.77,-179.32 448.94,-170.07 439.13,-174.08 443.77,-179.32"/>
</g>
<!-- chacha20Xor&#45;&gt;chacha20Core -->
<g id="edge13" class="edge">
<title>chacha20Xor&#45;&gt;chacha20Core</title>
<path fill="none" stroke="black" d="M414.24,-220.97C447.37,-211.24 489.75,-198.85 527.5,-188 544.66,-183.07 563.18,-177.81 580.54,-172.91"/>
<polygon fill="black" stroke="black" points="581.93,-176.15 590.61,-170.07 580.03,-169.41 581.93,-176.15"/>
</g>
<!-- chacha20Xor&#45;&gt;hashToBytes -->
<g id="edge15" class="edge">
<title>chacha20Xor&#45;&gt;hashToBytes</title>
<path fill="none" stroke="black" d="M513.74,-225.26C590.44,-218.33 669.79,-209.81 686.5,-203 696.46,-198.94 695.8,-192.66 705.5,-188 719.86,-181.1 735.66,-175.52 751.46,-171.01"/>
<polygon fill="black" stroke="black" points="752.55,-174.34 761.28,-168.35 750.71,-167.59 752.55,-174.34"/>
<text text-anchor="middle" x="741.5" y="-191.8" font-family="Times,serif" font-size="14.00">生成密钥流</text>
</g>
<!-- chacha20Xor&#45;&gt;contextFeedback -->
<g id="edge14" class="edge">
<title>chacha20Xor&#45;&gt;contextFeedback</title>
<path fill="none" stroke="black" d="M303.59,-220.9C260.97,-207.13 200.95,-187.73 155.97,-173.19"/>
<polygon fill="black" stroke="black" points="156.91,-169.82 146.32,-170.07 154.76,-176.48 156.91,-169.82"/>
</g>
<!-- buffer_loop -->
<g id="node13" class="node">
<title>buffer_loop</title>
<ellipse fill="lightblue" stroke="black" cx="290.5" cy="-152" rx="85.29" ry="18"/>
<text text-anchor="middle" x="290.5" y="-148.3" font-family="Times,serif" font-size="14.00">按 64*d 分块处理</text>
</g>
<!-- chacha20Xor&#45;&gt;buffer_loop -->
<g id="edge16" class="edge">
<title>chacha20Xor&#45;&gt;buffer_loop</title>
<path fill="none" stroke="black" d="M339.09,-220.73C333.87,-215.24 328.27,-209.02 323.5,-203 317.5,-195.42 311.5,-186.74 306.3,-178.77"/>
<polygon fill="black" stroke="black" points="309.13,-176.72 300.8,-170.17 303.23,-180.48 309.13,-176.72"/>
<text text-anchor="middle" x="366.5" y="-191.8" font-family="Times,serif" font-size="14.00">分块处理输入</text>
</g>
<!-- chacha20Stream&#45;&gt;initContext -->
<g id="edge17" class="edge">
<title>chacha20Stream&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M763.49,-221.56C738.39,-216.85 712.99,-210.79 689.5,-203 676.1,-198.56 674.87,-192.53 661.5,-188 617.33,-173.02 602.02,-178.19 551.53,-169.88"/>
<polygon fill="black" stroke="black" points="552.13,-166.44 541.67,-168.17 550.93,-173.33 552.13,-166.44"/>
</g>
<!-- chacha20Stream&#45;&gt;chacha20Core -->
<g id="edge18" class="edge">
<title>chacha20Stream&#45;&gt;chacha20Core</title>
<path fill="none" stroke="black" d="M916.69,-220.77C911.31,-209.54 902.67,-195.61 890.5,-188 840.61,-156.82 816.12,-176.93 753.15,-169.89"/>
<polygon fill="black" stroke="black" points="753.5,-166.4 743.13,-168.58 752.6,-173.34 753.5,-166.4"/>
</g>
<!-- chacha20Stream&#45;&gt;hashToBytes -->
<g id="edge19" class="edge">
<title>chacha20Stream&#45;&gt;hashToBytes</title>
<path fill="none" stroke="black" d="M924.28,-220.93C923.95,-210.59 922.02,-197.6 915.5,-188 912.52,-183.62 908.8,-179.7 904.67,-176.22"/>
<polygon fill="black" stroke="black" points="906.47,-173.2 896.35,-170.06 902.31,-178.82 906.47,-173.2"/>
<text text-anchor="middle" x="971.5" y="-191.8" font-family="Times,serif" font-size="14.00">直接输出密钥流</text>
</g>
<!-- counter_update -->
<g id="node14" class="node">
<title>counter_update</title>
<polygon fill="lightblue" stroke="black" points="1151.5,-170 969.5,-170 969.5,-134 1151.5,-134 1151.5,-170"/>
<text text-anchor="middle" x="1060.5" y="-148.3" font-family="Times,serif" font-size="14.00">根据 count64 更新计数器</text>
</g>
<!-- chacha20Stream&#45;&gt;counter_update -->
<g id="edge20" class="edge">
<title>chacha20Stream&#45;&gt;counter_update</title>
<path fill="none" stroke="black" d="M992.61,-220.95C1004.24,-216.27 1015.7,-210.38 1025.5,-203 1033.92,-196.66 1041.08,-187.7 1046.69,-179.11"/>
<polygon fill="black" stroke="black" points="1049.76,-180.79 1051.96,-170.43 1043.78,-177.16 1049.76,-180.79"/>
<text text-anchor="middle" x="1075.5" y="-191.8" font-family="Times,serif" font-size="14.00">更新计数器</text>
</g>
<!-- hchacha20&#45;&gt;initContext -->
<g id="edge21" class="edge">
<title>hchacha20&#45;&gt;initContext</title>
<path fill="none" stroke="black" d="M619.05,-220.8C588.95,-207.33 546.94,-188.54 514.78,-174.15"/>
<polygon fill="black" stroke="black" points="516.12,-170.92 505.57,-170.03 513.27,-177.31 516.12,-170.92"/>
</g>
<!-- hchacha20&#45;&gt;chacha20Core -->
<g id="edge22" class="edge">
<title>hchacha20&#45;&gt;chacha20Core</title>
<path fill="none" stroke="black" d="M617.53,-220.86C610.7,-216.09 604.53,-210.2 600.5,-203 594.97,-193.11 599.89,-183.91 608.5,-176.16"/>
<polygon fill="black" stroke="black" points="610.68,-178.9 616.46,-170.02 606.4,-173.36 610.68,-178.9"/>
<text text-anchor="middle" x="643.5" y="-191.8" font-family="Times,serif" font-size="14.00">执行核心轮次</text>
</g>
<!-- hchacha20&#45;&gt;hashToBytes -->
<g id="edge23" class="edge">
<title>hchacha20&#45;&gt;hashToBytes</title>
<path fill="none" stroke="black" d="M732.3,-220.97C748.86,-216.08 766.06,-210.11 781.5,-203 797.24,-195.75 813.4,-185.42 826.67,-176.02"/>
<polygon fill="black" stroke="black" points="828.89,-178.73 834.93,-170.03 824.78,-173.07 828.89,-178.73"/>
<text text-anchor="middle" x="850.5" y="-191.8" font-family="Times,serif" font-size="14.00">提取中间结果</text>
</g>
</g>
</svg>
