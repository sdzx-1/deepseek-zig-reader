<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: spawnPosix Pages: 1 -->
<svg width="611pt" height="1491pt"
 viewBox="0.00 0.00 611.00 1491.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1487)">
<title>spawnPosix</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1487 607,-1487 607,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<polygon fill="none" stroke="black" points="141,-1483 40,-1483 40,-1447 141,-1447 141,-1483"/>
<text text-anchor="middle" x="90.5" y="-1462.5" font-family="Courier,monospace" font-size="10.00">开始 spawnPosix</text>
</g>
<!-- create_pipes -->
<g id="node2" class="node">
<title>create_pipes</title>
<polygon fill="none" stroke="black" points="181,-1410 0,-1410 0,-1374 181,-1374 181,-1410"/>
<text text-anchor="middle" x="90.5" y="-1395" font-family="Courier,monospace" font-size="10.00">创建 stdin/stdout/stderr 管道</text>
<text text-anchor="middle" x="90.5" y="-1384" font-family="Courier,monospace" font-size="10.00">(带 CLOEXEC 标志)</text>
</g>
<!-- start&#45;&gt;create_pipes -->
<g id="edge1" class="edge">
<title>start&#45;&gt;create_pipes</title>
<path fill="none" stroke="black" d="M90.5,-1446.81C90.5,-1438.79 90.5,-1429.05 90.5,-1420.07"/>
<polygon fill="black" stroke="black" points="94,-1420.03 90.5,-1410.03 87,-1420.03 94,-1420.03"/>
</g>
<!-- check_ignore -->
<g id="node3" class="node">
<title>check_ignore</title>
<polygon fill="none" stroke="black" points="225.5,-1337 130.69,-1319 225.5,-1301 320.31,-1319 225.5,-1337"/>
<text text-anchor="middle" x="225.5" y="-1316.5" font-family="Courier,monospace" font-size="10.00">是否有标准流被忽略？</text>
</g>
<!-- create_pipes&#45;&gt;check_ignore -->
<g id="edge2" class="edge">
<title>create_pipes&#45;&gt;check_ignore</title>
<path fill="none" stroke="black" d="M122.84,-1373.99C143.9,-1362.92 171.3,-1348.5 192.5,-1337.36"/>
<polygon fill="black" stroke="black" points="194.24,-1340.4 201.46,-1332.64 190.98,-1334.2 194.24,-1340.4"/>
</g>
<!-- err_pipes -->
<g id="node21" class="node">
<title>err_pipes</title>
<polygon fill="none" stroke="red" points="239,-869 132,-869 132,-833 239,-833 239,-869"/>
<text text-anchor="middle" x="185.5" y="-848.5" font-family="Courier,monospace" font-size="10.00">错误处理: 销毁管道</text>
</g>
<!-- create_pipes&#45;&gt;err_pipes -->
<g id="edge22" class="edge">
<title>create_pipes&#45;&gt;err_pipes</title>
<path fill="none" stroke="black" d="M85.96,-1373.92C82.57,-1359.62 78.5,-1338.63 78.5,-1320 78.5,-1320 78.5,-1320 78.5,-933 78.5,-905.71 100.89,-886.44 125.19,-873.56"/>
<polygon fill="black" stroke="black" points="126.79,-876.68 134.19,-869.1 123.68,-870.4 126.79,-876.68"/>
<text text-anchor="middle" x="93.5" y="-1119" font-family="Courier,monospace" font-size="10.00">失败时</text>
</g>
<!-- open_dev_null -->
<g id="node4" class="node">
<title>open_dev_null</title>
<polygon fill="none" stroke="black" points="349.5,-1254 253.5,-1254 253.5,-1218 349.5,-1218 349.5,-1254"/>
<text text-anchor="middle" x="301.5" y="-1233.5" font-family="Courier,monospace" font-size="10.00">打开 /dev/null</text>
</g>
<!-- check_ignore&#45;&gt;open_dev_null -->
<g id="edge3" class="edge">
<title>check_ignore&#45;&gt;open_dev_null</title>
<path fill="none" stroke="black" d="M239.09,-1303.52C249.94,-1291.95 265.39,-1275.48 278.21,-1261.82"/>
<polygon fill="black" stroke="black" points="281.1,-1263.85 285.39,-1254.17 276,-1259.06 281.1,-1263.85"/>
<text text-anchor="middle" x="273.5" y="-1275" font-family="Courier,monospace" font-size="10.00">是</text>
</g>
<!-- create_prog_pipe -->
<g id="node5" class="node">
<title>create_prog_pipe</title>
<polygon fill="none" stroke="black" points="314.5,-1181 160.5,-1181 160.5,-1145 314.5,-1145 314.5,-1181"/>
<text text-anchor="middle" x="237.5" y="-1160.5" font-family="Courier,monospace" font-size="10.00">创建进度报告管道 prog_pipe</text>
</g>
<!-- check_ignore&#45;&gt;create_prog_pipe -->
<g id="edge4" class="edge">
<title>check_ignore&#45;&gt;create_prog_pipe</title>
<path fill="none" stroke="black" d="M226.81,-1301.23C228.86,-1274.87 232.87,-1223.47 235.35,-1191.61"/>
<polygon fill="black" stroke="black" points="238.87,-1191.47 236.16,-1181.22 231.89,-1190.92 238.87,-1191.47"/>
<text text-anchor="middle" x="238.5" y="-1233.5" font-family="Courier,monospace" font-size="10.00">否</text>
</g>
<!-- open_dev_null&#45;&gt;create_prog_pipe -->
<g id="edge5" class="edge">
<title>open_dev_null&#45;&gt;create_prog_pipe</title>
<path fill="none" stroke="black" d="M286.01,-1217.81C278.07,-1209 268.26,-1198.13 259.55,-1188.46"/>
<polygon fill="black" stroke="black" points="262.15,-1186.11 252.85,-1181.03 256.95,-1190.8 262.15,-1186.11"/>
</g>
<!-- defer_close_dev_null -->
<g id="node22" class="node">
<title>defer_close_dev_null</title>
<polygon fill="none" stroke="blue" points="448.5,-1181 332.5,-1181 332.5,-1145 448.5,-1145 448.5,-1181"/>
<text text-anchor="middle" x="390.5" y="-1160.5" font-family="Courier,monospace" font-size="10.00">延迟关闭 /dev/null</text>
</g>
<!-- open_dev_null&#45;&gt;defer_close_dev_null -->
<g id="edge25" class="edge">
<title>open_dev_null&#45;&gt;defer_close_dev_null</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M323.04,-1217.81C334.52,-1208.66 348.81,-1197.26 361.27,-1187.32"/>
<polygon fill="blue" stroke="blue" points="363.52,-1190 369.15,-1181.03 359.15,-1184.53 363.52,-1190"/>
</g>
<!-- arena_alloc -->
<g id="node6" class="node">
<title>arena_alloc</title>
<polygon fill="none" stroke="black" points="424.5,-1098 308.5,-1098 308.5,-1062 424.5,-1062 424.5,-1098"/>
<text text-anchor="middle" x="366.5" y="-1077.5" font-family="Courier,monospace" font-size="10.00">初始化 Arena 分配器</text>
</g>
<!-- create_prog_pipe&#45;&gt;arena_alloc -->
<g id="edge6" class="edge">
<title>create_prog_pipe&#45;&gt;arena_alloc</title>
<path fill="none" stroke="black" d="M264.86,-1144.82C284.01,-1132.79 309.8,-1116.6 330.6,-1103.54"/>
<polygon fill="black" stroke="black" points="332.57,-1106.44 339.18,-1098.15 328.85,-1100.51 332.57,-1106.44"/>
</g>
<!-- create_prog_pipe&#45;&gt;err_pipes -->
<g id="edge23" class="edge">
<title>create_prog_pipe&#45;&gt;err_pipes</title>
<path fill="none" stroke="black" d="M241.9,-1144.75C245.67,-1128.44 250.5,-1103.22 250.5,-1081 250.5,-1081 250.5,-1081 250.5,-933 250.5,-910.22 234.67,-890.2 218.64,-875.76"/>
<polygon fill="black" stroke="black" points="220.71,-872.93 210.82,-869.13 216.18,-878.27 220.71,-872.93"/>
<text text-anchor="middle" x="265.5" y="-1004.5" font-family="Courier,monospace" font-size="10.00">失败时</text>
</g>
<!-- defer_destroy_prog_pipe -->
<g id="node23" class="node">
<title>defer_destroy_prog_pipe</title>
<polygon fill="none" stroke="blue" points="222,-1098 107,-1098 107,-1062 222,-1062 222,-1098"/>
<text text-anchor="middle" x="164.5" y="-1077.5" font-family="Courier,monospace" font-size="10.00">延迟销毁 prog_pipe</text>
</g>
<!-- create_prog_pipe&#45;&gt;defer_destroy_prog_pipe -->
<g id="edge26" class="edge">
<title>create_prog_pipe&#45;&gt;defer_destroy_prog_pipe</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M222.02,-1144.82C211.76,-1133.44 198.14,-1118.33 186.73,-1105.66"/>
<polygon fill="blue" stroke="blue" points="189.25,-1103.24 179.96,-1098.15 184.05,-1107.92 189.25,-1103.24"/>
</g>
<!-- prepare_argv_env -->
<g id="node7" class="node">
<title>prepare_argv_env</title>
<polygon fill="none" stroke="black" points="434.5,-1025 298.5,-1025 298.5,-989 434.5,-989 434.5,-1025"/>
<text text-anchor="middle" x="366.5" y="-1004.5" font-family="Courier,monospace" font-size="10.00">准备 argv 和 envp 参数</text>
</g>
<!-- arena_alloc&#45;&gt;prepare_argv_env -->
<g id="edge7" class="edge">
<title>arena_alloc&#45;&gt;prepare_argv_env</title>
<path fill="none" stroke="black" d="M366.5,-1061.81C366.5,-1053.79 366.5,-1044.05 366.5,-1035.07"/>
<polygon fill="black" stroke="black" points="370,-1035.03 366.5,-1025.03 363,-1035.03 370,-1035.03"/>
</g>
<!-- defer_arena_deinit -->
<g id="node24" class="node">
<title>defer_arena_deinit</title>
<polygon fill="none" stroke="blue" points="578.5,-1025 452.5,-1025 452.5,-989 578.5,-989 578.5,-1025"/>
<text text-anchor="middle" x="515.5" y="-1004.5" font-family="Courier,monospace" font-size="10.00">延迟释放 Arena 分配器</text>
</g>
<!-- arena_alloc&#45;&gt;defer_arena_deinit -->
<g id="edge27" class="edge">
<title>arena_alloc&#45;&gt;defer_arena_deinit</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M402.19,-1061.99C422.68,-1052.23 448.6,-1039.88 470.48,-1029.45"/>
<polygon fill="blue" stroke="blue" points="472.06,-1032.57 479.59,-1025.11 469.05,-1026.26 472.06,-1032.57"/>
</g>
<!-- create_err_pipe -->
<g id="node8" class="node">
<title>create_err_pipe</title>
<polygon fill="none" stroke="black" points="440.5,-952 292.5,-952 292.5,-916 440.5,-916 440.5,-952"/>
<text text-anchor="middle" x="366.5" y="-931.5" font-family="Courier,monospace" font-size="10.00">创建错误报告管道 err_pipe</text>
</g>
<!-- prepare_argv_env&#45;&gt;create_err_pipe -->
<g id="edge8" class="edge">
<title>prepare_argv_env&#45;&gt;create_err_pipe</title>
<path fill="none" stroke="black" d="M366.5,-988.81C366.5,-980.79 366.5,-971.05 366.5,-962.07"/>
<polygon fill="black" stroke="black" points="370,-962.03 366.5,-952.03 363,-962.03 370,-962.03"/>
</g>
<!-- fork_process -->
<g id="node9" class="node">
<title>fork_process</title>
<polygon fill="none" stroke="black" points="366.5,-869 256.72,-851 366.5,-833 476.28,-851 366.5,-869"/>
<text text-anchor="middle" x="366.5" y="-848.5" font-family="Courier,monospace" font-size="10.00">调用 fork() 创建子进程</text>
</g>
<!-- create_err_pipe&#45;&gt;fork_process -->
<g id="edge9" class="edge">
<title>create_err_pipe&#45;&gt;fork_process</title>
<path fill="none" stroke="black" d="M366.5,-915.82C366.5,-905.19 366.5,-891.31 366.5,-879.2"/>
<polygon fill="black" stroke="black" points="370,-879.15 366.5,-869.15 363,-879.15 370,-879.15"/>
</g>
<!-- create_err_pipe&#45;&gt;err_pipes -->
<g id="edge24" class="edge">
<title>create_err_pipe&#45;&gt;err_pipes</title>
<path fill="none" stroke="black" d="M328.74,-915.9C309.52,-907.21 285.78,-896.51 264.5,-887 254.43,-882.5 243.64,-877.7 233.36,-873.14"/>
<polygon fill="black" stroke="black" points="234.66,-869.89 224.1,-869.04 231.82,-876.29 234.66,-869.89"/>
<text text-anchor="middle" x="302.5" y="-890" font-family="Courier,monospace" font-size="10.00">失败时</text>
</g>
<!-- defer_err_pipe -->
<g id="node25" class="node">
<title>defer_err_pipe</title>
<polygon fill="none" stroke="blue" points="603,-869 494,-869 494,-833 603,-833 603,-869"/>
<text text-anchor="middle" x="548.5" y="-848.5" font-family="Courier,monospace" font-size="10.00">延迟销毁 err_pipe</text>
</g>
<!-- create_err_pipe&#45;&gt;defer_err_pipe -->
<g id="edge28" class="edge">
<title>create_err_pipe&#45;&gt;defer_err_pipe</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M405.1,-915.82C433.06,-903.38 471.04,-886.47 500.89,-873.19"/>
<polygon fill="blue" stroke="blue" points="502.56,-876.28 510.27,-869.01 499.71,-869.88 502.56,-876.28"/>
</g>
<!-- child_setup_io -->
<g id="node10" class="node">
<title>child_setup_io</title>
<polygon fill="none" stroke="black" points="518,-786 363,-786 363,-750 518,-750 518,-786"/>
<text text-anchor="middle" x="440.5" y="-765.5" font-family="Courier,monospace" font-size="10.00">子进程: 设置标准输入输出错误</text>
</g>
<!-- fork_process&#45;&gt;child_setup_io -->
<g id="edge10" class="edge">
<title>fork_process&#45;&gt;child_setup_io</title>
<path fill="none" stroke="black" d="M380.07,-835.14C390.68,-823.54 405.64,-807.16 418.02,-793.6"/>
<polygon fill="black" stroke="black" points="420.8,-795.75 424.96,-786 415.64,-791.03 420.8,-795.75"/>
<text text-anchor="middle" x="422.5" y="-807" font-family="Courier,monospace" font-size="10.00">子进程</text>
</g>
<!-- parent_close_err_write -->
<g id="node16" class="node">
<title>parent_close_err_write</title>
<polygon fill="none" stroke="black" points="421.5,-328 265.5,-328 265.5,-292 421.5,-292 421.5,-328"/>
<text text-anchor="middle" x="343.5" y="-307.5" font-family="Courier,monospace" font-size="10.00">父进程: 关闭 err_pipe 写端</text>
</g>
<!-- fork_process&#45;&gt;parent_close_err_write -->
<g id="edge17" class="edge">
<title>fork_process&#45;&gt;parent_close_err_write</title>
<path fill="none" stroke="black" d="M355.43,-834.71C345.17,-819.02 331.5,-793.51 331.5,-769 331.5,-769 331.5,-769 331.5,-382 331.5,-367.3 334.03,-351.13 336.77,-337.94"/>
<polygon fill="black" stroke="black" points="340.21,-338.6 338.96,-328.08 333.37,-337.08 340.21,-338.6"/>
<text text-anchor="middle" x="346.5" y="-578" font-family="Courier,monospace" font-size="10.00">父进程</text>
</g>
<!-- child_set_cwd -->
<g id="node11" class="node">
<title>child_set_cwd</title>
<polygon fill="none" stroke="black" points="486,-713 411,-713 411,-677 486,-677 486,-713"/>
<text text-anchor="middle" x="448.5" y="-692.5" font-family="Courier,monospace" font-size="10.00">设置工作目录</text>
</g>
<!-- child_setup_io&#45;&gt;child_set_cwd -->
<g id="edge11" class="edge">
<title>child_setup_io&#45;&gt;child_set_cwd</title>
<path fill="none" stroke="black" d="M442.44,-749.81C443.34,-741.79 444.44,-732.05 445.45,-723.07"/>
<polygon fill="black" stroke="black" points="448.94,-723.36 446.58,-713.03 441.98,-722.57 448.94,-723.36"/>
</g>
<!-- child_dup_prog_pipe -->
<g id="node12" class="node">
<title>child_dup_prog_pipe</title>
<polygon fill="none" stroke="black" points="541.5,-640 359.5,-640 359.5,-604 541.5,-604 541.5,-640"/>
<text text-anchor="middle" x="450.5" y="-619.5" font-family="Courier,monospace" font-size="10.00">复制 prog_pipe 到 prog_fileno</text>
</g>
<!-- child_set_cwd&#45;&gt;child_dup_prog_pipe -->
<g id="edge12" class="edge">
<title>child_set_cwd&#45;&gt;child_dup_prog_pipe</title>
<path fill="none" stroke="black" d="M448.98,-676.81C449.21,-668.79 449.48,-659.05 449.74,-650.07"/>
<polygon fill="black" stroke="black" points="453.24,-650.12 450.02,-640.03 446.24,-649.93 453.24,-650.12"/>
</g>
<!-- child_set_ids -->
<g id="node13" class="node">
<title>child_set_ids</title>
<polygon fill="none" stroke="black" points="502,-557 389,-557 389,-521 502,-521 502,-557"/>
<text text-anchor="middle" x="445.5" y="-536.5" font-family="Courier,monospace" font-size="10.00">设置 GID/UID/PGID</text>
</g>
<!-- child_dup_prog_pipe&#45;&gt;child_set_ids -->
<g id="edge13" class="edge">
<title>child_dup_prog_pipe&#45;&gt;child_set_ids</title>
<path fill="none" stroke="black" d="M449.44,-603.82C448.78,-593.19 447.93,-579.31 447.18,-567.2"/>
<polygon fill="black" stroke="black" points="450.67,-566.92 446.56,-557.15 443.68,-567.35 450.67,-566.92"/>
</g>
<!-- child_exec -->
<g id="node14" class="node">
<title>child_exec</title>
<polygon fill="none" stroke="black" points="500.5,-484 372.5,-484 372.5,-448 500.5,-448 500.5,-484"/>
<text text-anchor="middle" x="436.5" y="-463.5" font-family="Courier,monospace" font-size="10.00">执行 execvpe 加载程序</text>
</g>
<!-- child_set_ids&#45;&gt;child_exec -->
<g id="edge14" class="edge">
<title>child_set_ids&#45;&gt;child_exec</title>
<path fill="none" stroke="black" d="M443.32,-520.81C442.3,-512.79 441.07,-503.05 439.93,-494.07"/>
<polygon fill="black" stroke="black" points="443.39,-493.51 438.66,-484.03 436.44,-494.39 443.39,-493.51"/>
</g>
<!-- child_error -->
<g id="node15" class="node">
<title>child_error</title>
<polygon fill="none" stroke="black" points="481,-401 362,-401 362,-365 481,-365 481,-401"/>
<text text-anchor="middle" x="421.5" y="-380.5" font-family="Courier,monospace" font-size="10.00">报告错误到 err_pipe</text>
</g>
<!-- child_exec&#45;&gt;child_error -->
<g id="edge15" class="edge">
<title>child_exec&#45;&gt;child_error</title>
<path fill="none" stroke="black" d="M433.32,-447.82C431.35,-437.19 428.78,-423.31 426.54,-411.2"/>
<polygon fill="black" stroke="black" points="429.94,-410.35 424.68,-401.15 423.06,-411.62 429.94,-410.35"/>
<text text-anchor="middle" x="444.5" y="-422" font-family="Courier,monospace" font-size="10.00">失败时</text>
</g>
<!-- child_error&#45;&gt;parent_close_err_write -->
<!-- parent_set_fds -->
<g id="node17" class="node">
<title>parent_set_fds</title>
<polygon fill="none" stroke="black" points="448.5,-255 238.5,-255 238.5,-219 448.5,-219 448.5,-255"/>
<text text-anchor="middle" x="343.5" y="-234.5" font-family="Courier,monospace" font-size="10.00">设置 stdin/stdout/stderr 文件描述符</text>
</g>
<!-- parent_close_err_write&#45;&gt;parent_set_fds -->
<g id="edge18" class="edge">
<title>parent_close_err_write&#45;&gt;parent_set_fds</title>
<path fill="none" stroke="black" d="M343.5,-291.81C343.5,-283.79 343.5,-274.05 343.5,-265.07"/>
<polygon fill="black" stroke="black" points="347,-265.03 343.5,-255.03 340,-265.03 347,-265.03"/>
</g>
<!-- parent_record_pid -->
<g id="node18" class="node">
<title>parent_record_pid</title>
<polygon fill="none" stroke="black" points="388,-182 299,-182 299,-146 388,-146 388,-182"/>
<text text-anchor="middle" x="343.5" y="-161.5" font-family="Courier,monospace" font-size="10.00">记录子进程 PID</text>
</g>
<!-- parent_set_fds&#45;&gt;parent_record_pid -->
<g id="edge19" class="edge">
<title>parent_set_fds&#45;&gt;parent_record_pid</title>
<path fill="none" stroke="black" d="M343.5,-218.81C343.5,-210.79 343.5,-201.05 343.5,-192.07"/>
<polygon fill="black" stroke="black" points="347,-192.03 343.5,-182.03 340,-192.03 347,-192.03"/>
</g>
<!-- parent_close_pipe_ends -->
<g id="node19" class="node">
<title>parent_close_pipe_ends</title>
<polygon fill="none" stroke="black" points="400.5,-109 286.5,-109 286.5,-73 400.5,-73 400.5,-109"/>
<text text-anchor="middle" x="343.5" y="-88.5" font-family="Courier,monospace" font-size="10.00">关闭不需要的管道端点</text>
</g>
<!-- parent_record_pid&#45;&gt;parent_close_pipe_ends -->
<g id="edge20" class="edge">
<title>parent_record_pid&#45;&gt;parent_close_pipe_ends</title>
<path fill="none" stroke="black" d="M343.5,-145.81C343.5,-137.79 343.5,-128.05 343.5,-119.07"/>
<polygon fill="black" stroke="black" points="347,-119.03 343.5,-109.03 340,-119.03 347,-119.03"/>
</g>
<!-- parent_set_progress -->
<g id="node20" class="node">
<title>parent_set_progress</title>
<polygon fill="none" stroke="black" points="392.5,-36 294.5,-36 294.5,0 392.5,0 392.5,-36"/>
<text text-anchor="middle" x="343.5" y="-15.5" font-family="Courier,monospace" font-size="10.00">设置进度报告 IPC</text>
</g>
<!-- parent_close_pipe_ends&#45;&gt;parent_set_progress -->
<g id="edge21" class="edge">
<title>parent_close_pipe_ends&#45;&gt;parent_set_progress</title>
<path fill="none" stroke="black" d="M343.5,-72.81C343.5,-64.79 343.5,-55.05 343.5,-46.07"/>
<polygon fill="black" stroke="black" points="347,-46.03 343.5,-36.03 340,-46.03 347,-46.03"/>
</g>
</g>
</svg>
