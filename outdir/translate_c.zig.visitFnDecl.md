flowchart TD
    A[开始] --> B[获取函数名fn_name]
    B --> C{是否已存在sym_table中?}
    C -->|是| D[返回]
    C -->|否| E{是否为定义?}
    E -->|否| F[获取定义并递归调用visitFnDecl]
    F --> G[返回]
    E -->|是| H[构建FnDeclContext]
    H --> I[解析函数类型fn_qt]
    I --> J{函数类型类别}
    J -->|FunctionProto| K[处理可变参数并调整上下文]
    K --> L[转换函数原型transFnProto]
    J -->|FunctionNoProto| M[转换无原型函数transFnNoProto]
    L --> N{是否成功?}
    M --> N
    N -->|失败| O[标记错误并返回]
    N -->|成功| P{是否有函数体?}
    P -->|否| Q[添加顶层声明并返回]
    P -->|是| R[初始化块作用域]
    R --> S[遍历参数列表]
    S --> T{参数是否有名称?}
    T -->|否| U[标记为extern并警告]
    U --> V[添加顶层声明并返回]
    T -->|是| W[处理参数常量性]
    W --> X[重命名参数并生成重声明节点]
    X --> Y[继续下一个参数]
    Y --> S
    S --> Z[翻译函数体transCompoundStmtInline]
    Z --> AA{是否成功?}
    AA -->|失败| AB[标记为extern并警告]
    AB --> Q
    AA -->|成功| AC[检查是否需要添加返回语句]
    AC --> AD{是否noreturn或void返回?}
    AD -->|是| AE[直接使用现有函数体]
    AD -->|否| AF[生成零值返回语句]
    AF --> AE
    AE --> AG[完成作用域并构建最终body]
    AG --> Q
    Q --> AH[结束]
    O --> AH
